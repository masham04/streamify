{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/ban-types */\n\n\nimport { Component, Property, Complex, CollectionFactory, ChildProperty, Event } from '@syncfusion/ej2-base';\nimport { isBlazor } from '@syncfusion/ej2-base';\nimport { Browser, EventHandler, Draggable, Collection } from '@syncfusion/ej2-base';\nimport { remove } from '@syncfusion/ej2-base';\nimport { Accordion } from '@syncfusion/ej2-navigations';\nimport { Node, Connector, Shape, Size } from '../diagram/index';\nimport { Transform } from '../diagram/index';\nimport { DiagramRenderer, StackPanel, Margin } from '../diagram/index';\nimport { TextElement, Canvas } from '../diagram/index';\nimport { SvgRenderer } from '../diagram/rendering/svg-renderer';\nimport { parentsUntil, createSvgElement, createHtmlElement, createMeasureElements } from '../diagram/utility/dom-util';\nimport { removeElementsByClass, applyStyleAgainstCsp } from '../diagram/utility/dom-util';\nimport { scaleElement, arrangeChild, groupHasType, setUMLActivityDefaults, updateDefaultValues } from '../diagram/utility/diagram-util';\nimport { getFunction, randomId, cloneObject } from '../diagram/utility/base-util';\nimport { getOuterBounds } from '../diagram/utility/connector';\nimport { Point } from '../diagram/primitives/point';\nimport { CanvasRenderer } from '../diagram/rendering/canvas-renderer'; // eslint-disable-next-line\n\nvar getObjectType = function (obj) {\n  var conn = obj;\n\n  if (conn.sourcePoint || conn.targetPoint || conn.sourceID || conn.targetID || conn.sourcePortID || conn.targetPortID || conn.sourceDecorator || conn.targetDecorator) {\n    return Connector;\n  }\n\n  if (obj.shape && (obj.shape instanceof Shape || obj.shape.type)) {\n    return Node;\n  }\n\n  return Node;\n};\n/**\n * A palette allows to display a group of related symbols and it textually annotates the group with its header.\n */\n\n\nvar Palette =\n/** @class */\nfunction (_super) {\n  __extends(Palette, _super); // eslint-disable-next-line\n\n\n  function Palette(parent, propName, defaultValue, isArray) {\n    return _super.call(this, parent, propName, defaultValue, isArray) || this;\n  }\n\n  __decorate([Property('')], Palette.prototype, \"id\", void 0);\n\n  __decorate([Property()], Palette.prototype, \"height\", void 0);\n\n  __decorate([Property(true)], Palette.prototype, \"expanded\", void 0);\n\n  __decorate([Property('')], Palette.prototype, \"iconCss\", void 0);\n\n  __decorate([Property('')], Palette.prototype, \"title\", void 0);\n\n  __decorate([CollectionFactory(getObjectType)], Palette.prototype, \"symbols\", void 0);\n\n  return Palette;\n}(ChildProperty);\n\nexport { Palette };\n/**\n * customize the drag size of the individual palette items.\n */\n\nvar SymbolDragSize =\n/** @class */\nfunction (_super) {\n  __extends(SymbolDragSize, _super);\n\n  function SymbolDragSize() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property()], SymbolDragSize.prototype, \"width\", void 0);\n\n  __decorate([Property()], SymbolDragSize.prototype, \"height\", void 0);\n\n  return SymbolDragSize;\n}(ChildProperty);\n\nexport { SymbolDragSize };\n/**\n * customize the preview size and position of the individual palette items.\n */\n\nvar SymbolPreview =\n/** @class */\nfunction (_super) {\n  __extends(SymbolPreview, _super);\n\n  function SymbolPreview() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property()], SymbolPreview.prototype, \"width\", void 0);\n\n  __decorate([Property()], SymbolPreview.prototype, \"height\", void 0);\n\n  __decorate([Complex({}, Point)], SymbolPreview.prototype, \"offset\", void 0);\n\n  return SymbolPreview;\n}(ChildProperty);\n\nexport { SymbolPreview };\n/**\n * Represents the Symbol Palette Component.\n * ```html\n * <div id=\"symbolpalette\"></div>\n * <script>\n *  var palette = new SymbolPalatte({ allowDrag:true });\n *  palette.appendTo(\"#symbolpalette\");\n * </script>\n * ```\n */\n\n/**\n * The symbol palette control allows to predefine the frequently used nodes and connectors\n * and to drag and drop those nodes/connectors to drawing area\n */\n\nvar SymbolPalette =\n/** @class */\nfunction (_super) {\n  __extends(SymbolPalette, _super); //region - protected methods\n\n  /**\n   *  Constructor for creating the symbol palette Component\n   *\n   * @param {SymbolPaletteModel} options The symbol palette model.\n   * @param {string | HTMLElement} element The symbol palette element.\n   */\n\n\n  function SymbolPalette(options, element) {\n    var _this = _super.call(this, options, element) || this;\n    /**   @private  */\n\n\n    _this.symbolTable = {};\n    /**   @private  */\n\n    _this.childTable = {};\n    _this.info = 'info';\n    _this.oldObject = null;\n    _this.laneTable = {};\n    _this.isExpand = false;\n    _this.isExpandMode = false;\n    _this.isMethod = false;\n    _this.paletteid = 88123;\n    _this.checkOnRender = false; // eslint-disable\n\n    _this.helper = function (e) {\n      var clonedElement;\n      var id = _this.selectedSymbol && _this.selectedSymbol.id || e.sender.target.id.split('_container')[0];\n      var symbol = _this.symbolTable[id];\n\n      if (symbol && _this.selectedSymbol) {\n        _this.selectedSymbols = _this.selectedSymbol.id === symbol.id ? symbol : _this.selectedSymbol; //const position: PointModel = this.getMousePosition(e.sender);\n\n        clonedElement = _this.getSymbolPreview(_this.selectedSymbols, e.sender, _this.element);\n        clonedElement.setAttribute('paletteId', _this.element.id);\n      }\n\n      return clonedElement;\n    };\n\n    var child;\n    var node;\n\n    for (var i = 0; _this && _this.palettes && i < _this.palettes.length; i++) {\n      for (var j = 0; j < _this.palettes[i].symbols.length; j++) {\n        child = _this.palettes[i].symbols[j];\n        node = options.palettes[i].symbols[j];\n\n        if (child && child.shape.type === 'UmlActivity') {\n          setUMLActivityDefaults(node, child);\n        }\n\n        if (_this.nodeDefaults || _this.connectorDefaults) {\n          updateDefaultValues(child, node, child instanceof Node ? _this.nodeDefaults : _this.connectorDefaults);\n        }\n      }\n    }\n\n    return _this;\n  }\n  /**\n   * Refreshes the panel when the symbol palette properties are updated\\\n   *\n   * @returns {  void}    Refreshes the panel when the symbol palette properties are updated .\\\n   * @param {SymbolPaletteModel} newProp - Defines the new values of the changed properties.\n   * @param {SymbolPaletteModel} oldProp - Defines the old values of the changed properties.\n   */\n  // eslint-disable-next-line\n\n\n  SymbolPalette.prototype.onPropertyChanged = function (newProp, oldProp) {\n    var refresh = false;\n\n    for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'width':\n          this.element.style.width = this.width.toString();\n          break;\n\n        case 'height':\n          this.element.style.height = this.height.toString();\n          break;\n\n        case 'symbolPreview':\n          break;\n\n        case 'symbolWidth':\n        case 'symbolHeight':\n        case 'getSymbolInfo':\n          if (this.isReact) {\n            refresh = false;\n          } else {\n            refresh = true;\n          }\n\n          break;\n\n        case 'enableSearch':\n          if (newProp.enableSearch && !isBlazor()) {\n            this.createTextbox();\n          } else {\n            var divElement = document.getElementById(this.element.id + '_search');\n\n            if (divElement) {\n              divElement.parentNode.removeChild(divElement);\n            }\n          }\n\n          break;\n\n        case 'palettes':\n          for (var _b = 0, _c = Object.keys(newProp.palettes); _b < _c.length; _b++) {\n            var i = _c[_b];\n            var index = Number(i);\n\n            if (!isBlazor() && !this.accordionElement.items[index]) {\n              this.accordionElement.items[index] = {\n                header: newProp.palettes[index].title || '',\n                expanded: newProp.palettes[index].expanded,\n                iconCss: newProp.palettes[index].iconCss || ''\n              };\n            }\n\n            if (newProp.palettes[index].height) {\n              var paletteDiv = document.getElementById(this.palettes[index].id + '_content');\n              paletteDiv.style.height = newProp.palettes[index].height + 'px';\n            }\n\n            if (newProp.palettes[index].iconCss !== undefined) {\n              if (!isBlazor()) {\n                this.accordionElement.items[index].iconCss = newProp.palettes[index].iconCss || '';\n                refresh = true;\n              }\n            }\n\n            if (newProp.palettes[index].expanded !== undefined && !isBlazor()) {\n              if (!this.palettes[index].isInteraction) {\n                this.accordionElement.items[index].expanded = newProp.palettes[index].expanded;\n                this.isExpand = true;\n              } else {\n                this.palettes[index].isInteraction = false;\n              }\n\n              if (!this.isExpandMode && !this.isMethod && !this.isExpand) {\n                this.isExpand = true;\n              }\n            }\n\n            if (isBlazor() && newProp.palettes[index].symbols !== null) {\n              refresh = true;\n            }\n\n            if (isBlazor() && newProp.palettes[index].symbols === null) {\n              this.updateBlazorProperties(newProp);\n            }\n          }\n\n          break;\n\n        case 'enableAnimation':\n          if (!isBlazor()) {\n            if (!this.enableAnimation) {\n              this.accordionElement.animation = {\n                expand: {\n                  duration: 0\n                },\n                collapse: {\n                  duration: 0\n                }\n              };\n            } else {\n              this.accordionElement.animation = {\n                expand: {\n                  duration: 400\n                },\n                collapse: {\n                  duration: 400\n                }\n              };\n            }\n          }\n\n          break;\n\n        case 'expandMode':\n          if (!isBlazor()) {\n            this.accordionElement.expandMode = this.expandMode;\n            refresh = true;\n            this.isExpandMode = true;\n          }\n\n          break;\n\n        case 'allowDrag':\n          this.allowDrag = newProp.allowDrag;\n\n          if (!this.allowDrag) {\n            this.draggable.helper = function () {\n              return null;\n            };\n          } else {\n            this.initDraggable();\n            this.draggable.helper = this.helper;\n          }\n\n          break;\n      }\n    }\n\n    if (refresh) {\n      this.refreshPalettes();\n    }\n\n    if (this.isExpand && !refresh) {\n      this.refresh();\n      this.isExpand = false;\n\n      for (var p = 0; p < this.palettes.length; p++) {\n        var paletteElement = this.palettes[p].id;\n\n        if (window[paletteElement]) {\n          if (window[paletteElement].length > 1) {\n            window[paletteElement][1].parentNode.removeChild(window[paletteElement][1]);\n            window[paletteElement][1] = null;\n          }\n        }\n      }\n    }\n\n    this.isMethod = false;\n  };\n  /**\n   * updateBlazorProperties method\\\n   *\n   * @returns {void}    updateBlazorProperties method .\\\n   * @param {SymbolPaletteModel} newProp - provide the scale value.\n   *\n   * @private\n   */\n\n\n  SymbolPalette.prototype.updateBlazorProperties = function (newProp) {\n    var blazorInterop = 'sfBlazor';\n    var blazor = 'Blazor';\n\n    if (window && window[blazor]) {\n      var palObj = {\n        palette: newProp.palettes\n      };\n      var obj = {\n        'methodName': 'UpdateBlazorProperties',\n        'paletteobj': palObj\n      };\n      window[blazorInterop].updateBlazorProperties(obj, this);\n    }\n  };\n  /**\n   * Get the properties to be maintained in the persisted state.\n   *\n   * @returns {string}  Get the properties to be maintained in the persisted state.\n   */\n\n\n  SymbolPalette.prototype.getPersistData = function () {\n    var keyEntity = ['loaded'];\n    return this.addOnPersist(keyEntity);\n  };\n  /**\n   * Initializes the values of private members.\n   *\n   * @returns {void}  Initializes the values of private members.\n   * @private\n   */\n\n\n  SymbolPalette.prototype.preRender = function () {\n    var _this = this;\n\n    if (this.element.id === '') {\n      var collection = document.getElementsByClassName('e-symbolpalette').length;\n      this.element.id = 'symbolpalette_' + this.paletteid + '_' + collection;\n    }\n\n    this.element.style.overflow = 'auto';\n    this.element.style.height = this.height.toString();\n    this.element.style.width = this.width.toString();\n\n    if (this.enableSearch && !isBlazor()) {\n      this.createTextbox();\n    } //create accordion element\n\n\n    if (!isBlazor()) {\n      var accordionDiv = createHtmlElement('div', {\n        id: this.element.id + '_container'\n      });\n      this.accordionElement = new Accordion({\n        expandMode: this.expandMode\n      });\n\n      if (!this.enableAnimation) {\n        this.accordionElement.animation = {\n          expand: {\n            duration: 0\n          },\n          collapse: {\n            duration: 0\n          }\n        };\n      }\n\n      this.accordionElement.created = function () {\n        _this.checkOnRender = true;\n      };\n\n      this.accordionElement.expanded = function (args) {\n        var index = _this.accordionElement.items.indexOf(args.item);\n\n        var isAllowDatabind = _this.allowServerDataBinding;\n        _this.allowServerDataBinding = false;\n        _this.palettes[index].expanded = args.isExpanded;\n        _this.palettes[index].isInteraction = true;\n        _this.allowServerDataBinding = isAllowDatabind;\n      };\n\n      this.accordionElement.expanding = function (args) {\n        if (_this.checkOnRender) {\n          // eslint-disable-next-line\n          var diagramArgs = {\n            element: args.element,\n            content: args.content,\n            index: args.index,\n            cancel: false,\n            isExpanded: args.isExpanded,\n            palette: _this.palettes[args.index]\n          };\n          var event_1 = 'paletteExpanding';\n\n          _this.trigger(event_1, diagramArgs);\n\n          args.cancel = diagramArgs.cancel;\n        }\n      };\n\n      this.element.appendChild(accordionDiv);\n    }\n\n    var measureWindowElement = 'measureElement';\n\n    if (window[measureWindowElement]) {\n      window[measureWindowElement] = null;\n    }\n\n    createMeasureElements();\n    this.unWireEvents();\n    this.wireEvents();\n  };\n  /**\n   * Renders the rulers.\n   *\n   * @returns {void}  Renders the rulers.\n   * @private\n   */\n\n\n  SymbolPalette.prototype.render = function () {\n    this.diagramRenderer = new DiagramRenderer(this.element.id, new SvgRenderer(), false);\n    this.svgRenderer = new DiagramRenderer(this.element.id, new SvgRenderer(), true);\n    this.updatePalettes();\n\n    if (!isBlazor()) {\n      this.accordionElement.appendTo('#' + this.element.id + '_container');\n    }\n\n    this.renderComplete();\n\n    if (isBlazor()) {\n      this.element.classList.remove('e-symbolpalette-hidden');\n    }\n  };\n  /**\n   * Core method to return the component name.\n   *\n   * @returns {string}  Core method to return the component name.\n   * @private\n   */\n\n\n  SymbolPalette.prototype.getModuleName = function () {\n    return 'SymbolPalette';\n  };\n  /**\n   * To provide the array of modules needed for control rendering.\n   *\n   * @returns {ModuleDeclaration[]}  To provide the array of modules needed for control rendering .\n   * @private\n   */\n\n\n  SymbolPalette.prototype.requiredModules = function () {\n    var modules = [];\n    modules.push({\n      member: 'Bpmn',\n      args: []\n    });\n    return modules;\n  };\n  /**\n   *To destroy the ruler\n   *\n   * @returns {void} To destroy the ruler\n   */\n\n\n  SymbolPalette.prototype.destroy = function () {\n    if (this.allowDrag) {\n      this.draggable.destroy();\n      this.unWireEvents();\n      this.notify('destroy', {});\n\n      _super.prototype.destroy.call(this);\n\n      var content = document.getElementById(this.element.id + '_container');\n\n      if (content) {\n        this.element.removeChild(content);\n        var measureElemnt = 'measureElement';\n\n        if (window[measureElemnt]) {\n          window[measureElemnt].usageCount -= 1;\n          var measureElementCount = 'measureElementCount';\n          window[measureElementCount]--;\n\n          if (window[measureElementCount] === 0) {\n            window[measureElemnt].parentNode.removeChild(window[measureElemnt]);\n            window[measureElemnt] = null;\n          }\n        }\n      }\n\n      content = document.getElementById(this.element.id + '_search');\n\n      if (content) {\n        content.parentNode.removeChild(content);\n      }\n\n      this.element.classList.remove('e-symbolpalette');\n    }\n  };\n  /**\n   * Add particular palettes to symbol palette at runtime.\\\n   *\n   * @returns {  void}    Refreshes the ruler when the Ruler properties are updated .\\\n   * @param { PaletteModel[]} palettes -Defines the collection of palettes to be added.\n   */\n\n\n  SymbolPalette.prototype.addPalettes = function (palettes) {\n    var palette;\n\n    for (var i = 0; i < palettes.length; i++) {\n      var isEnableServerDatabind = this.allowServerDataBinding;\n      this.isProtectedOnChange = true;\n      this.allowServerDataBinding = false;\n      palette = new Palette(this, 'palettes', palettes[i], true);\n      this.palettes.push(palette);\n      this.initSymbols(palette);\n      this.allowServerDataBinding = isEnableServerDatabind;\n      this.isProtectedOnChange = false;\n      this.renderPalette(palette);\n    }\n\n    this.bulkChanges = {};\n\n    if (!isBlazor()) {\n      this.accordionElement.refresh();\n    }\n  };\n  /**\n   * removePalette method\\\n   *\n   * @returns {void}    removePalette method .\\\n   * @param {string} paletteId - provide the scale value.\n   *\n   * @private\n   */\n\n\n  SymbolPalette.prototype.removePalette = function (paletteId) {\n    for (var i = 0; i < this.palettes.length; i++) {\n      if (this.palettes[i].id === paletteId) {\n        this.palettes.splice(i, 1);\n\n        if (!isBlazor()) {\n          this.accordionElement.items.splice(i, 1);\n        }\n\n        break;\n      }\n    }\n  };\n  /**\n   * Remove particular palettes to symbol palette at runtime \\\n   *\n   * @returns {void}   Remove particular palettes to symbol palette at runtime .\\\n   * @param {string[]} palettes - provide the scale value.\n   */\n\n\n  SymbolPalette.prototype.removePalettes = function (palettes) {\n    var isEnableServerDatabind = this.allowServerDataBinding;\n    this.allowServerDataBinding = false;\n\n    for (var i = 0; i < palettes.length; i++) {\n      this.removePalette(palettes[i]);\n    }\n\n    if (!isBlazor()) {\n      this.accordionElement.refresh();\n    } else {\n      this.updatePalettes();\n    }\n\n    this.allowServerDataBinding = isEnableServerDatabind;\n  }; //end region - protected methods\n  //region - private methods to render symbols\n\n  /**\n   * Method to initialize the items in the symbols \\\n   *\n   * @returns {void}    Method to initialize the items in the symbols .\\\n   * @param {PaletteModel} symbolGroup - provide the scale value.\n   *\n   */\n\n\n  SymbolPalette.prototype.initSymbols = function (symbolGroup) {\n    var group = [];\n    var laneHeight = 0;\n    var laneWidth = 0;\n\n    for (var _i = 0, _a = symbolGroup.symbols; _i < _a.length; _i++) {\n      var symbol = _a[_i];\n\n      if (symbol.shape.type === 'SwimLane') {\n        var swimLaneObj = symbol;\n        var swimLaneShape = symbol.shape;\n        var isHorizontal = swimLaneShape.orientation === 'Horizontal' ? true : false;\n\n        if (swimLaneShape.isLane) {\n          laneHeight = isHorizontal ? this.symbolHeight - this.symbolHeight / 2 : this.symbolHeight - this.symbolHeight / 4;\n          laneWidth = isHorizontal ? this.symbolWidth - this.symbolWidth / 4 : this.symbolWidth - this.symbolWidth / 2;\n          this.laneTable[symbol.id] = {\n            height: laneHeight,\n            width: laneWidth\n          };\n          var header = swimLaneShape.lanes[0].header;\n          var laneStyle = swimLaneShape.lanes[0].style;\n          var headerStyle = header.style;\n          var headerObj = {\n            id: 'header' + randomId(),\n            shape: {\n              type: 'Basic',\n              shape: 'Rectangle'\n            },\n            width: isHorizontal ? header.width : swimLaneObj.width,\n            height: isHorizontal ? swimLaneObj.height : header.height,\n            style: headerStyle,\n            annotations: [{\n              content: header.annotation.content\n            }]\n          };\n          headerObj.offsetX = headerObj.width / 2;\n          headerObj.offsetY = headerObj.height / 2;\n          this.addPaletteItem(symbolGroup.id, headerObj);\n          var laneObj = {\n            id: 'lane' + randomId(),\n            shape: {\n              type: 'Basic',\n              shape: 'Rectangle'\n            },\n            width: isHorizontal ? swimLaneObj.width - header.width : swimLaneObj.width,\n            height: isHorizontal ? swimLaneObj.height : swimLaneObj.height - header.height,\n            style: laneStyle\n          };\n          laneObj.offsetX = isHorizontal ? headerObj.width + laneObj.width / 2 : laneObj.width / 2;\n          laneObj.offsetY = isHorizontal ? laneObj.height / 2 : headerObj.height + laneObj.height / 2;\n          this.addPaletteItem(symbolGroup.id, laneObj);\n          swimLaneObj.children = [headerObj.id, laneObj.id];\n        } else if (swimLaneShape.isPhase) {\n          laneHeight = swimLaneObj.height ? swimLaneObj.height : this.symbolHeight;\n          laneWidth = swimLaneObj.width ? swimLaneObj.width : this.symbolWidth;\n          symbol.shape.type = 'Path';\n\n          if (isHorizontal) {\n            symbol.shape.data = 'M0,0 L' + laneWidth + ',' + '0';\n          } else {\n            symbol.shape.data = 'M0,0 L0,' + laneWidth;\n          }\n        }\n      }\n\n      if (symbol instanceof Node) {\n        var getNodeDefaults = getFunction(this.getNodeDefaults);\n\n        if (getNodeDefaults) {\n          getNodeDefaults(symbol, this);\n        }\n      } else if (symbol instanceof Connector) {\n        var getConnectorDefaults = getFunction(this.getConnectorDefaults);\n\n        if (getConnectorDefaults) {\n          getConnectorDefaults(symbol, this);\n        }\n      }\n\n      this.symbolTable[symbol.id] = symbol;\n\n      if (symbol instanceof Node && symbol.children) {\n        group.push(symbol);\n      }\n    }\n\n    for (var i = 0; i < group.length; i++) {\n      var node = void 0;\n\n      for (var j = 0; j < group[i].children.length; j++) {\n        node = this.symbolTable[group[i].children[j]];\n\n        if (node) {\n          this.childTable[node.id] = node;\n          node.parentId = group[i].id;\n        }\n      }\n    }\n\n    for (var _b = 0, _c = symbolGroup.symbols; _b < _c.length; _b++) {\n      var symbol = _c[_b];\n\n      if (!(symbol instanceof Node && symbol.children)) {\n        this.prepareSymbol(symbol);\n      }\n    }\n\n    for (var _d = 0, group_1 = group; _d < group_1.length; _d++) {\n      var symbol = group_1[_d];\n      this.prepareSymbol(symbol);\n    }\n  };\n\n  SymbolPalette.prototype.renderPalette = function (symbolGroup) {\n    var style = isBlazor() ? 'overflow:auto;' : 'display:none;overflow:auto;';\n\n    if (symbolGroup.height) {\n      style += 'height:' + symbolGroup.height + 'px';\n    }\n\n    var paletteParentDiv = document.getElementById(symbolGroup.id);\n    var paletteDiv;\n\n    if (isBlazor() && paletteParentDiv != null) {\n      paletteDiv = createHtmlElement('div', {\n        'id': symbolGroup.id + '_content',\n        style: style,\n        class: 'e-remove-palette'\n      });\n      paletteParentDiv.appendChild(paletteDiv);\n    } else {\n      paletteDiv = createHtmlElement('div', {\n        'id': symbolGroup.id,\n        style: style,\n        class: 'e-remove-palette'\n      });\n      this.element.appendChild(paletteDiv);\n    }\n\n    if (!isBlazor()) {\n      var item = {\n        header: symbolGroup.title,\n        expanded: symbolGroup.expanded,\n        content: '#' + symbolGroup.id,\n        iconCss: symbolGroup.iconCss\n      };\n      this.accordionElement.items.push(item);\n    }\n\n    this.renderSymbols(symbolGroup, paletteDiv);\n  };\n  /**\n   * Used to add the palette item as nodes or connectors in palettes \\\n   *\n   * @returns {void}    Used to add the palette item as nodes or connectors in palettes .\\\n   * @param {string} paletteName - provide the scale value.\n   * @param {NodeModel | ConnectorModel} paletteSymbol - provide the scale value.\n   * @param {boolean} isChild - provide the scale value.\n   */\n\n\n  SymbolPalette.prototype.addPaletteItem = function (paletteName, paletteSymbol, isChild) {\n    paletteSymbol = cloneObject(paletteSymbol); //let refresh: boolean;\n\n    for (var i = 0; i < this.palettes.length; i++) {\n      var symbolPaletteGroup = this.palettes[i];\n\n      if (symbolPaletteGroup.id.indexOf(paletteName) !== -1) {\n        // eslint-disable-next-line\n        var param = [undefined, symbolPaletteGroup, 'symbols', {}, true]; // eslint-disable-next-line\n\n        var obj = new (Function.prototype.bind.apply(getObjectType(paletteSymbol), param))();\n\n        for (var i_1 = 0; i_1 < Object.keys(paletteSymbol).length; i_1++) {\n          var isEnableServerDatabind_1 = this.allowServerDataBinding;\n          this.allowServerDataBinding = false;\n          obj[Object.keys(paletteSymbol)[i_1]] = paletteSymbol[Object.keys(paletteSymbol)[i_1]];\n          this.allowServerDataBinding = isEnableServerDatabind_1;\n        }\n\n        updateDefaultValues(obj, paletteSymbol, obj instanceof Node ? this.nodeDefaults : this.connectorDefaults);\n        symbolPaletteGroup.symbols.push(obj);\n        var isEnableServerDatabind = this.allowServerDataBinding;\n        this.allowServerDataBinding = false;\n        this.prepareSymbol(obj);\n        this.allowServerDataBinding = isEnableServerDatabind;\n        this.symbolTable[obj.id] = obj;\n\n        if (isChild) {\n          this.childTable[obj.id] = obj;\n        } else {\n          var paletteDiv = void 0;\n\n          if (isBlazor()) {\n            paletteDiv = document.getElementById(symbolPaletteGroup.id + '_content');\n          } else {\n            paletteDiv = document.getElementById(symbolPaletteGroup.id);\n          }\n\n          if (paletteDiv) {\n            paletteDiv.appendChild(this.getSymbolContainer(obj, paletteDiv));\n          }\n        }\n\n        break;\n      }\n    }\n  };\n  /**\n   * Used to remove the palette item as nodes or connectors in palettes \\\n   *\n   * @returns {void}    Used to remove the palette item as nodes or connectors in palettes .\\\n   * @param {string} paletteName - provide the scale value.\n   * @param {string} symbolId - provide the scale value.\n   */\n\n\n  SymbolPalette.prototype.removePaletteItem = function (paletteName, symbolId) {\n    var refresh;\n\n    for (var i = 0; i < this.palettes.length; i++) {\n      var symbolPaletteGroup = this.palettes[i];\n\n      if (symbolPaletteGroup.id.indexOf(paletteName) !== -1) {\n        for (var _i = 0, _a = symbolPaletteGroup.symbols; _i < _a.length; _i++) {\n          var symbol = _a[_i];\n\n          if (symbol.id.indexOf(symbolId) !== -1) {\n            var index = symbolPaletteGroup.symbols.indexOf(symbol);\n            symbolPaletteGroup.symbols.splice(index, 1);\n\n            if (symbol.children) {\n              var parentNode = symbol.children;\n\n              for (var i_2 = 0; i_2 < parentNode.length; i_2++) {\n                delete this.symbolTable[parentNode[i_2]];\n              }\n            }\n\n            delete this.symbolTable[symbol.id];\n            var element = document.getElementById(symbol.id + '_container');\n            element.parentNode.removeChild(element);\n            refresh = true;\n            break;\n          }\n        }\n      }\n\n      if (refresh) {\n        break;\n      }\n    }\n  };\n\n  SymbolPalette.prototype.prepareSymbol = function (symbol) {\n    var width;\n    var sw;\n    var height;\n    var sh;\n    var stackPanel = new StackPanel();\n    var obj = symbol;\n    var content;\n    var symbolContainer = new Canvas();\n    var container = symbol instanceof Node ? symbol.initContainer() : null;\n\n    if (container && !container.children) {\n      container.children = [];\n    } //preparing objects\n\n\n    var getSymbolTemplate = getFunction(this.getSymbolTemplate);\n\n    if (getSymbolTemplate) {\n      content = getSymbolTemplate(symbol);\n    }\n\n    if (!content) {\n      if (obj.children) {\n        content = this.getContainer(obj, container);\n      } else {\n        content = symbol.init(this);\n\n        if (symbol instanceof Node && symbol.parentId) {\n          container.children.push(content);\n        }\n      }\n    }\n\n    if (!symbol.parentId) {\n      var symbolInfo = {\n        width: this.symbolWidth,\n        height: this.symbolHeight\n      };\n      var getSymbolInfo = getFunction(this.getSymbolInfo);\n\n      if (getSymbolInfo) {\n        symbolInfo = getSymbolInfo(symbol);\n      } else if (isBlazor()) {\n        symbolInfo = this.getBlazorSymbolInfo(symbol, symbolInfo);\n      }\n\n      symbolInfo = symbolInfo || this.symbolInfo || {};\n\n      if (symbol.shape && symbol.shape.isPhase) {\n        symbolInfo.width = symbolInfo.width || this.symbolWidth;\n        symbolInfo.height = symbolInfo.height || this.symbolHeight;\n      } //defining custom templates\n\n\n      content.relativeMode = 'Object';\n      content.horizontalAlignment = content.verticalAlignment = 'Center';\n      symbolContainer.style.strokeColor = symbolContainer.style.fill = 'none';\n      symbolContainer.children = [content];\n      content.measure(new Size());\n      content.arrange(content.desiredSize);\n      width = symbolInfo.width = symbolInfo.width || (obj.width !== undefined ? content.actualSize.width : undefined) || this.symbolWidth;\n      height = symbolInfo.height = symbolInfo.height || (obj.height !== undefined ? content.actualSize.height : undefined) || this.symbolHeight;\n\n      if (width !== undefined && height !== undefined) {\n        var actualWidth = width;\n        var actualHeight = height; //let isLane: boolean = (symbol.shape as SwimLane).isLane ? true : false;\n\n        var isPhase = symbol.shape.isPhase ? true : false;\n\n        if (this.symbolWidth !== undefined) {\n          actualWidth = this.symbolWidth - this.symbolMargin.left - this.symbolMargin.right;\n        } else {\n          width += obj.style.strokeWidth;\n        }\n\n        if (this.symbolHeight !== undefined) {\n          actualHeight = this.symbolHeight - this.symbolMargin.top - this.symbolMargin.bottom;\n        } else {\n          height += obj.style.strokeWidth;\n        }\n\n        if (symbolInfo.description && symbolInfo.description.text !== '') {\n          actualHeight -= 20; // default height of the text have been reduced from the container.\n        }\n\n        sw = actualWidth / (!isPhase && content.width || width);\n        sh = actualHeight / (!isPhase && content.height || height);\n\n        if (symbolInfo.fit) {\n          sw = actualWidth / symbolInfo.width;\n          sh = actualHeight / symbolInfo.height;\n        }\n\n        width = actualWidth;\n        height = actualHeight;\n        sw = sh = Math.min(sw, sh);\n        symbolContainer.width = width;\n        symbolContainer.height = height;\n        content.width = symbolInfo.width;\n        content.height = symbolInfo.height;\n        this.scaleSymbol(symbol, symbolContainer, sw, sh, width, height);\n      } else {\n        var outerBounds = void 0;\n\n        if (symbol instanceof Connector) {\n          outerBounds = getOuterBounds(symbol);\n        }\n\n        content.width = symbol.width || outerBounds ? outerBounds.width : content.actualSize.width;\n        content.height = symbol.height || outerBounds ? outerBounds.height : content.actualSize.height;\n      }\n\n      symbol.wrapper = stackPanel;\n      stackPanel.children = [symbolContainer];\n      content.pivot = stackPanel.pivot = {\n        x: 0,\n        y: 0\n      };\n      stackPanel.id = content.id + '_symbol';\n      stackPanel.style.fill = stackPanel.style.strokeColor = 'transparent';\n\n      if (symbol instanceof Node) {\n        stackPanel.offsetX = symbol.style.strokeWidth / 2;\n        stackPanel.offsetY = symbol.style.strokeWidth / 2;\n      } else {\n        stackPanel.offsetX = 0.5;\n        stackPanel.offsetY = 0.5;\n      } //symbol description-textElement\n\n\n      this.getSymbolDescription(symbolInfo, width, stackPanel);\n      stackPanel.measure(new Size());\n      stackPanel.arrange(stackPanel.desiredSize);\n      symbolInfo.width = symbolInfo.width || content.actualSize.width;\n      symbolInfo.height = symbolInfo.height || content.actualSize.height;\n      symbol[this.info] = symbolInfo;\n    }\n\n    if (symbol.parentId) {\n      container.measure(new Size(obj.width, obj.height));\n      container.arrange(container.desiredSize);\n    }\n  };\n\n  SymbolPalette.prototype.getBlazorSymbolInfo = function (symbol, symbolInfo) {\n    var node = symbol;\n    var shapeSymbolInfo = node.symbolInfo;\n\n    if (shapeSymbolInfo) {\n      symbolInfo.description = shapeSymbolInfo.description || this.symbolInfo.description;\n      symbolInfo.fit = shapeSymbolInfo.fit || this.symbolInfo.fit;\n      symbolInfo.height = shapeSymbolInfo.height || this.symbolInfo.height;\n      symbolInfo.width = shapeSymbolInfo.width || this.symbolInfo.width;\n      symbolInfo.tooltip = shapeSymbolInfo.tooltip || this.symbolInfo.tooltip;\n      symbolInfo.template = shapeSymbolInfo.template || this.symbolInfo.template;\n    }\n\n    return symbolInfo;\n  };\n\n  SymbolPalette.prototype.getContainer = function (obj, container) {\n    container.measureChildren = false;\n    var bounds;\n    var child = obj.children;\n    container.children = [];\n\n    for (var i = 0; i < child.length; i++) {\n      if (this.symbolTable[child[i]]) {\n        container.children.push(this.symbolTable[child[i]].wrapper);\n      }\n    }\n\n    container.measure(new Size(obj.width, obj.height));\n    container.arrange(container.desiredSize);\n\n    if (container.bounds.x !== 0 || container.bounds.y !== 0) {\n      bounds = container.bounds;\n      arrangeChild(obj, bounds.x, bounds.y, this.symbolTable, false, this);\n      container = this.getContainer(obj, container);\n    }\n\n    return container;\n  };\n\n  SymbolPalette.prototype.getSymbolDescription = function (symbolInfo, width, parent) {\n    if (symbolInfo && symbolInfo.description && symbolInfo.description.text) {\n      var textElement = new TextElement(); //symbol description-textElement\n\n      symbolInfo.description.overflow = symbolInfo.description.overflow || 'Ellipsis';\n      symbolInfo.description.wrap = symbolInfo.description.wrap || 'WrapWithOverflow';\n      textElement.id = parent.id + '_text';\n      textElement.content = symbolInfo.description.text;\n      textElement.width = width;\n      textElement.height = 20;\n      textElement.style.strokeColor = 'transparent';\n      textElement.style.fill = 'transparent';\n      textElement.style.strokeWidth = 0;\n      textElement.style.textWrapping = symbolInfo.description.wrap;\n      textElement.style.textOverflow = symbolInfo.description.overflow;\n      textElement.margin = {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 5\n      };\n      parent.children.push(textElement);\n    }\n  };\n\n  SymbolPalette.prototype.renderSymbols = function (symbolGroup, parentDiv) {\n    for (var _i = 0, _a = symbolGroup.symbols; _i < _a.length; _i++) {\n      var symbol = _a[_i];\n\n      if (!symbol.parentId) {\n        this.getSymbolContainer(symbol, parentDiv);\n      }\n    }\n  };\n\n  SymbolPalette.prototype.getSymbolPreview = function ( // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  symbol, evt, parentDiv) {\n    this.allowServerDataBinding = false;\n    var canvas;\n    var sw;\n    var sh;\n    var symbolPreviewWidth = symbol.wrapper.children[0].desiredSize.width + symbol.style.strokeWidth;\n    var symbolPreviewHeight = symbol.wrapper.children[0].desiredSize.height + symbol.style.strokeWidth;\n    var content = symbol.wrapper.children[0].children[0];\n    var symbolPreview = symbol.previewSize;\n\n    if (symbol && (symbolPreview.width || symbolPreview.height) || this.symbolPreview.width !== undefined || this.symbolPreview.height !== undefined) {\n      symbolPreviewWidth = (symbolPreview.width || this.symbolPreview.width || symbolPreviewWidth) - symbol.style.strokeWidth;\n      symbolPreviewHeight = (symbolPreview.height || this.symbolPreview.height || symbolPreviewHeight) - symbol.style.strokeWidth;\n      sw = symbolPreviewWidth / content.actualSize.width;\n      sh = symbolPreviewHeight / content.actualSize.height;\n      sw = sh = Math.min(sw, sh);\n      var symbolWidth = content.actualSize.width * sw;\n      var symbolHeight = content.actualSize.height * sh;\n      symbol.wrapper.children[0].width = symbolPreviewWidth;\n      symbol.wrapper.children[0].height = symbolPreviewHeight;\n      this.measureAndArrangeSymbol(content, symbol instanceof Node);\n      this.scaleSymbol(symbol, symbol.wrapper.children[0], sw, sh, symbolWidth, symbolHeight, true);\n      symbolPreviewWidth = symbolWidth;\n      symbolPreviewHeight = symbolHeight;\n    }\n\n    var prevPosition = {\n      x: content.offsetX,\n      y: content.offsetY\n    };\n    content.offsetX = content.offsetY = symbol.style.strokeWidth / 2;\n    content.pivot = {\n      x: 0,\n      y: 0\n    };\n    this.measureAndArrangeSymbol(content, symbol instanceof Node);\n    var previewContainer = createHtmlElement('div', {\n      'draggable': 'true',\n      'class': 'e-dragclone',\n      'style': 'pointer-events:none'\n    });\n    var div;\n    document.body.appendChild(previewContainer);\n    var style = 'margin:5px;';\n\n    if (symbol.shape.type === 'Native') {\n      canvas = createSvgElement('svg', {\n        id: symbol.id + '_preview',\n        width: Math.ceil(symbolPreviewWidth) + 1,\n        height: Math.ceil(symbolPreviewHeight) + 1\n      });\n      var gElement = createSvgElement('g', {\n        id: symbol.id + '_g'\n      });\n      canvas.appendChild(gElement);\n      previewContainer.appendChild(canvas);\n      this.svgRenderer.renderElement(content, gElement, undefined, undefined, canvas);\n    } else if (symbol.shape.type === 'HTML') {\n      div = this.getHtmlSymbol(symbol, canvas, previewContainer, symbolPreviewHeight, symbolPreviewWidth, true);\n    } else {\n      if (symbol.children && symbol.children.length > 0 && groupHasType(symbol, 'HTML', this.childTable)) {\n        div = this.getGroupParent(symbol, canvas, previewContainer, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, true);\n      } else {\n        canvas = CanvasRenderer.createCanvas(symbol.id + '_preview', (Math.ceil(symbolPreviewWidth) + symbol.style.strokeWidth + 1) * 2, (Math.ceil(symbolPreviewHeight) + symbol.style.strokeWidth + 1) * 2);\n        previewContainer.appendChild(canvas); // BLAZ-3223: translate applied only for Basic and Flow now and need to add for remaining shapes in future\n\n        if (symbol.shape.type === 'Basic' || symbol.shape.type === 'Flow') {\n          style += 'transform: scale(0.5) translate(-' + canvas.width / 2 + 'px, -' + canvas.height / 2 + 'px);';\n        } else {\n          style += 'transform:scale(0.5);';\n        }\n\n        canvas.setAttribute('transform-origin', '0 0');\n        var index = 2;\n\n        if (symbol instanceof Connector) {\n          index = 1.9;\n        }\n\n        canvas.getContext('2d').setTransform(index, 0, 0, index, 0, 0);\n        this.diagramRenderer.renderElement(content, canvas, undefined);\n      }\n    }\n\n    applyStyleAgainstCsp(div && (symbol.shape.type === 'HTML' || symbol.children && symbol.children.length > 0) ? div : canvas, style);\n    content.offsetX = prevPosition.x;\n    content.offsetY = prevPosition.y;\n    this.allowServerDataBinding = true;\n    return previewContainer;\n  };\n\n  SymbolPalette.prototype.measureAndArrangeSymbol = function (content, isNode) {\n    if (content.children && !isNode) {\n      content.children[0].transform = Transform.Self;\n    }\n\n    content.measure(new Size());\n    content.arrange(content.desiredSize);\n\n    if (content.children) {\n      content.children[0].transform = Transform.Parent;\n    }\n  };\n\n  SymbolPalette.prototype.updateSymbolSize = function (symbol, width, height) {\n    var element = symbol.wrapper.children[0].children[0];\n    var strokeWidth = symbol.style.strokeWidth;\n    element.width = (width || element.width) - (strokeWidth + 1);\n    element.height = (height || element.height) - (strokeWidth + 1);\n    symbol.wrapper.measure(new Size());\n    symbol.wrapper.arrange(symbol.wrapper.desiredSize);\n  };\n\n  SymbolPalette.prototype.getSymbolContainer = function (symbol, parentDiv, preview) {\n    var symbolInfo = this.symbolTable[symbol.id][this.info];\n    var size = this.getSymbolSize(symbol, symbolInfo);\n    var width = size.width + 1;\n    var height = size.height + 1;\n    var container = createHtmlElement('div', {\n      id: symbol.id + '_container',\n      style: 'width:' + width + 'px;height:' + height + 'px;float:left;overflow:hidden',\n      title: symbolInfo.tooltip ? symbolInfo.tooltip : symbol.id\n    });\n    parentDiv.appendChild(container);\n    var canvas;\n    var gElement;\n    var div;\n\n    if (symbol.shape.type === 'Native') {\n      canvas = createSvgElement('svg', {\n        id: symbol.id,\n        width: Math.ceil(symbol.wrapper.actualSize.width) + 1,\n        height: Math.ceil(symbol.wrapper.actualSize.height) + 1\n      });\n      gElement = createSvgElement('g', {\n        id: symbol.id + '_g'\n      });\n      canvas.appendChild(gElement);\n      container.appendChild(canvas);\n      this.updateSymbolSize(symbol);\n      this.svgRenderer.renderElement(symbol.wrapper, gElement, undefined, undefined, canvas);\n    } else if (symbol.shape.type === 'HTML') {\n      div = this.getHtmlSymbol(symbol, canvas, container, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, false);\n    } else {\n      if (symbol.children && symbol.children.length > 0 && groupHasType(symbol, 'HTML', this.childTable)) {\n        div = this.getGroupParent(symbol, canvas, container, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, false);\n      } else {\n        canvas = CanvasRenderer.createCanvas(symbol.id, Math.ceil((symbol.wrapper.actualSize.width + symbol.style.strokeWidth) * 2) + 1, Math.ceil((symbol.wrapper.actualSize.height + symbol.style.strokeWidth) * 2) + 1);\n        container.appendChild(canvas);\n        var index = 2;\n\n        if (symbol instanceof Connector) {\n          index = 1.9;\n        }\n\n        canvas.getContext('2d').setTransform(index, 0, 0, index, 0, 0);\n        this.diagramRenderer.renderElement(symbol.wrapper, gElement || canvas, undefined, undefined, undefined, undefined, true, undefined, true);\n      }\n    }\n\n    if (!preview) {\n      var actualWidth = symbol.wrapper.actualSize.width + symbol.style.strokeWidth;\n      var actualHeight = symbol.wrapper.actualSize.height + symbol.style.strokeWidth;\n      var style = 'pointer-events:none;transform-origin:0 0;overflow:hidden;';\n\n      if (symbol.shape.isPhase) {\n        if (symbol.shape.orientation === 'Horizontal') {\n          style += 'margin-left:' + Math.max(this.symbolMargin.left, (width - actualWidth) / 2) + 'px;margin-top:' + size.height / 2 + 'px;';\n        } else {\n          style += 'margin-left:' + size.width / 2 + 'px;margin-top:' + Math.max(this.symbolMargin.top, (height - actualHeight) / 2) + 'px;';\n        }\n      } else {\n        style += 'margin-left:' + Math.max(this.symbolMargin.left, (width - actualWidth) / 2) + 'px;margin-top:' + Math.max(this.symbolMargin.top, (height - actualHeight) / 2) + 'px;';\n      }\n\n      if (canvas instanceof HTMLCanvasElement) {\n        style += 'transform:scale(.5,.5);';\n      }\n\n      applyStyleAgainstCsp(div && (symbol.shape.type === 'HTML' || symbol.children && symbol.children.length > 0) ? div : canvas, style);\n      container.classList.add('e-symbol-draggable');\n      return container;\n    }\n\n    return canvas;\n  };\n\n  SymbolPalette.prototype.getGroupParent = function (item, canvas, container, height, width, isPreview) {\n    var div = createHtmlElement('div', {\n      'id': item.id + (isPreview ? '_html_div_preview' : '_html_div')\n    });\n    var htmlLayer = createHtmlElement('div', {\n      'id': item.id + (isPreview ? '_htmlLayer_preview' : '_htmlLayer'),\n      'style': 'width:' + Math.ceil(width + 1) + 'px;' + 'height:' + Math.ceil(height + 1) + 'px;position:absolute',\n      'class': 'e-html-layer'\n    });\n    var htmlLayerDiv = createHtmlElement('div', {\n      'id': item.id + (isPreview ? '_htmlLayer_div_preview' : '_htmlLayer_div'),\n      'style': 'width:' + Math.ceil(width + 1) + 'px;' + 'height:' + Math.ceil(height + 1) + 'px;position:absolute'\n    });\n    htmlLayer.appendChild(htmlLayerDiv);\n    div.appendChild(htmlLayer);\n    canvas = CanvasRenderer.createCanvas(isPreview ? item.id + '_preview' : item.id, Math.ceil(width) + 1, Math.ceil(height) + 1);\n    div.appendChild(canvas);\n    container.appendChild(div);\n    this.diagramRenderer.renderElement(item.wrapper.children[0].children[0], canvas, htmlLayer);\n    return div;\n  };\n\n  SymbolPalette.prototype.getHtmlSymbol = function (symbol, canvas, container, height, width, isPreview) {\n    var div = createHtmlElement('div', {\n      'id': symbol.id + (isPreview ? '_html_div_preview' : '_html_div')\n    });\n    var htmlLayer = createHtmlElement('div', {\n      'id': symbol.id + (isPreview ? '_htmlLayer_preview' : '_htmlLayer'),\n      'style': 'width:' + Math.ceil(width + 1) + 'px;' + 'height:' + Math.ceil(height + 1) + 'px;position:absolute',\n      'class': 'e-html-layer'\n    });\n    var htmlLayerDiv = createHtmlElement('div', {\n      'id': symbol.id + (isPreview ? '_htmlLayer_div_preview' : '_htmlLayer_div'),\n      'style': 'width:' + Math.ceil(width + 1) + 'px;' + 'height:' + Math.ceil(height + 1) + 'px;position:absolute'\n    });\n    htmlLayer.appendChild(htmlLayerDiv);\n    div.appendChild(htmlLayer);\n    canvas = CanvasRenderer.createCanvas(symbol.id, Math.ceil((symbol.wrapper.actualSize.width + symbol.style.strokeWidth) * 2) + 1, Math.ceil((symbol.wrapper.actualSize.height + symbol.style.strokeWidth) * 2) + 1);\n    container.appendChild(canvas);\n    canvas.getContext('2d').setTransform(2, 0, 0, 2, 0, 0);\n    div.appendChild(canvas);\n    container.appendChild(div);\n    this.diagramRenderer.renderElement(symbol.wrapper.children[0].children[0], canvas, htmlLayer);\n    return div;\n  }; // eslint-disable-next-line\n\n\n  SymbolPalette.prototype.getSymbolSize = function (symbol, symbolInfo) {\n    var width = symbol.wrapper.actualSize.width;\n    var height = symbol.wrapper.actualSize.height;\n\n    if (!this.symbolWidth && !this.symbolHeight) {\n      width += this.symbolMargin.left + this.symbolMargin.right + symbol.style.strokeWidth;\n      height += this.symbolMargin.top + this.symbolMargin.bottom + symbol.style.strokeWidth;\n    } else {\n      width = this.symbolWidth;\n      height = Math.max(this.symbolHeight, height);\n    }\n\n    return new Size(width, height);\n  }; //end region - rendering symbols\n  //region event handlers\n\n\n  SymbolPalette.prototype.getMousePosition = function (e) {\n    var offsetY;\n    var offsetX;\n    var touchArg;\n\n    if (e.type.indexOf('touch') !== -1) {\n      touchArg = e;\n      var pageY = touchArg.changedTouches[0].clientY;\n      var pageX = touchArg.changedTouches[0].clientX;\n      offsetY = pageY - this.element.offsetTop;\n      offsetX = pageX - this.element.offsetLeft;\n    } else {\n      offsetY = e.clientY - this.element.offsetTop;\n      offsetX = e.clientX - this.element.offsetLeft;\n    }\n\n    return {\n      x: offsetX,\n      y: offsetY\n    };\n  }; // eslint-disable-next-line\n\n\n  SymbolPalette.prototype.mouseMove = function (e, touches) {\n    if (this.highlightedSymbol && (!this.selectedSymbol || this.selectedSymbol.id + '_container' !== this.highlightedSymbol.id)) {\n      this.highlightedSymbol.classList.remove('e-symbol-hover');\n      this.highlightedSymbol.style.backgroundColor = '';\n      this.highlightedSymbol = null;\n    }\n\n    var id = e.target.id.split('_container')[0];\n\n    if (this.symbolTable[id]) {\n      var container = document.getElementById(id + '_container');\n      container.classList.add('e-symbol-hover');\n      this.highlightedSymbol = container;\n    }\n\n    e.preventDefault();\n  }; // eslint-enable\n\n\n  SymbolPalette.prototype.mouseUp = function (evt) {\n    this.isMethod = true;\n\n    if (evt && evt.target) {\n      if (evt.srcElement.id === 'iconSearch') {\n        var element = document.getElementById('iconSearch');\n\n        if (element.classList.contains('e-clear-searchtext')) {\n          element.className = 'e-input-group-icon e-search e-icons';\n          document.getElementById('textEnter').value = '';\n\n          if (isBlazor()) {\n            document.getElementById(this.element.id + '_search_content').classList.add('e-symbolpalette-search-hidden');\n          }\n\n          this.searchPalette('');\n        }\n      } else {\n        var id = evt.target.id.split('_container')[0];\n\n        if (id && this.selectedSymbol) {\n          var args = {\n            oldValue: this.oldObject,\n            newValue: id\n          };\n          var event_2 = 'paletteSelectionChange';\n          this.trigger(event_2, args);\n          this.oldObject = id;\n          evt.preventDefault();\n        } else if (this.oldObject !== '') {\n          this.oldObject = '';\n        }\n      }\n    }\n  };\n\n  SymbolPalette.prototype.keyUp = function (evt) {\n    var _this = this;\n\n    if (this.enableSearch) {\n      // eslint-disable-next-line\n      var palette_1 = this;\n      var element = document.getElementById('iconSearch');\n      element.className = 'e-input-group-icon e-clear-searchtext e-icons';\n\n      if (isBlazor() && evt.target instanceof HTMLInputElement) {\n        if (evt.target.value === '') {\n          document.getElementById(this.element.id + '_search_content').classList.add('e-symbolpalette-search-hidden');\n        } else {\n          document.getElementById(this.element.id + '_search_content').classList.remove('e-symbolpalette-search-hidden');\n        }\n      }\n\n      if (evt && (evt.key === 'Enter' || evt.keyCode === 13)) {\n        if (evt.target instanceof HTMLInputElement) {\n          this.searchPalette(evt.target.value);\n        }\n      } else {\n        if (this.timer) {\n          clearTimeout(this.timer);\n        }\n\n        this.timer = setTimeout(function () {\n          if (evt.target instanceof HTMLInputElement) {\n            palette_1.searchPalette(evt.target.value);\n            _this.timer = null;\n          }\n        }, 500);\n      }\n    }\n  };\n\n  SymbolPalette.prototype.mouseDown = function (evt) {\n    var id = evt.target.id.split('_container')[0];\n\n    if (this.selectedSymbol) {\n      var oldSymbol = document.getElementById(this.selectedSymbol.id + '_container');\n\n      if (id !== this.selectedSymbol.id && oldSymbol) {\n        oldSymbol.classList.remove('e-symbol-selected');\n      }\n\n      var container = document.getElementById(this.selectedSymbol.id + '_container');\n\n      if (container) {\n        container.style.backgroundColor = '';\n      }\n\n      this.selectedSymbol = null;\n    }\n\n    if (this.symbolTable[id]) {\n      var container = document.getElementById(id + '_container');\n      container.classList.add('e-symbol-selected');\n      this.selectedSymbol = this.symbolTable[id];\n      evt.preventDefault();\n    }\n  };\n\n  SymbolPalette.prototype.keyDown = function (evt) {\n    // eslint-disable-next-line\n    var palette = this;\n    var helperElement = 'helperElement';\n    var intDestroy = 'intDestroy';\n\n    if (evt && evt.key === 'Escape') {\n      var element = palette.draggable[helperElement];\n\n      if (element && element.parentNode) {\n        element.parentNode.removeChild(element);\n        palette.draggable[intDestroy]();\n      }\n    }\n  }; //end region - event handlers\n  // region - draggable\n\n\n  SymbolPalette.prototype.initDraggable = function () {\n    if (this.allowDrag) {\n      //let drag: Draggable;\n      this.draggable = new Draggable(this.element, {\n        dragTarget: '.e-symbol-draggable',\n        helper: this.helper,\n        dragStart: this.dragStart,\n        preventDefault: false,\n        dragStop: this.dragStop,\n        drag: function (args) {\n          var target = 'target';\n          var parent = parentsUntil(args[target], 'e-droppable');\n\n          if (parent && parent.classList.contains('e-diagram')) {\n            var e2eInstance = 'ej2_instances';\n            parent[e2eInstance][0].droppable.over(args);\n          }\n        },\n        cursorAt: {\n          left: this.symbolPreview.offset.x,\n          top: this.symbolPreview.offset.y\n        }\n      });\n    }\n  }; // eslint-enable\n\n\n  SymbolPalette.prototype.dragStart = function (e) {\n    var element = this.helper[0];\n\n    if (element) {\n      element.setAttribute('paletteId', this.element.id);\n    }\n\n    if (isBlazor()) {\n      e.bindEvents(e.dragElement);\n    }\n  };\n\n  SymbolPalette.prototype.dragStop = function (e) {\n    if (!parentsUntil(e.target, 'e-diagram')) {\n      remove(e.helper);\n    }\n  }; //end region - draggable\n  //region - helper methods\n\n\n  SymbolPalette.prototype.scaleSymbol = function (symbol, symbolContainer, sw, sh, width, height, preview) {\n    if (symbol instanceof Connector) {\n      var wrapper = symbol.wrapper;\n      symbol.wrapper = symbolContainer.children[0];\n      var point = symbol.scale(sw, sh, width, height, symbolContainer.children[0]);\n      var difX = width / 2 - symbolContainer.children[0].children[0].offsetX + point.x / 2;\n      var difY = height / 2 - symbolContainer.children[0].children[0].offsetY + point.y / 2;\n\n      for (var _i = 0, _a = symbolContainer.children[0].children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        child.offsetX += difX;\n        child.offsetY += difY;\n        child.staticSize = false;\n      }\n\n      symbol.wrapper = wrapper;\n    } else if (symbol.shape.type === 'Bpmn' && this.bpmnModule) {\n      var wrapper = symbol.wrapper;\n      symbol.wrapper = symbolContainer;\n      symbolContainer.children[0].width = width;\n      symbolContainer.children[0].height = height;\n      this.bpmnModule.updateBPMN({\n        width: width,\n        height: height\n      }, symbol, symbol, null);\n      symbol.wrapper = wrapper;\n    } else {\n      if (symbol.children) {\n        var parentNode = symbol.children;\n        var w = 0;\n        var h = 0;\n\n        if (!preview) {\n          var node = void 0;\n          var container = void 0;\n\n          for (var i = 0; i < parentNode.length; i++) {\n            container = symbolContainer.children[0].children[i];\n\n            if (container) {\n              if (container.children[0].children) {\n                this.measureChild(container);\n              }\n\n              node = this.symbolTable[container.id];\n              container.width = node.width;\n              container.height = node.height;\n              container.measure(new Size());\n              container.arrange(container.children[0].desiredSize);\n            }\n          }\n        }\n\n        w = width / symbolContainer.children[0].desiredSize.width;\n        h = height / symbolContainer.children[0].desiredSize.height;\n        symbolContainer.children[0].measure(new Size());\n        symbolContainer.children[0].arrange(symbolContainer.children[0].desiredSize);\n\n        if (!preview) {\n          var children = void 0;\n\n          for (var i = 0; i < parentNode.length; i++) {\n            children = symbolContainer.children[0].children[i];\n\n            if (children) {\n              if (children.children[0].children) {\n                this.scaleChildren(children, w, h, symbol);\n              }\n\n              this.scaleGroup(children, w, h, symbol);\n            }\n          }\n        }\n\n        if (preview) {\n          ///let node: Node;\n          var scaleWidth = void 0;\n          var scaleHeight = void 0;\n          var children = void 0;\n\n          for (var i = 0; i < parentNode.length; i++) {\n            //const node: Node = this.symbolTable[parentNode[i]];\n            scaleWidth = width / symbol.wrapper.children[0].desiredSize.width;\n            scaleHeight = height / symbol.wrapper.children[0].desiredSize.height;\n            children = symbolContainer.children[0].children[i];\n\n            if (children) {\n              if (children.children[0].children) {\n                this.scaleChildren(children, scaleWidth, scaleHeight, symbol, true);\n              }\n\n              this.scaleGroup(children, scaleWidth, scaleHeight, symbol, true);\n            }\n          }\n\n          symbol.wrapper.children[0].measure(new Size());\n          symbol.wrapper.children[0].arrange(symbol.wrapper.children[0].desiredSize);\n        }\n      } else {\n        scaleElement(symbolContainer.children[0], sw, sh, symbolContainer);\n      }\n    }\n  };\n\n  SymbolPalette.prototype.scaleChildren = function (container, w, h, symbol, preview) {\n    var child;\n\n    for (var i = 0; i < container.children.length; i++) {\n      child = container.children[i];\n\n      if (!child.children[0].children) {\n        this.scaleGroup(child, w, h, symbol, preview);\n      } else {\n        this.scaleChildren(child, w, h, symbol, preview);\n      }\n    }\n  };\n\n  SymbolPalette.prototype.measureChild = function (container) {\n    var childContainer;\n    var node;\n\n    for (var i = 0; i < container.children.length; i++) {\n      childContainer = container.children[i];\n\n      if (!childContainer.children[0].children) {\n        node = this.symbolTable[childContainer.id];\n        childContainer.width = node.width;\n        childContainer.height = node.height;\n        childContainer.measure(new Size());\n        childContainer.arrange(childContainer.children[0].desiredSize);\n      } else {\n        this.measureChild(childContainer);\n      }\n    }\n  };\n\n  SymbolPalette.prototype.scaleGroup = function (child, w, h, symbol, preview) {\n    child.width = child.width * w;\n    child.height = child.height * h;\n    child.offsetX = preview ? child.offsetX * w - symbol.style.strokeWidth : child.offsetX * w + symbol.style.strokeWidth / 2;\n    child.offsetY = preview ? child.offsetY * h - symbol.style.strokeWidth : child.offsetY * h + symbol.style.strokeWidth / 2;\n    child.measure(new Size());\n    child.arrange(child.children[0].desiredSize);\n  };\n\n  SymbolPalette.prototype.refreshPalettes = function () {\n    if (!isBlazor()) {\n      this.accordionElement.items = [];\n    }\n\n    removeElementsByClass('e-remove-palette', this.element.id);\n    this.updatePalettes();\n\n    if (!isBlazor()) {\n      this.accordionElement.dataBind();\n    }\n  };\n\n  SymbolPalette.prototype.updatePalettes = function () {\n    for (var i = 0; i < this.palettes.length; i++) {\n      var symGroup = this.palettes[i];\n      this.initSymbols(symGroup);\n      this.renderPalette(symGroup);\n    }\n  };\n\n  SymbolPalette.prototype.createTextbox = function () {\n    var searchDiv = createHtmlElement('div', {\n      id: this.element.id + '_search'\n    });\n    applyStyleAgainstCsp(searchDiv, 'backgroundColor:white;height:30px'); //  searchDiv.setAttribute('style', 'backgroundColor:white;height:30px');\n\n    searchDiv.className = 'e-input-group';\n    this.element.appendChild(searchDiv);\n    var textBox = createHtmlElement('input', {});\n    textBox.placeholder = 'Search Shapes';\n    textBox.id = 'textEnter';\n    applyStyleAgainstCsp(textBox, 'width:100%;height:auto'); //textBox.setAttribute('style', 'width:100%;height:auto');\n\n    textBox.className = 'e-input';\n    searchDiv.appendChild(textBox);\n    var span = createHtmlElement('span', {\n      id: 'iconSearch',\n      className: 'e-input-group-icon e-search e-icons'\n    });\n    searchDiv.appendChild(span);\n  };\n\n  SymbolPalette.prototype.getFilterSymbol = function (symbol) {\n    var items = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      for (var j = 0; j < this.ignoreSymbolsOnSearch.length; j++) {\n        if (this.ignoreSymbolsOnSearch[j] !== symbol[i].id) {\n          items.push(symbol[0]);\n        }\n      }\n    }\n\n    return items;\n  };\n\n  SymbolPalette.prototype.searchPalette = function (value) {\n    var symbolGroup = [];\n    var element = document.getElementById('SearchPalette');\n    var paletteDiv; //remove the existing child in palette\n\n    if (element) {\n      for (var k = element.children.length - 1; k >= 0; k--) {\n        element.removeChild(element.children[k]);\n      }\n    } //add the searched item in array collection\n\n\n    for (var i = 0; i < this.palettes.length; i++) {\n      var symbolPaletteGroup = this.palettes[i];\n\n      for (var j = 0; j < symbolPaletteGroup.symbols.length; j++) {\n        var item = symbolPaletteGroup.symbols[j];\n\n        if (value !== '' && item.id.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n          symbolGroup.push(item);\n        }\n      }\n    }\n\n    var filterSymbols = getFunction(this.filterSymbols);\n\n    if (filterSymbols) {\n      symbolGroup = filterSymbols(symbolGroup) || [];\n    }\n\n    if (this.ignoreSymbolsOnSearch && this.ignoreSymbolsOnSearch.length > 0) {\n      symbolGroup = this.getFilterSymbol(symbolGroup);\n    } //create a palette collection\n\n\n    if (!element && !isBlazor()) {\n      paletteDiv = this.createSearchPalette(paletteDiv);\n      element = paletteDiv;\n    } //add the symbols into search palette\n\n\n    if (symbolGroup.length > 0) {\n      for (var _i = 0, symbolGroup_1 = symbolGroup; _i < symbolGroup_1.length; _i++) {\n        var symbol = symbolGroup_1[_i];\n\n        if (symbol.parentId === \"\") {\n          this.getSymbolContainer(symbol, element);\n        }\n      }\n    } else if (value !== '') {\n      var emptyDiv = createHtmlElement('div', {\n        'id': 'EmptyDiv',\n        'style': 'text-align:center;font-style:italic'\n      });\n      emptyDiv.innerHTML = 'No Items To Display';\n      element.appendChild(emptyDiv);\n    } else {\n      var element_1 = document.getElementById('iconSearch');\n      element_1.className = 'e-input-group-icon e-search e-icons';\n\n      if (!isBlazor()) {\n        this.accordionElement.removeItem(0);\n        var searchPalette = document.getElementById('SearchPalette');\n\n        if (searchPalette) {\n          searchPalette.remove();\n        }\n      }\n    }\n  };\n\n  SymbolPalette.prototype.createSearchPalette = function (paletteDiv) {\n    paletteDiv = createHtmlElement('div', {\n      'id': 'SearchPalette',\n      'style': 'display:none;overflow:auto;'\n    });\n    this.element.appendChild(paletteDiv);\n    var paletteCollection = {\n      header: 'Search Results',\n      expanded: true,\n      content: '#SearchPalette'\n    };\n    this.accordionElement.addItem(paletteCollection, 0);\n    return paletteDiv;\n  };\n\n  SymbolPalette.prototype.wireEvents = function () {\n    var startEvent = Browser.touchStartEvent;\n    var stopEvent = Browser.touchEndEvent;\n    var moveEvent = Browser.touchMoveEvent; //let cancelEvent: string = 'mouseleave';\n\n    var keyEvent = 'keyup';\n    var keyDownEvent = 'keydown';\n    EventHandler.add(this.element, startEvent, this.mouseDown, this);\n    EventHandler.add(this.element, moveEvent, this.mouseMove, this);\n    EventHandler.add(this.element, stopEvent, this.mouseUp, this);\n    EventHandler.add(this.element, keyEvent, this.keyUp, this);\n    EventHandler.add(document, keyDownEvent, this.keyDown, this); // initialize the draggable component\n\n    this.initDraggable();\n  };\n\n  SymbolPalette.prototype.unWireEvents = function () {\n    var startEvent = Browser.touchStartEvent;\n    var stopEvent = Browser.touchEndEvent;\n    var moveEvent = Browser.touchMoveEvent; //const cancelEvent: string = Browser.isPointer ? 'pointerleave' : 'mouseleave';\n\n    var keyEvent = 'keyup';\n    var keyDownEvent = 'keydown';\n    EventHandler.remove(this.element, startEvent, this.mouseDown);\n    EventHandler.remove(this.element, moveEvent, this.mouseMove);\n    EventHandler.remove(this.element, stopEvent, this.mouseUp);\n    EventHandler.remove(this.element, keyEvent, this.keyUp);\n    EventHandler.remove(document, keyDownEvent, this.keyDown);\n  };\n\n  __decorate([Property('S')], SymbolPalette.prototype, \"accessKey\", void 0);\n\n  __decorate([Property('100%')], SymbolPalette.prototype, \"width\", void 0);\n\n  __decorate([Property('100%')], SymbolPalette.prototype, \"height\", void 0);\n\n  __decorate([Collection([], Palette)], SymbolPalette.prototype, \"palettes\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"getSymbolInfo\", void 0);\n\n  __decorate([Property({\n    fit: true\n  })], SymbolPalette.prototype, \"symbolInfo\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"filterSymbols\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"ignoreSymbolsOnSearch\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"getSymbolTemplate\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"symbolWidth\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"symbolHeight\", void 0);\n\n  __decorate([Complex({\n    left: 10,\n    right: 10,\n    top: 10,\n    bottom: 10\n  }, Margin)], SymbolPalette.prototype, \"symbolMargin\", void 0);\n\n  __decorate([Property(true)], SymbolPalette.prototype, \"allowDrag\", void 0);\n\n  __decorate([Complex({}, SymbolPreview)], SymbolPalette.prototype, \"symbolPreview\", void 0);\n\n  __decorate([Complex({}, SymbolDragSize)], SymbolPalette.prototype, \"symbolDragSize\", void 0);\n\n  __decorate([Property(false)], SymbolPalette.prototype, \"enableSearch\", void 0);\n\n  __decorate([Property(true)], SymbolPalette.prototype, \"enableAnimation\", void 0);\n\n  __decorate([Property('Multiple')], SymbolPalette.prototype, \"expandMode\", void 0);\n\n  __decorate([Event()], SymbolPalette.prototype, \"paletteSelectionChange\", void 0);\n\n  __decorate([Event()], SymbolPalette.prototype, \"paletteExpanding\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"getNodeDefaults\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"nodeDefaults\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"getConnectorDefaults\", void 0);\n\n  __decorate([Property()], SymbolPalette.prototype, \"connectorDefaults\", void 0);\n\n  return SymbolPalette;\n}(Component);\n\nexport { SymbolPalette };","map":{"version":3,"sources":["/home/ubuntu*/Desktop/streamify/node_modules/@syncfusion/ej2-diagrams/src/symbol-palette/symbol-palette.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Component","Property","Complex","CollectionFactory","ChildProperty","Event","isBlazor","Browser","EventHandler","Draggable","Collection","remove","Accordion","Node","Connector","Shape","Size","Transform","DiagramRenderer","StackPanel","Margin","TextElement","Canvas","SvgRenderer","parentsUntil","createSvgElement","createHtmlElement","createMeasureElements","removeElementsByClass","applyStyleAgainstCsp","scaleElement","arrangeChild","groupHasType","setUMLActivityDefaults","updateDefaultValues","getFunction","randomId","cloneObject","getOuterBounds","Point","CanvasRenderer","getObjectType","obj","conn","sourcePoint","targetPoint","sourceID","targetID","sourcePortID","targetPortID","sourceDecorator","targetDecorator","shape","type","Palette","_super","parent","propName","defaultValue","isArray","call","SymbolDragSize","apply","SymbolPreview","SymbolPalette","options","element","_this","symbolTable","childTable","info","oldObject","laneTable","isExpand","isExpandMode","isMethod","paletteid","checkOnRender","helper","e","clonedElement","id","selectedSymbol","sender","split","symbol","selectedSymbols","getSymbolPreview","setAttribute","child","node","palettes","j","symbols","nodeDefaults","connectorDefaults","onPropertyChanged","newProp","oldProp","refresh","_i","_a","keys","prop","style","width","toString","height","isReact","enableSearch","createTextbox","divElement","document","getElementById","parentNode","removeChild","_b","_c","index","Number","accordionElement","items","header","title","expanded","iconCss","paletteDiv","undefined","isInteraction","updateBlazorProperties","enableAnimation","animation","expand","duration","collapse","expandMode","allowDrag","draggable","initDraggable","refreshPalettes","paletteElement","window","blazorInterop","blazor","palObj","palette","getPersistData","keyEntity","addOnPersist","preRender","collection","getElementsByClassName","overflow","accordionDiv","created","args","indexOf","item","isAllowDatabind","allowServerDataBinding","isExpanded","expanding","diagramArgs","content","cancel","event_1","trigger","appendChild","measureWindowElement","unWireEvents","wireEvents","render","diagramRenderer","svgRenderer","updatePalettes","appendTo","renderComplete","classList","getModuleName","requiredModules","modules","push","member","destroy","notify","measureElemnt","usageCount","measureElementCount","addPalettes","isEnableServerDatabind","isProtectedOnChange","initSymbols","renderPalette","bulkChanges","removePalette","paletteId","splice","removePalettes","symbolGroup","group","laneHeight","laneWidth","swimLaneObj","swimLaneShape","isHorizontal","orientation","isLane","symbolHeight","symbolWidth","lanes","laneStyle","headerStyle","headerObj","annotations","annotation","offsetX","offsetY","addPaletteItem","laneObj","children","isPhase","data","getNodeDefaults","getConnectorDefaults","parentId","prepareSymbol","_d","group_1","paletteParentDiv","class","renderSymbols","paletteName","paletteSymbol","isChild","symbolPaletteGroup","param","Function","bind","i_1","isEnableServerDatabind_1","getSymbolContainer","removePaletteItem","symbolId","i_2","sw","sh","stackPanel","symbolContainer","container","initContainer","getSymbolTemplate","getContainer","init","symbolInfo","getSymbolInfo","getBlazorSymbolInfo","relativeMode","horizontalAlignment","verticalAlignment","strokeColor","fill","measure","arrange","desiredSize","actualSize","actualWidth","actualHeight","symbolMargin","left","right","strokeWidth","top","bottom","description","text","fit","Math","min","scaleSymbol","outerBounds","wrapper","pivot","x","y","getSymbolDescription","shapeSymbolInfo","tooltip","template","measureChildren","bounds","textElement","wrap","textWrapping","textOverflow","margin","parentDiv","evt","canvas","symbolPreviewWidth","symbolPreviewHeight","symbolPreview","previewSize","measureAndArrangeSymbol","prevPosition","previewContainer","div","body","ceil","gElement","renderElement","getHtmlSymbol","getGroupParent","createCanvas","getContext","setTransform","isNode","transform","Self","Parent","updateSymbolSize","preview","size","getSymbolSize","max","HTMLCanvasElement","add","isPreview","htmlLayer","htmlLayerDiv","getMousePosition","touchArg","pageY","changedTouches","clientY","pageX","clientX","offsetTop","offsetLeft","mouseMove","touches","highlightedSymbol","backgroundColor","preventDefault","mouseUp","srcElement","contains","className","value","searchPalette","oldValue","newValue","event_2","keyUp","palette_1","HTMLInputElement","keyCode","timer","clearTimeout","setTimeout","mouseDown","oldSymbol","keyDown","helperElement","intDestroy","dragTarget","dragStart","dragStop","drag","e2eInstance","droppable","over","cursorAt","offset","bindEvents","dragElement","point","scale","difX","difY","staticSize","bpmnModule","updateBPMN","w","h","measureChild","scaleChildren","scaleGroup","scaleWidth","scaleHeight","childContainer","dataBind","symGroup","searchDiv","textBox","placeholder","span","getFilterSymbol","ignoreSymbolsOnSearch","k","toLowerCase","filterSymbols","createSearchPalette","symbolGroup_1","emptyDiv","innerHTML","element_1","removeItem","paletteCollection","addItem","startEvent","touchStartEvent","stopEvent","touchEndEvent","moveEvent","touchMoveEvent","keyEvent","keyDownEvent"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAF9E;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,IAAII,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGd,MAAM,CAACmB,wBAAP,CAAgCP,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HhB,CAA3H;AACA,MAAI,OAAOsB,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EH,CAAC,GAAGE,OAAO,CAACC,QAAR,CAAiBV,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIQ,CAAC,GAAGX,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCK,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C,EAAiD,IAAIxB,CAAC,GAAGa,UAAU,CAACW,CAAD,CAAlB,EAAuBJ,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACoB,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQjB,CAAC,CAACc,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BpB,CAAC,CAACc,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAC7E,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAclB,MAAM,CAACuB,cAAP,CAAsBX,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;AAMA;;;AACA,SAASM,SAAT,EAAoBC,QAApB,EAA8BC,OAA9B,EAAuCC,iBAAvC,EAA0DC,aAA1D,EAAyEC,KAAzE,QAAsF,sBAAtF;AACA,SAASC,QAAT,QAAyB,sBAAzB;AACA,SAASC,OAAT,EAAkBC,YAAlB,EAAgCC,SAAhC,EAA2CC,UAA3C,QAA6D,sBAA7D;AACA,SAASC,MAAT,QAAuB,sBAAvB;AACA,SAASC,SAAT,QAA0B,6BAA1B;AACA,SAASC,IAAT,EAAeC,SAAf,EAA0BC,KAA1B,EAAiCC,IAAjC,QAA6C,kBAA7C;AACA,SAASC,SAAT,QAA0B,kBAA1B;AACA,SAASC,eAAT,EAA0BC,UAA1B,EAAsCC,MAAtC,QAAoD,kBAApD;AACA,SAASC,WAAT,EAAsBC,MAAtB,QAAoC,kBAApC;AACA,SAASC,WAAT,QAA4B,mCAA5B;AACA,SAASC,YAAT,EAAuBC,gBAAvB,EAAyCC,iBAAzC,EAA4DC,qBAA5D,QAAyF,6BAAzF;AACA,SAASC,qBAAT,EAAgCC,oBAAhC,QAA4D,6BAA5D;AACA,SAASC,YAAT,EAAuBC,YAAvB,EAAqCC,YAArC,EAAmDC,sBAAnD,EAA2EC,mBAA3E,QAAsG,iCAAtG;AACA,SAASC,WAAT,EAAsBC,QAAtB,EAAgCC,WAAhC,QAAmD,8BAAnD;AACA,SAASC,cAAT,QAA+B,8BAA/B;AACA,SAASC,KAAT,QAAsB,6BAAtB;AACA,SAASC,cAAT,QAA+B,sCAA/B,C,CACA;;AACA,IAAIC,aAAa,GAAG,UAAUC,GAAV,EAAe;AAC/B,MAAIC,IAAI,GAAGD,GAAX;;AACA,MAAIC,IAAI,CAACC,WAAL,IAAoBD,IAAI,CAACE,WAAzB,IAAwCF,IAAI,CAACG,QAA7C,IAAyDH,IAAI,CAACI,QAA9D,IACGJ,IAAI,CAACK,YADR,IACwBL,IAAI,CAACM,YAD7B,IAC6CN,IAAI,CAACO,eADlD,IACqEP,IAAI,CAACQ,eAD9E,EAC+F;AAC3F,WAAOrC,SAAP;AACH;;AACD,MAAI4B,GAAG,CAACU,KAAJ,KAAcV,GAAG,CAACU,KAAJ,YAAqBrC,KAArB,IAA8B2B,GAAG,CAACU,KAAJ,CAAUC,IAAtD,CAAJ,EAAiE;AAC7D,WAAOxC,IAAP;AACH;;AACD,SAAOA,IAAP;AACH,CAVD;AAWA;AACA;AACA;;;AACA,IAAIyC,OAAO;AAAG;AAAe,UAAUC,MAAV,EAAkB;AAC3CnF,EAAAA,SAAS,CAACkF,OAAD,EAAUC,MAAV,CAAT,CAD2C,CAE3C;;;AACA,WAASD,OAAT,CAAiBE,MAAjB,EAAyBC,QAAzB,EAAmCC,YAAnC,EAAiDC,OAAjD,EAA0D;AACtD,WAAOJ,MAAM,CAACK,IAAP,CAAY,IAAZ,EAAkBJ,MAAlB,EAA0BC,QAA1B,EAAoCC,YAApC,EAAkDC,OAAlD,KAA8D,IAArE;AACH;;AACDzE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,EAAD,CADD,CAAD,EAEPqD,OAAO,CAACtE,SAFD,EAEY,IAFZ,EAEkB,KAAK,CAFvB,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEPqD,OAAO,CAACtE,SAFD,EAEY,QAFZ,EAEsB,KAAK,CAF3B,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,IAAD,CADD,CAAD,EAEPqD,OAAO,CAACtE,SAFD,EAEY,UAFZ,EAEwB,KAAK,CAF7B,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,EAAD,CADD,CAAD,EAEPqD,OAAO,CAACtE,SAFD,EAEY,SAFZ,EAEuB,KAAK,CAF5B,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,EAAD,CADD,CAAD,EAEPqD,OAAO,CAACtE,SAFD,EAEY,OAFZ,EAEqB,KAAK,CAF1B,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPiB,iBAAiB,CAACsC,aAAD,CADV,CAAD,EAEPa,OAAO,CAACtE,SAFD,EAEY,SAFZ,EAEuB,KAAK,CAF5B,CAAV;;AAGA,SAAOsE,OAAP;AACH,CAzB4B,CAyB3BlD,aAzB2B,CAA7B;;AA0BA,SAASkD,OAAT;AACA;AACA;AACA;;AACA,IAAIO,cAAc;AAAG;AAAe,UAAUN,MAAV,EAAkB;AAClDnF,EAAAA,SAAS,CAACyF,cAAD,EAAiBN,MAAjB,CAAT;;AACA,WAASM,cAAT,GAA0B;AACtB,WAAON,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACO,KAAP,CAAa,IAAb,EAAmBtE,SAAnB,CAAnB,IAAoD,IAA3D;AACH;;AACDN,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP4D,cAAc,CAAC7E,SAFR,EAEmB,OAFnB,EAE4B,KAAK,CAFjC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP4D,cAAc,CAAC7E,SAFR,EAEmB,QAFnB,EAE6B,KAAK,CAFlC,CAAV;;AAGA,SAAO6E,cAAP;AACH,CAZmC,CAYlCzD,aAZkC,CAApC;;AAaA,SAASyD,cAAT;AACA;AACA;AACA;;AACA,IAAIE,aAAa;AAAG;AAAe,UAAUR,MAAV,EAAkB;AACjDnF,EAAAA,SAAS,CAAC2F,aAAD,EAAgBR,MAAhB,CAAT;;AACA,WAASQ,aAAT,GAAyB;AACrB,WAAOR,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACO,KAAP,CAAa,IAAb,EAAmBtE,SAAnB,CAAnB,IAAoD,IAA3D;AACH;;AACDN,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP8D,aAAa,CAAC/E,SAFP,EAEkB,OAFlB,EAE2B,KAAK,CAFhC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP8D,aAAa,CAAC/E,SAFP,EAEkB,QAFlB,EAE4B,KAAK,CAFjC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPgB,OAAO,CAAC,EAAD,EAAKqC,KAAL,CADA,CAAD,EAEPwB,aAAa,CAAC/E,SAFP,EAEkB,QAFlB,EAE4B,KAAK,CAFjC,CAAV;;AAGA,SAAO+E,aAAP;AACH,CAfkC,CAejC3D,aAfiC,CAAnC;;AAgBA,SAAS2D,aAAT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA,IAAIC,aAAa;AAAG;AAAe,UAAUT,MAAV,EAAkB;AACjDnF,EAAAA,SAAS,CAAC4F,aAAD,EAAgBT,MAAhB,CAAT,CADiD,CAEjD;;AACA;AACJ;AACA;AACA;AACA;AACA;;;AACI,WAASS,aAAT,CAAuBC,OAAvB,EAAgCC,OAAhC,EAAyC;AACrC,QAAIC,KAAK,GAAGZ,MAAM,CAACK,IAAP,CAAY,IAAZ,EAAkBK,OAAlB,EAA2BC,OAA3B,KAAuC,IAAnD;AACA;;;AACAC,IAAAA,KAAK,CAACC,WAAN,GAAoB,EAApB;AACA;;AACAD,IAAAA,KAAK,CAACE,UAAN,GAAmB,EAAnB;AACAF,IAAAA,KAAK,CAACG,IAAN,GAAa,MAAb;AACAH,IAAAA,KAAK,CAACI,SAAN,GAAkB,IAAlB;AACAJ,IAAAA,KAAK,CAACK,SAAN,GAAkB,EAAlB;AACAL,IAAAA,KAAK,CAACM,QAAN,GAAiB,KAAjB;AACAN,IAAAA,KAAK,CAACO,YAAN,GAAqB,KAArB;AACAP,IAAAA,KAAK,CAACQ,QAAN,GAAiB,KAAjB;AACAR,IAAAA,KAAK,CAACS,SAAN,GAAkB,KAAlB;AACAT,IAAAA,KAAK,CAACU,aAAN,GAAsB,KAAtB,CAbqC,CAcrC;;AACAV,IAAAA,KAAK,CAACW,MAAN,GAAe,UAAUC,CAAV,EAAa;AACxB,UAAIC,aAAJ;AACA,UAAIC,EAAE,GAAId,KAAK,CAACe,cAAN,IAAwBf,KAAK,CAACe,cAAN,CAAqBD,EAA9C,IAAqDF,CAAC,CAACI,MAAF,CAAS/F,MAAT,CAAgB6F,EAAhB,CAAmBG,KAAnB,CAAyB,YAAzB,EAAuC,CAAvC,CAA9D;AACA,UAAIC,MAAM,GAAGlB,KAAK,CAACC,WAAN,CAAkBa,EAAlB,CAAb;;AACA,UAAII,MAAM,IAAIlB,KAAK,CAACe,cAApB,EAAoC;AAChCf,QAAAA,KAAK,CAACmB,eAAN,GAAwBnB,KAAK,CAACe,cAAN,CAAqBD,EAArB,KAA4BI,MAAM,CAACJ,EAAnC,GAAwCI,MAAxC,GAAiDlB,KAAK,CAACe,cAA/E,CADgC,CAEhC;;AACAF,QAAAA,aAAa,GAAGb,KAAK,CAACoB,gBAAN,CAAuBpB,KAAK,CAACmB,eAA7B,EAA8CP,CAAC,CAACI,MAAhD,EAAwDhB,KAAK,CAACD,OAA9D,CAAhB;AACAc,QAAAA,aAAa,CAACQ,YAAd,CAA2B,WAA3B,EAAwCrB,KAAK,CAACD,OAAN,CAAce,EAAtD;AACH;;AACD,aAAOD,aAAP;AACH,KAXD;;AAYA,QAAIS,KAAJ;AACA,QAAIC,IAAJ;;AACA,SAAK,IAAI5F,CAAC,GAAG,CAAb,EAAgBqE,KAAK,IAAIA,KAAK,CAACwB,QAAf,IAA2B7F,CAAC,GAAGqE,KAAK,CAACwB,QAAN,CAAelG,MAA9D,EAAsEK,CAAC,EAAvE,EAA2E;AACvE,WAAK,IAAI8F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzB,KAAK,CAACwB,QAAN,CAAe7F,CAAf,EAAkB+F,OAAlB,CAA0BpG,MAA9C,EAAsDmG,CAAC,EAAvD,EAA2D;AACvDH,QAAAA,KAAK,GAAGtB,KAAK,CAACwB,QAAN,CAAe7F,CAAf,EAAkB+F,OAAlB,CAA0BD,CAA1B,CAAR;AACAF,QAAAA,IAAI,GAAGzB,OAAO,CAAC0B,QAAR,CAAiB7F,CAAjB,EAAoB+F,OAApB,CAA4BD,CAA5B,CAAP;;AACA,YAAIH,KAAK,IAAIA,KAAK,CAACrC,KAAN,CAAYC,IAAZ,KAAqB,aAAlC,EAAiD;AAC7CpB,UAAAA,sBAAsB,CAACyD,IAAD,EAAOD,KAAP,CAAtB;AACH;;AACD,YAAItB,KAAK,CAAC2B,YAAN,IAAsB3B,KAAK,CAAC4B,iBAAhC,EAAmD;AAC/C7D,UAAAA,mBAAmB,CAACuD,KAAD,EAAQC,IAAR,EAAcD,KAAK,YAAY5E,IAAjB,GAAwBsD,KAAK,CAAC2B,YAA9B,GAA6C3B,KAAK,CAAC4B,iBAAjE,CAAnB;AACH;AACJ;AACJ;;AACD,WAAO5B,KAAP;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACI;;;AACAH,EAAAA,aAAa,CAAChF,SAAd,CAAwBgH,iBAAxB,GAA4C,UAAUC,OAAV,EAAmBC,OAAnB,EAA4B;AACpE,QAAIC,OAAO,GAAG,KAAd;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAG7H,MAAM,CAAC8H,IAAP,CAAYL,OAAZ,CAAtB,EAA4CG,EAAE,GAAGC,EAAE,CAAC5G,MAApD,EAA4D2G,EAAE,EAA9D,EAAkE;AAC9D,UAAIG,IAAI,GAAGF,EAAE,CAACD,EAAD,CAAb;;AACA,cAAQG,IAAR;AACI,aAAK,OAAL;AACI,eAAKrC,OAAL,CAAasC,KAAb,CAAmBC,KAAnB,GAA2B,KAAKA,KAAL,CAAWC,QAAX,EAA3B;AACA;;AACJ,aAAK,QAAL;AACI,eAAKxC,OAAL,CAAasC,KAAb,CAAmBG,MAAnB,GAA4B,KAAKA,MAAL,CAAYD,QAAZ,EAA5B;AACA;;AACJ,aAAK,eAAL;AACI;;AACJ,aAAK,aAAL;AACA,aAAK,cAAL;AACA,aAAK,eAAL;AACI,cAAI,KAAKE,OAAT,EAAkB;AACdT,YAAAA,OAAO,GAAG,KAAV;AACH,WAFD,MAGK;AACDA,YAAAA,OAAO,GAAG,IAAV;AACH;;AACD;;AACJ,aAAK,cAAL;AACI,cAAIF,OAAO,CAACY,YAAR,IAAwB,CAACvG,QAAQ,EAArC,EAAyC;AACrC,iBAAKwG,aAAL;AACH,WAFD,MAGK;AACD,gBAAIC,UAAU,GAAGC,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,SAA1C,CAAjB;;AACA,gBAAI8B,UAAJ,EAAgB;AACZA,cAAAA,UAAU,CAACG,UAAX,CAAsBC,WAAtB,CAAkCJ,UAAlC;AACH;AACJ;;AACD;;AACJ,aAAK,UAAL;AACI,eAAK,IAAIK,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAG7I,MAAM,CAAC8H,IAAP,CAAYL,OAAO,CAACN,QAApB,CAAtB,EAAqDyB,EAAE,GAAGC,EAAE,CAAC5H,MAA7D,EAAqE2H,EAAE,EAAvE,EAA2E;AACvE,gBAAItH,CAAC,GAAGuH,EAAE,CAACD,EAAD,CAAV;AACA,gBAAIE,KAAK,GAAGC,MAAM,CAACzH,CAAD,CAAlB;;AACA,gBAAI,CAACQ,QAAQ,EAAT,IAAe,CAAC,KAAKkH,gBAAL,CAAsBC,KAAtB,CAA4BH,KAA5B,CAApB,EAAwD;AACpD,mBAAKE,gBAAL,CAAsBC,KAAtB,CAA4BH,KAA5B,IAAqC;AACjCI,gBAAAA,MAAM,EAAEzB,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBK,KAAxB,IAAiC,EADR;AAEjCC,gBAAAA,QAAQ,EAAE3B,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBM,QAFD;AAGjCC,gBAAAA,OAAO,EAAE5B,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBO,OAAxB,IAAmC;AAHX,eAArC;AAKH;;AACD,gBAAI5B,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBX,MAA5B,EAAoC;AAChC,kBAAImB,UAAU,GAAGd,QAAQ,CAACC,cAAT,CAAwB,KAAKtB,QAAL,CAAc2B,KAAd,EAAqBrC,EAArB,GAA0B,UAAlD,CAAjB;AACA6C,cAAAA,UAAU,CAACtB,KAAX,CAAiBG,MAAjB,GAA0BV,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBX,MAAxB,GAAiC,IAA3D;AACH;;AACD,gBAAIV,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBO,OAAxB,KAAoCE,SAAxC,EAAmD;AAC/C,kBAAI,CAACzH,QAAQ,EAAb,EAAiB;AACb,qBAAKkH,gBAAL,CAAsBC,KAAtB,CAA4BH,KAA5B,EAAmCO,OAAnC,GAA6C5B,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBO,OAAxB,IAAmC,EAAhF;AACA1B,gBAAAA,OAAO,GAAG,IAAV;AACH;AACJ;;AACD,gBAAIF,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBM,QAAxB,KAAqCG,SAArC,IAAkD,CAACzH,QAAQ,EAA/D,EAAmE;AAC/D,kBAAI,CAAC,KAAKqF,QAAL,CAAc2B,KAAd,EAAqBU,aAA1B,EAAyC;AACrC,qBAAKR,gBAAL,CAAsBC,KAAtB,CAA4BH,KAA5B,EAAmCM,QAAnC,GAA8C3B,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBM,QAAtE;AACA,qBAAKnD,QAAL,GAAgB,IAAhB;AACH,eAHD,MAIK;AACD,qBAAKkB,QAAL,CAAc2B,KAAd,EAAqBU,aAArB,GAAqC,KAArC;AACH;;AACD,kBAAI,CAAC,KAAKtD,YAAN,IAAsB,CAAC,KAAKC,QAA5B,IAAwC,CAAC,KAAKF,QAAlD,EAA4D;AACxD,qBAAKA,QAAL,GAAgB,IAAhB;AACH;AACJ;;AACD,gBAAInE,QAAQ,MAAM2F,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBzB,OAAxB,KAAoC,IAAtD,EAA4D;AACxDM,cAAAA,OAAO,GAAG,IAAV;AACH;;AACD,gBAAI7F,QAAQ,MAAM2F,OAAO,CAACN,QAAR,CAAiB2B,KAAjB,EAAwBzB,OAAxB,KAAoC,IAAtD,EAA4D;AACxD,mBAAKoC,sBAAL,CAA4BhC,OAA5B;AACH;AACJ;;AACD;;AACJ,aAAK,iBAAL;AACI,cAAI,CAAC3F,QAAQ,EAAb,EAAiB;AACb,gBAAI,CAAC,KAAK4H,eAAV,EAA2B;AACvB,mBAAKV,gBAAL,CAAsBW,SAAtB,GAAkC;AAAEC,gBAAAA,MAAM,EAAE;AAAEC,kBAAAA,QAAQ,EAAE;AAAZ,iBAAV;AAA2BC,gBAAAA,QAAQ,EAAE;AAAED,kBAAAA,QAAQ,EAAE;AAAZ;AAArC,eAAlC;AACH,aAFD,MAGK;AACD,mBAAKb,gBAAL,CAAsBW,SAAtB,GAAkC;AAAEC,gBAAAA,MAAM,EAAE;AAAEC,kBAAAA,QAAQ,EAAE;AAAZ,iBAAV;AAA6BC,gBAAAA,QAAQ,EAAE;AAAED,kBAAAA,QAAQ,EAAE;AAAZ;AAAvC,eAAlC;AACH;AACJ;;AACD;;AACJ,aAAK,YAAL;AACI,cAAI,CAAC/H,QAAQ,EAAb,EAAiB;AACb,iBAAKkH,gBAAL,CAAsBe,UAAtB,GAAmC,KAAKA,UAAxC;AACApC,YAAAA,OAAO,GAAG,IAAV;AACA,iBAAKzB,YAAL,GAAoB,IAApB;AACH;;AACD;;AACJ,aAAK,WAAL;AACI,eAAK8D,SAAL,GAAiBvC,OAAO,CAACuC,SAAzB;;AACA,cAAI,CAAC,KAAKA,SAAV,EAAqB;AACjB,iBAAKC,SAAL,CAAe3D,MAAf,GAAwB,YAAY;AAChC,qBAAO,IAAP;AACH,aAFD;AAGH,WAJD,MAKK;AACD,iBAAK4D,aAAL;AACA,iBAAKD,SAAL,CAAe3D,MAAf,GAAwB,KAAKA,MAA7B;AACH;;AACD;AAnGR;AAqGH;;AACD,QAAIqB,OAAJ,EAAa;AACT,WAAKwC,eAAL;AACH;;AACD,QAAI,KAAKlE,QAAL,IAAiB,CAAC0B,OAAtB,EAA+B;AAC3B,WAAKA,OAAL;AACA,WAAK1B,QAAL,GAAgB,KAAhB;;AACA,WAAK,IAAI7F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK+G,QAAL,CAAclG,MAAlC,EAA0Cb,CAAC,EAA3C,EAA+C;AAC3C,YAAIgK,cAAc,GAAG,KAAKjD,QAAL,CAAc/G,CAAd,EAAiBqG,EAAtC;;AACA,YAAI4D,MAAM,CAACD,cAAD,CAAV,EAA4B;AACxB,cAAIC,MAAM,CAACD,cAAD,CAAN,CAAuBnJ,MAAvB,GAAgC,CAApC,EAAuC;AACnCoJ,YAAAA,MAAM,CAACD,cAAD,CAAN,CAAuB,CAAvB,EAA0B1B,UAA1B,CAAqCC,WAArC,CAAiD0B,MAAM,CAACD,cAAD,CAAN,CAAuB,CAAvB,CAAjD;AACAC,YAAAA,MAAM,CAACD,cAAD,CAAN,CAAuB,CAAvB,IAA4B,IAA5B;AACH;AACJ;AACJ;AACJ;;AACD,SAAKjE,QAAL,GAAgB,KAAhB;AACH,GA3HD;AA4HA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIX,EAAAA,aAAa,CAAChF,SAAd,CAAwBiJ,sBAAxB,GAAiD,UAAUhC,OAAV,EAAmB;AAChE,QAAI6C,aAAa,GAAG,UAApB;AACA,QAAIC,MAAM,GAAG,QAAb;;AACA,QAAIF,MAAM,IAAIA,MAAM,CAACE,MAAD,CAApB,EAA8B;AAC1B,UAAIC,MAAM,GAAG;AAAEC,QAAAA,OAAO,EAAEhD,OAAO,CAACN;AAAnB,OAAb;AACA,UAAIjD,GAAG,GAAG;AAAE,sBAAc,wBAAhB;AAA0C,sBAAcsG;AAAxD,OAAV;AACAH,MAAAA,MAAM,CAACC,aAAD,CAAN,CAAsBb,sBAAtB,CAA6CvF,GAA7C,EAAkD,IAAlD;AACH;AACJ,GARD;AASA;AACJ;AACA;AACA;AACA;;;AACIsB,EAAAA,aAAa,CAAChF,SAAd,CAAwBkK,cAAxB,GAAyC,YAAY;AACjD,QAAIC,SAAS,GAAG,CAAC,QAAD,CAAhB;AACA,WAAO,KAAKC,YAAL,CAAkBD,SAAlB,CAAP;AACH,GAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;;;AACInF,EAAAA,aAAa,CAAChF,SAAd,CAAwBqK,SAAxB,GAAoC,YAAY;AAC5C,QAAIlF,KAAK,GAAG,IAAZ;;AACA,QAAI,KAAKD,OAAL,CAAae,EAAb,KAAoB,EAAxB,EAA4B;AACxB,UAAIqE,UAAU,GAAGtC,QAAQ,CAACuC,sBAAT,CAAgC,iBAAhC,EAAmD9J,MAApE;AACA,WAAKyE,OAAL,CAAae,EAAb,GAAkB,mBAAmB,KAAKL,SAAxB,GAAoC,GAApC,GAA0C0E,UAA5D;AACH;;AACD,SAAKpF,OAAL,CAAasC,KAAb,CAAmBgD,QAAnB,GAA8B,MAA9B;AACA,SAAKtF,OAAL,CAAasC,KAAb,CAAmBG,MAAnB,GAA4B,KAAKA,MAAL,CAAYD,QAAZ,EAA5B;AACA,SAAKxC,OAAL,CAAasC,KAAb,CAAmBC,KAAnB,GAA2B,KAAKA,KAAL,CAAWC,QAAX,EAA3B;;AACA,QAAI,KAAKG,YAAL,IAAqB,CAACvG,QAAQ,EAAlC,EAAsC;AAClC,WAAKwG,aAAL;AACH,KAX2C,CAY5C;;;AACA,QAAI,CAACxG,QAAQ,EAAb,EAAiB;AACb,UAAImJ,YAAY,GAAG/H,iBAAiB,CAAC,KAAD,EAAQ;AAAEuD,QAAAA,EAAE,EAAE,KAAKf,OAAL,CAAae,EAAb,GAAkB;AAAxB,OAAR,CAApC;AACA,WAAKuC,gBAAL,GAAwB,IAAI5G,SAAJ,CAAc;AAClC2H,QAAAA,UAAU,EAAE,KAAKA;AADiB,OAAd,CAAxB;;AAGA,UAAI,CAAC,KAAKL,eAAV,EAA2B;AACvB,aAAKV,gBAAL,CAAsBW,SAAtB,GAAkC;AAAEC,UAAAA,MAAM,EAAE;AAAEC,YAAAA,QAAQ,EAAE;AAAZ,WAAV;AAA2BC,UAAAA,QAAQ,EAAE;AAAED,YAAAA,QAAQ,EAAE;AAAZ;AAArC,SAAlC;AACH;;AACD,WAAKb,gBAAL,CAAsBkC,OAAtB,GAAgC,YAAY;AACxCvF,QAAAA,KAAK,CAACU,aAAN,GAAsB,IAAtB;AACH,OAFD;;AAGA,WAAK2C,gBAAL,CAAsBI,QAAtB,GAAiC,UAAU+B,IAAV,EAAgB;AAC7C,YAAIrC,KAAK,GAAGnD,KAAK,CAACqD,gBAAN,CAAuBC,KAAvB,CAA6BmC,OAA7B,CAAqCD,IAAI,CAACE,IAA1C,CAAZ;;AACA,YAAIC,eAAe,GAAG3F,KAAK,CAAC4F,sBAA5B;AACA5F,QAAAA,KAAK,CAAC4F,sBAAN,GAA+B,KAA/B;AACA5F,QAAAA,KAAK,CAACwB,QAAN,CAAe2B,KAAf,EAAsBM,QAAtB,GAAiC+B,IAAI,CAACK,UAAtC;AACA7F,QAAAA,KAAK,CAACwB,QAAN,CAAe2B,KAAf,EAAsBU,aAAtB,GAAsC,IAAtC;AACA7D,QAAAA,KAAK,CAAC4F,sBAAN,GAA+BD,eAA/B;AACH,OAPD;;AAQA,WAAKtC,gBAAL,CAAsByC,SAAtB,GAAkC,UAAUN,IAAV,EAAgB;AAC9C,YAAIxF,KAAK,CAACU,aAAV,EAAyB;AACrB;AACA,cAAIqF,WAAW,GAAG;AACdhG,YAAAA,OAAO,EAAEyF,IAAI,CAACzF,OADA;AACSiG,YAAAA,OAAO,EAAER,IAAI,CAACQ,OADvB;AACgC7C,YAAAA,KAAK,EAAEqC,IAAI,CAACrC,KAD5C;AACmD8C,YAAAA,MAAM,EAAE,KAD3D;AAEdJ,YAAAA,UAAU,EAAEL,IAAI,CAACK,UAFH;AAEef,YAAAA,OAAO,EAAE9E,KAAK,CAACwB,QAAN,CAAegE,IAAI,CAACrC,KAApB;AAFxB,WAAlB;AAIA,cAAI+C,OAAO,GAAG,kBAAd;;AACAlG,UAAAA,KAAK,CAACmG,OAAN,CAAcD,OAAd,EAAuBH,WAAvB;;AACAP,UAAAA,IAAI,CAACS,MAAL,GAAcF,WAAW,CAACE,MAA1B;AACH;AACJ,OAXD;;AAYA,WAAKlG,OAAL,CAAaqG,WAAb,CAAyBd,YAAzB;AACH;;AACD,QAAIe,oBAAoB,GAAG,gBAA3B;;AACA,QAAI3B,MAAM,CAAC2B,oBAAD,CAAV,EAAkC;AAC9B3B,MAAAA,MAAM,CAAC2B,oBAAD,CAAN,GAA+B,IAA/B;AACH;;AACD7I,IAAAA,qBAAqB;AACrB,SAAK8I,YAAL;AACA,SAAKC,UAAL;AACH,GArDD;AAsDA;AACJ;AACA;AACA;AACA;AACA;;;AACI1G,EAAAA,aAAa,CAAChF,SAAd,CAAwB2L,MAAxB,GAAiC,YAAY;AACzC,SAAKC,eAAL,GAAuB,IAAI1J,eAAJ,CAAoB,KAAKgD,OAAL,CAAae,EAAjC,EAAqC,IAAI1D,WAAJ,EAArC,EAAwD,KAAxD,CAAvB;AACA,SAAKsJ,WAAL,GAAmB,IAAI3J,eAAJ,CAAoB,KAAKgD,OAAL,CAAae,EAAjC,EAAqC,IAAI1D,WAAJ,EAArC,EAAwD,IAAxD,CAAnB;AACA,SAAKuJ,cAAL;;AACA,QAAI,CAACxK,QAAQ,EAAb,EAAiB;AACb,WAAKkH,gBAAL,CAAsBuD,QAAtB,CAA+B,MAAM,KAAK7G,OAAL,CAAae,EAAnB,GAAwB,YAAvD;AACH;;AACD,SAAK+F,cAAL;;AACA,QAAI1K,QAAQ,EAAZ,EAAgB;AACZ,WAAK4D,OAAL,CAAa+G,SAAb,CAAuBtK,MAAvB,CAA8B,wBAA9B;AACH;AACJ,GAXD;AAYA;AACJ;AACA;AACA;AACA;AACA;;;AACIqD,EAAAA,aAAa,CAAChF,SAAd,CAAwBkM,aAAxB,GAAwC,YAAY;AAChD,WAAO,eAAP;AACH,GAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AACIlH,EAAAA,aAAa,CAAChF,SAAd,CAAwBmM,eAAxB,GAA0C,YAAY;AAClD,QAAIC,OAAO,GAAG,EAAd;AACAA,IAAAA,OAAO,CAACC,IAAR,CAAa;AACTC,MAAAA,MAAM,EAAE,MADC;AAET3B,MAAAA,IAAI,EAAE;AAFG,KAAb;AAIA,WAAOyB,OAAP;AACH,GAPD;AAQA;AACJ;AACA;AACA;AACA;;;AACIpH,EAAAA,aAAa,CAAChF,SAAd,CAAwBuM,OAAxB,GAAkC,YAAY;AAC1C,QAAI,KAAK/C,SAAT,EAAoB;AAChB,WAAKC,SAAL,CAAe8C,OAAf;AACA,WAAKd,YAAL;AACA,WAAKe,MAAL,CAAY,SAAZ,EAAuB,EAAvB;;AACAjI,MAAAA,MAAM,CAACvE,SAAP,CAAiBuM,OAAjB,CAAyB3H,IAAzB,CAA8B,IAA9B;;AACA,UAAIuG,OAAO,GAAGnD,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,YAA1C,CAAd;;AACA,UAAIkF,OAAJ,EAAa;AACT,aAAKjG,OAAL,CAAaiD,WAAb,CAAyBgD,OAAzB;AACA,YAAIsB,aAAa,GAAG,gBAApB;;AACA,YAAI5C,MAAM,CAAC4C,aAAD,CAAV,EAA2B;AACvB5C,UAAAA,MAAM,CAAC4C,aAAD,CAAN,CAAsBC,UAAtB,IAAoC,CAApC;AACA,cAAIC,mBAAmB,GAAG,qBAA1B;AACA9C,UAAAA,MAAM,CAAC8C,mBAAD,CAAN;;AACA,cAAI9C,MAAM,CAAC8C,mBAAD,CAAN,KAAgC,CAApC,EAAuC;AACnC9C,YAAAA,MAAM,CAAC4C,aAAD,CAAN,CAAsBvE,UAAtB,CAAiCC,WAAjC,CAA6C0B,MAAM,CAAC4C,aAAD,CAAnD;AACA5C,YAAAA,MAAM,CAAC4C,aAAD,CAAN,GAAwB,IAAxB;AACH;AACJ;AACJ;;AACDtB,MAAAA,OAAO,GAAGnD,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,SAA1C,CAAV;;AACA,UAAIkF,OAAJ,EAAa;AACTA,QAAAA,OAAO,CAACjD,UAAR,CAAmBC,WAAnB,CAA+BgD,OAA/B;AACH;;AACD,WAAKjG,OAAL,CAAa+G,SAAb,CAAuBtK,MAAvB,CAA8B,iBAA9B;AACH;AACJ,GA1BD;AA2BA;AACJ;AACA;AACA;AACA;AACA;;;AACIqD,EAAAA,aAAa,CAAChF,SAAd,CAAwB4M,WAAxB,GAAsC,UAAUjG,QAAV,EAAoB;AACtD,QAAIsD,OAAJ;;AACA,SAAK,IAAInJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6F,QAAQ,CAAClG,MAA7B,EAAqCK,CAAC,EAAtC,EAA0C;AACtC,UAAI+L,sBAAsB,GAAG,KAAK9B,sBAAlC;AACA,WAAK+B,mBAAL,GAA2B,IAA3B;AACA,WAAK/B,sBAAL,GAA8B,KAA9B;AACAd,MAAAA,OAAO,GAAG,IAAI3F,OAAJ,CAAY,IAAZ,EAAkB,UAAlB,EAA8BqC,QAAQ,CAAC7F,CAAD,CAAtC,EAA2C,IAA3C,CAAV;AACA,WAAK6F,QAAL,CAAc0F,IAAd,CAAmBpC,OAAnB;AACA,WAAK8C,WAAL,CAAiB9C,OAAjB;AACA,WAAKc,sBAAL,GAA8B8B,sBAA9B;AACA,WAAKC,mBAAL,GAA2B,KAA3B;AACA,WAAKE,aAAL,CAAmB/C,OAAnB;AACH;;AACD,SAAKgD,WAAL,GAAmB,EAAnB;;AACA,QAAI,CAAC3L,QAAQ,EAAb,EAAiB;AACb,WAAKkH,gBAAL,CAAsBrB,OAAtB;AACH;AACJ,GAjBD;AAkBA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AACInC,EAAAA,aAAa,CAAChF,SAAd,CAAwBkN,aAAxB,GAAwC,UAAUC,SAAV,EAAqB;AACzD,SAAK,IAAIrM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6F,QAAL,CAAclG,MAAlC,EAA0CK,CAAC,EAA3C,EAA+C;AAC3C,UAAI,KAAK6F,QAAL,CAAc7F,CAAd,EAAiBmF,EAAjB,KAAwBkH,SAA5B,EAAuC;AACnC,aAAKxG,QAAL,CAAcyG,MAAd,CAAqBtM,CAArB,EAAwB,CAAxB;;AACA,YAAI,CAACQ,QAAQ,EAAb,EAAiB;AACb,eAAKkH,gBAAL,CAAsBC,KAAtB,CAA4B2E,MAA5B,CAAmCtM,CAAnC,EAAsC,CAAtC;AACH;;AACD;AACH;AACJ;AACJ,GAVD;AAWA;AACJ;AACA;AACA;AACA;AACA;;;AACIkE,EAAAA,aAAa,CAAChF,SAAd,CAAwBqN,cAAxB,GAAyC,UAAU1G,QAAV,EAAoB;AACzD,QAAIkG,sBAAsB,GAAG,KAAK9B,sBAAlC;AACA,SAAKA,sBAAL,GAA8B,KAA9B;;AACA,SAAK,IAAIjK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6F,QAAQ,CAAClG,MAA7B,EAAqCK,CAAC,EAAtC,EAA0C;AACtC,WAAKoM,aAAL,CAAmBvG,QAAQ,CAAC7F,CAAD,CAA3B;AACH;;AACD,QAAI,CAACQ,QAAQ,EAAb,EAAiB;AACb,WAAKkH,gBAAL,CAAsBrB,OAAtB;AACH,KAFD,MAGK;AACD,WAAK2E,cAAL;AACH;;AACD,SAAKf,sBAAL,GAA8B8B,sBAA9B;AACH,GAbD,CAxYiD,CAsZjD;AACA;;AACA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AACI7H,EAAAA,aAAa,CAAChF,SAAd,CAAwB+M,WAAxB,GAAsC,UAAUO,WAAV,EAAuB;AACzD,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIC,UAAU,GAAG,CAAjB;AACA,QAAIC,SAAS,GAAG,CAAhB;;AACA,SAAK,IAAIrG,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGiG,WAAW,CAACzG,OAAlC,EAA2CO,EAAE,GAAGC,EAAE,CAAC5G,MAAnD,EAA2D2G,EAAE,EAA7D,EAAiE;AAC7D,UAAIf,MAAM,GAAGgB,EAAE,CAACD,EAAD,CAAf;;AACA,UAAIf,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,UAA1B,EAAsC;AAClC,YAAIqJ,WAAW,GAAGrH,MAAlB;AACA,YAAIsH,aAAa,GAAGtH,MAAM,CAACjC,KAA3B;AACA,YAAIwJ,YAAY,GAAID,aAAa,CAACE,WAAd,KAA8B,YAA/B,GAA+C,IAA/C,GAAsD,KAAzE;;AACA,YAAIF,aAAa,CAACG,MAAlB,EAA0B;AACtBN,UAAAA,UAAU,GAAGI,YAAY,GAAG,KAAKG,YAAL,GAAoB,KAAKA,YAAL,GAAoB,CAA3C,GAA+C,KAAKA,YAAL,GAAoB,KAAKA,YAAL,GAAoB,CAAhH;AACAN,UAAAA,SAAS,GAAGG,YAAY,GAAG,KAAKI,WAAL,GAAmB,KAAKA,WAAL,GAAmB,CAAzC,GAA6C,KAAKA,WAAL,GAAmB,KAAKA,WAAL,GAAmB,CAA3G;AACA,eAAKxI,SAAL,CAAea,MAAM,CAACJ,EAAtB,IAA4B;AAAE0B,YAAAA,MAAM,EAAE6F,UAAV;AAAsB/F,YAAAA,KAAK,EAAEgG;AAA7B,WAA5B;AACA,cAAI/E,MAAM,GAAGiF,aAAa,CAACM,KAAd,CAAoB,CAApB,EAAuBvF,MAApC;AACA,cAAIwF,SAAS,GAAGP,aAAa,CAACM,KAAd,CAAoB,CAApB,EAAuBzG,KAAvC;AACA,cAAI2G,WAAW,GAAGzF,MAAM,CAAClB,KAAzB;AACA,cAAI4G,SAAS,GAAG;AACZnI,YAAAA,EAAE,EAAE,WAAW7C,QAAQ,EADX;AACegB,YAAAA,KAAK,EAAE;AAAEC,cAAAA,IAAI,EAAE,OAAR;AAAiBD,cAAAA,KAAK,EAAE;AAAxB,aADtB;AAEZqD,YAAAA,KAAK,EAAEmG,YAAY,GAAGlF,MAAM,CAACjB,KAAV,GAAkBiG,WAAW,CAACjG,KAFrC;AAGZE,YAAAA,MAAM,EAAEiG,YAAY,GAAGF,WAAW,CAAC/F,MAAf,GAAwBe,MAAM,CAACf,MAHvC;AAIZH,YAAAA,KAAK,EAAE2G,WAJK;AAKZE,YAAAA,WAAW,EAAE,CAAC;AAAElD,cAAAA,OAAO,EAAEzC,MAAM,CAAC4F,UAAP,CAAkBnD;AAA7B,aAAD;AALD,WAAhB;AAOAiD,UAAAA,SAAS,CAACG,OAAV,GAAoBH,SAAS,CAAC3G,KAAV,GAAkB,CAAtC;AACA2G,UAAAA,SAAS,CAACI,OAAV,GAAoBJ,SAAS,CAACzG,MAAV,GAAmB,CAAvC;AACA,eAAK8G,cAAL,CAAoBnB,WAAW,CAACrH,EAAhC,EAAoCmI,SAApC;AACA,cAAIM,OAAO,GAAG;AACVzI,YAAAA,EAAE,EAAE,SAAS7C,QAAQ,EADX;AACegB,YAAAA,KAAK,EAAE;AAAEC,cAAAA,IAAI,EAAE,OAAR;AAAiBD,cAAAA,KAAK,EAAE;AAAxB,aADtB;AAEVqD,YAAAA,KAAK,EAAEmG,YAAY,GAAIF,WAAW,CAACjG,KAAZ,GAAoBiB,MAAM,CAACjB,KAA/B,GAAwCiG,WAAW,CAACjG,KAF7D;AAGVE,YAAAA,MAAM,EAAEiG,YAAY,GAAGF,WAAW,CAAC/F,MAAf,GAAyB+F,WAAW,CAAC/F,MAAZ,GAAqBe,MAAM,CAACf,MAH/D;AAIVH,YAAAA,KAAK,EAAE0G;AAJG,WAAd;AAMAQ,UAAAA,OAAO,CAACH,OAAR,GAAkBX,YAAY,GAAIQ,SAAS,CAAC3G,KAAV,GAAmBiH,OAAO,CAACjH,KAAR,GAAgB,CAAvC,GAA6CiH,OAAO,CAACjH,KAAR,GAAgB,CAA3F;AACAiH,UAAAA,OAAO,CAACF,OAAR,GAAkBZ,YAAY,GAAGc,OAAO,CAAC/G,MAAR,GAAiB,CAApB,GAAyByG,SAAS,CAACzG,MAAV,GAAoB+G,OAAO,CAAC/G,MAAR,GAAiB,CAA5F;AACA,eAAK8G,cAAL,CAAoBnB,WAAW,CAACrH,EAAhC,EAAoCyI,OAApC;AACAhB,UAAAA,WAAW,CAACiB,QAAZ,GAAuB,CAACP,SAAS,CAACnI,EAAX,EAAeyI,OAAO,CAACzI,EAAvB,CAAvB;AACH,SA3BD,MA4BK,IAAI0H,aAAa,CAACiB,OAAlB,EAA2B;AAC5BpB,UAAAA,UAAU,GAAGE,WAAW,CAAC/F,MAAZ,GAAqB+F,WAAW,CAAC/F,MAAjC,GAA0C,KAAKoG,YAA5D;AACAN,UAAAA,SAAS,GAAGC,WAAW,CAACjG,KAAZ,GAAoBiG,WAAW,CAACjG,KAAhC,GAAwC,KAAKuG,WAAzD;AACA3H,UAAAA,MAAM,CAACjC,KAAP,CAAaC,IAAb,GAAoB,MAApB;;AACA,cAAIuJ,YAAJ,EAAkB;AACdvH,YAAAA,MAAM,CAACjC,KAAP,CAAayK,IAAb,GAAoB,WAAWpB,SAAX,GAAuB,GAAvB,GAA6B,GAAjD;AACH,WAFD,MAGK;AACDpH,YAAAA,MAAM,CAACjC,KAAP,CAAayK,IAAb,GAAoB,aAAapB,SAAjC;AACH;AACJ;AACJ;;AACD,UAAIpH,MAAM,YAAYxE,IAAtB,EAA4B;AACxB,YAAIiN,eAAe,GAAG3L,WAAW,CAAC,KAAK2L,eAAN,CAAjC;;AACA,YAAIA,eAAJ,EAAqB;AACjBA,UAAAA,eAAe,CAACzI,MAAD,EAAS,IAAT,CAAf;AACH;AACJ,OALD,MAMK,IAAIA,MAAM,YAAYvE,SAAtB,EAAiC;AAClC,YAAIiN,oBAAoB,GAAG5L,WAAW,CAAC,KAAK4L,oBAAN,CAAtC;;AACA,YAAIA,oBAAJ,EAA0B;AACtBA,UAAAA,oBAAoB,CAAC1I,MAAD,EAAS,IAAT,CAApB;AACH;AACJ;;AACD,WAAKjB,WAAL,CAAiBiB,MAAM,CAACJ,EAAxB,IAA8BI,MAA9B;;AACA,UAAIA,MAAM,YAAYxE,IAAlB,IAA0BwE,MAAM,CAACsI,QAArC,EAA+C;AAC3CpB,QAAAA,KAAK,CAAClB,IAAN,CAAWhG,MAAX;AACH;AACJ;;AACD,SAAK,IAAIvF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyM,KAAK,CAAC9M,MAA1B,EAAkCK,CAAC,EAAnC,EAAuC;AACnC,UAAI4F,IAAI,GAAG,KAAK,CAAhB;;AACA,WAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2G,KAAK,CAACzM,CAAD,CAAL,CAAS6N,QAAT,CAAkBlO,MAAtC,EAA8CmG,CAAC,EAA/C,EAAmD;AAC/CF,QAAAA,IAAI,GAAI,KAAKtB,WAAL,CAAiBmI,KAAK,CAACzM,CAAD,CAAL,CAAS6N,QAAT,CAAkB/H,CAAlB,CAAjB,CAAR;;AACA,YAAIF,IAAJ,EAAU;AACN,eAAKrB,UAAL,CAAgBqB,IAAI,CAACT,EAArB,IAA2BS,IAA3B;AACAA,UAAAA,IAAI,CAACsI,QAAL,GAAgBzB,KAAK,CAACzM,CAAD,CAAL,CAASmF,EAAzB;AACH;AACJ;AACJ;;AACD,SAAK,IAAImC,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGiF,WAAW,CAACzG,OAAlC,EAA2CuB,EAAE,GAAGC,EAAE,CAAC5H,MAAnD,EAA2D2H,EAAE,EAA7D,EAAiE;AAC7D,UAAI/B,MAAM,GAAGgC,EAAE,CAACD,EAAD,CAAf;;AACA,UAAI,EAAE/B,MAAM,YAAYxE,IAAlB,IAA0BwE,MAAM,CAACsI,QAAnC,CAAJ,EAAkD;AAC9C,aAAKM,aAAL,CAAmB5I,MAAnB;AACH;AACJ;;AACD,SAAK,IAAI6I,EAAE,GAAG,CAAT,EAAYC,OAAO,GAAG5B,KAA3B,EAAkC2B,EAAE,GAAGC,OAAO,CAAC1O,MAA/C,EAAuDyO,EAAE,EAAzD,EAA6D;AACzD,UAAI7I,MAAM,GAAG8I,OAAO,CAACD,EAAD,CAApB;AACA,WAAKD,aAAL,CAAmB5I,MAAnB;AACH;AACJ,GAvFD;;AAwFArB,EAAAA,aAAa,CAAChF,SAAd,CAAwBgN,aAAxB,GAAwC,UAAUM,WAAV,EAAuB;AAC3D,QAAI9F,KAAK,GAAIlG,QAAQ,EAAT,GAAe,gBAAf,GAAkC,6BAA9C;;AACA,QAAIgM,WAAW,CAAC3F,MAAhB,EAAwB;AACpBH,MAAAA,KAAK,IAAI,YAAY8F,WAAW,CAAC3F,MAAxB,GAAiC,IAA1C;AACH;;AACD,QAAIyH,gBAAgB,GAAGpH,QAAQ,CAACC,cAAT,CAAwBqF,WAAW,CAACrH,EAApC,CAAvB;AACA,QAAI6C,UAAJ;;AACA,QAAIxH,QAAQ,MAAM8N,gBAAgB,IAAI,IAAtC,EAA4C;AACxCtG,MAAAA,UAAU,GAAGpG,iBAAiB,CAAC,KAAD,EAAQ;AAAE,cAAM4K,WAAW,CAACrH,EAAZ,GAAiB,UAAzB;AAAqCuB,QAAAA,KAAK,EAAEA,KAA5C;AAAmD6H,QAAAA,KAAK,EAAE;AAA1D,OAAR,CAA9B;AACAD,MAAAA,gBAAgB,CAAC7D,WAAjB,CAA6BzC,UAA7B;AACH,KAHD,MAIK;AACDA,MAAAA,UAAU,GAAGpG,iBAAiB,CAAC,KAAD,EAAQ;AAAE,cAAM4K,WAAW,CAACrH,EAApB;AAAwBuB,QAAAA,KAAK,EAAEA,KAA/B;AAAsC6H,QAAAA,KAAK,EAAE;AAA7C,OAAR,CAA9B;AACA,WAAKnK,OAAL,CAAaqG,WAAb,CAAyBzC,UAAzB;AACH;;AACD,QAAI,CAACxH,QAAQ,EAAb,EAAiB;AACb,UAAIuJ,IAAI,GAAG;AACPnC,QAAAA,MAAM,EAAE4E,WAAW,CAAC3E,KADb;AACoBC,QAAAA,QAAQ,EAAE0E,WAAW,CAAC1E,QAD1C;AAEPuC,QAAAA,OAAO,EAAE,MAAMmC,WAAW,CAACrH,EAFpB;AAEwB4C,QAAAA,OAAO,EAAEyE,WAAW,CAACzE;AAF7C,OAAX;AAIA,WAAKL,gBAAL,CAAsBC,KAAtB,CAA4B4D,IAA5B,CAAiCxB,IAAjC;AACH;;AACD,SAAKyE,aAAL,CAAmBhC,WAAnB,EAAgCxE,UAAhC;AACH,GAvBD;AAwBA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AACI9D,EAAAA,aAAa,CAAChF,SAAd,CAAwByO,cAAxB,GAAyC,UAAUc,WAAV,EAAuBC,aAAvB,EAAsCC,OAAtC,EAA+C;AACpFD,IAAAA,aAAa,GAAGnM,WAAW,CAACmM,aAAD,CAA3B,CADoF,CAEpF;;AACA,SAAK,IAAI1O,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6F,QAAL,CAAclG,MAAlC,EAA0CK,CAAC,EAA3C,EAA+C;AAC3C,UAAI4O,kBAAkB,GAAG,KAAK/I,QAAL,CAAc7F,CAAd,CAAzB;;AACA,UAAI4O,kBAAkB,CAACzJ,EAAnB,CAAsB2E,OAAtB,CAA8B2E,WAA9B,MAA+C,CAAC,CAApD,EAAuD;AACnD;AACA,YAAII,KAAK,GAAG,CAAC5G,SAAD,EAAY2G,kBAAZ,EAAgC,SAAhC,EAA2C,EAA3C,EAA+C,IAA/C,CAAZ,CAFmD,CAGnD;;AACA,YAAIhM,GAAG,GAAG,KAAKkM,QAAQ,CAAC5P,SAAT,CAAmB6P,IAAnB,CAAwB/K,KAAxB,CAA8BrB,aAAa,CAAC+L,aAAD,CAA3C,EAA4DG,KAA5D,CAAL,GAAV;;AACA,aAAK,IAAIG,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGtQ,MAAM,CAAC8H,IAAP,CAAYkI,aAAZ,EAA2B/O,MAAnD,EAA2DqP,GAAG,EAA9D,EAAkE;AAC9D,cAAIC,wBAAwB,GAAG,KAAKhF,sBAApC;AACA,eAAKA,sBAAL,GAA8B,KAA9B;AACArH,UAAAA,GAAG,CAAClE,MAAM,CAAC8H,IAAP,CAAYkI,aAAZ,EAA2BM,GAA3B,CAAD,CAAH,GAAuCN,aAAa,CAAChQ,MAAM,CAAC8H,IAAP,CAAYkI,aAAZ,EAA2BM,GAA3B,CAAD,CAApD;AACA,eAAK/E,sBAAL,GAA8BgF,wBAA9B;AACH;;AACD7M,QAAAA,mBAAmB,CAACQ,GAAD,EAAM8L,aAAN,EAAqB9L,GAAG,YAAY7B,IAAf,GAAsB,KAAKiF,YAA3B,GAA0C,KAAKC,iBAApE,CAAnB;AACA2I,QAAAA,kBAAkB,CAAC7I,OAAnB,CAA2BwF,IAA3B,CAAgC3I,GAAhC;AACA,YAAImJ,sBAAsB,GAAG,KAAK9B,sBAAlC;AACA,aAAKA,sBAAL,GAA8B,KAA9B;AACA,aAAKkE,aAAL,CAAmBvL,GAAnB;AACA,aAAKqH,sBAAL,GAA8B8B,sBAA9B;AACA,aAAKzH,WAAL,CAAiB1B,GAAG,CAACuC,EAArB,IAA2BvC,GAA3B;;AACA,YAAI+L,OAAJ,EAAa;AACT,eAAKpK,UAAL,CAAgB3B,GAAG,CAACuC,EAApB,IAA0BvC,GAA1B;AACH,SAFD,MAGK;AACD,cAAIoF,UAAU,GAAG,KAAK,CAAtB;;AACA,cAAIxH,QAAQ,EAAZ,EAAgB;AACZwH,YAAAA,UAAU,GAAGd,QAAQ,CAACC,cAAT,CAAwByH,kBAAkB,CAACzJ,EAAnB,GAAwB,UAAhD,CAAb;AACH,WAFD,MAGK;AACD6C,YAAAA,UAAU,GAAGd,QAAQ,CAACC,cAAT,CAAwByH,kBAAkB,CAACzJ,EAA3C,CAAb;AACH;;AACD,cAAI6C,UAAJ,EAAgB;AACZA,YAAAA,UAAU,CAACyC,WAAX,CAAuB,KAAKyE,kBAAL,CAAwBtM,GAAxB,EAA6BoF,UAA7B,CAAvB;AACH;AACJ;;AACD;AACH;AACJ;AACJ,GAzCD;AA0CA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AACI9D,EAAAA,aAAa,CAAChF,SAAd,CAAwBiQ,iBAAxB,GAA4C,UAAUV,WAAV,EAAuBW,QAAvB,EAAiC;AACzE,QAAI/I,OAAJ;;AACA,SAAK,IAAIrG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6F,QAAL,CAAclG,MAAlC,EAA0CK,CAAC,EAA3C,EAA+C;AAC3C,UAAI4O,kBAAkB,GAAG,KAAK/I,QAAL,CAAc7F,CAAd,CAAzB;;AACA,UAAI4O,kBAAkB,CAACzJ,EAAnB,CAAsB2E,OAAtB,CAA8B2E,WAA9B,MAA+C,CAAC,CAApD,EAAuD;AACnD,aAAK,IAAInI,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGqI,kBAAkB,CAAC7I,OAAzC,EAAkDO,EAAE,GAAGC,EAAE,CAAC5G,MAA1D,EAAkE2G,EAAE,EAApE,EAAwE;AACpE,cAAIf,MAAM,GAAGgB,EAAE,CAACD,EAAD,CAAf;;AACA,cAAIf,MAAM,CAACJ,EAAP,CAAU2E,OAAV,CAAkBsF,QAAlB,MAAgC,CAAC,CAArC,EAAwC;AACpC,gBAAI5H,KAAK,GAAGoH,kBAAkB,CAAC7I,OAAnB,CAA2B+D,OAA3B,CAAmCvE,MAAnC,CAAZ;AACAqJ,YAAAA,kBAAkB,CAAC7I,OAAnB,CAA2BuG,MAA3B,CAAkC9E,KAAlC,EAAyC,CAAzC;;AACA,gBAAIjC,MAAM,CAACsI,QAAX,EAAqB;AACjB,kBAAIzG,UAAU,GAAG7B,MAAM,CAACsI,QAAxB;;AACA,mBAAK,IAAIwB,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGjI,UAAU,CAACzH,MAAnC,EAA2C0P,GAAG,EAA9C,EAAkD;AAC9C,uBAAO,KAAK/K,WAAL,CAAkB8C,UAAU,CAACiI,GAAD,CAA5B,CAAP;AACH;AACJ;;AACD,mBAAO,KAAK/K,WAAL,CAAiBiB,MAAM,CAACJ,EAAxB,CAAP;AACA,gBAAIf,OAAO,GAAG8C,QAAQ,CAACC,cAAT,CAAwB5B,MAAM,CAACJ,EAAP,GAAY,YAApC,CAAd;AACAf,YAAAA,OAAO,CAACgD,UAAR,CAAmBC,WAAnB,CAA+BjD,OAA/B;AACAiC,YAAAA,OAAO,GAAG,IAAV;AACA;AACH;AACJ;AACJ;;AACD,UAAIA,OAAJ,EAAa;AACT;AACH;AACJ;AACJ,GA5BD;;AA6BAnC,EAAAA,aAAa,CAAChF,SAAd,CAAwBiP,aAAxB,GAAwC,UAAU5I,MAAV,EAAkB;AACtD,QAAIoB,KAAJ;AACA,QAAI2I,EAAJ;AACA,QAAIzI,MAAJ;AACA,QAAI0I,EAAJ;AACA,QAAIC,UAAU,GAAG,IAAInO,UAAJ,EAAjB;AACA,QAAIuB,GAAG,GAAG2C,MAAV;AACA,QAAI8E,OAAJ;AACA,QAAIoF,eAAe,GAAG,IAAIjO,MAAJ,EAAtB;AACA,QAAIkO,SAAS,GAAInK,MAAM,YAAYxE,IAAnB,GAA2BwE,MAAM,CAACoK,aAAP,EAA3B,GAAoD,IAApE;;AACA,QAAID,SAAS,IAAI,CAACA,SAAS,CAAC7B,QAA5B,EAAsC;AAClC6B,MAAAA,SAAS,CAAC7B,QAAV,GAAqB,EAArB;AACH,KAZqD,CAatD;;;AACA,QAAI+B,iBAAiB,GAAGvN,WAAW,CAAC,KAAKuN,iBAAN,CAAnC;;AACA,QAAIA,iBAAJ,EAAuB;AACnBvF,MAAAA,OAAO,GAAGuF,iBAAiB,CAACrK,MAAD,CAA3B;AACH;;AACD,QAAI,CAAC8E,OAAL,EAAc;AACV,UAAIzH,GAAG,CAACiL,QAAR,EAAkB;AACdxD,QAAAA,OAAO,GAAG,KAAKwF,YAAL,CAAkBjN,GAAlB,EAAuB8M,SAAvB,CAAV;AACH,OAFD,MAGK;AACDrF,QAAAA,OAAO,GAAG9E,MAAM,CAACuK,IAAP,CAAY,IAAZ,CAAV;;AACA,YAAIvK,MAAM,YAAYxE,IAAlB,IAA0BwE,MAAM,CAAC2I,QAArC,EAA+C;AAC3CwB,UAAAA,SAAS,CAAC7B,QAAV,CAAmBtC,IAAnB,CAAwBlB,OAAxB;AACH;AACJ;AACJ;;AACD,QAAI,CAAC9E,MAAM,CAAC2I,QAAZ,EAAsB;AAClB,UAAI6B,UAAU,GAAG;AAAEpJ,QAAAA,KAAK,EAAE,KAAKuG,WAAd;AAA2BrG,QAAAA,MAAM,EAAE,KAAKoG;AAAxC,OAAjB;AACA,UAAI+C,aAAa,GAAG3N,WAAW,CAAC,KAAK2N,aAAN,CAA/B;;AACA,UAAIA,aAAJ,EAAmB;AACfD,QAAAA,UAAU,GAAGC,aAAa,CAACzK,MAAD,CAA1B;AACH,OAFD,MAGK,IAAI/E,QAAQ,EAAZ,EAAgB;AACjBuP,QAAAA,UAAU,GAAG,KAAKE,mBAAL,CAAyB1K,MAAzB,EAAiCwK,UAAjC,CAAb;AACH;;AACDA,MAAAA,UAAU,GAAGA,UAAU,IAAI,KAAKA,UAAnB,IAAiC,EAA9C;;AACA,UAAIxK,MAAM,CAACjC,KAAP,IAAgBiC,MAAM,CAACjC,KAAP,CAAawK,OAAjC,EAA0C;AACtCiC,QAAAA,UAAU,CAACpJ,KAAX,GAAmBoJ,UAAU,CAACpJ,KAAX,IAAoB,KAAKuG,WAA5C;AACA6C,QAAAA,UAAU,CAAClJ,MAAX,GAAoBkJ,UAAU,CAAClJ,MAAX,IAAqB,KAAKoG,YAA9C;AACH,OAbiB,CAclB;;;AACA5C,MAAAA,OAAO,CAAC6F,YAAR,GAAuB,QAAvB;AACA7F,MAAAA,OAAO,CAAC8F,mBAAR,GAA8B9F,OAAO,CAAC+F,iBAAR,GAA4B,QAA1D;AACAX,MAAAA,eAAe,CAAC/I,KAAhB,CAAsB2J,WAAtB,GAAoCZ,eAAe,CAAC/I,KAAhB,CAAsB4J,IAAtB,GAA6B,MAAjE;AACAb,MAAAA,eAAe,CAAC5B,QAAhB,GAA2B,CAACxD,OAAD,CAA3B;AACAA,MAAAA,OAAO,CAACkG,OAAR,CAAgB,IAAIrP,IAAJ,EAAhB;AACAmJ,MAAAA,OAAO,CAACmG,OAAR,CAAgBnG,OAAO,CAACoG,WAAxB;AACA9J,MAAAA,KAAK,GAAGoJ,UAAU,CAACpJ,KAAX,GAAmBoJ,UAAU,CAACpJ,KAAX,KACtB/D,GAAG,CAAC+D,KAAJ,KAAcsB,SAAd,GAA0BoC,OAAO,CAACqG,UAAR,CAAmB/J,KAA7C,GAAqDsB,SAD/B,KAC6C,KAAKiF,WAD7E;AAEArG,MAAAA,MAAM,GAAGkJ,UAAU,CAAClJ,MAAX,GAAoBkJ,UAAU,CAAClJ,MAAX,KACxBjE,GAAG,CAACiE,MAAJ,KAAeoB,SAAf,GAA2BoC,OAAO,CAACqG,UAAR,CAAmB7J,MAA9C,GAAuDoB,SAD/B,KAC6C,KAAKgF,YAD/E;;AAEA,UAAItG,KAAK,KAAKsB,SAAV,IAAuBpB,MAAM,KAAKoB,SAAtC,EAAiD;AAC7C,YAAI0I,WAAW,GAAGhK,KAAlB;AACA,YAAIiK,YAAY,GAAG/J,MAAnB,CAF6C,CAG7C;;AACA,YAAIiH,OAAO,GAAGvI,MAAM,CAACjC,KAAP,CAAawK,OAAb,GAAuB,IAAvB,GAA8B,KAA5C;;AACA,YAAI,KAAKZ,WAAL,KAAqBjF,SAAzB,EAAoC;AAChC0I,UAAAA,WAAW,GAAG,KAAKzD,WAAL,GAAmB,KAAK2D,YAAL,CAAkBC,IAArC,GAA4C,KAAKD,YAAL,CAAkBE,KAA5E;AACH,SAFD,MAGK;AACDpK,UAAAA,KAAK,IAAI/D,GAAG,CAAC8D,KAAJ,CAAUsK,WAAnB;AACH;;AACD,YAAI,KAAK/D,YAAL,KAAsBhF,SAA1B,EAAqC;AACjC2I,UAAAA,YAAY,GAAG,KAAK3D,YAAL,GAAoB,KAAK4D,YAAL,CAAkBI,GAAtC,GAA4C,KAAKJ,YAAL,CAAkBK,MAA7E;AACH,SAFD,MAGK;AACDrK,UAAAA,MAAM,IAAIjE,GAAG,CAAC8D,KAAJ,CAAUsK,WAApB;AACH;;AACD,YAAIjB,UAAU,CAACoB,WAAX,IAA0BpB,UAAU,CAACoB,WAAX,CAAuBC,IAAvB,KAAgC,EAA9D,EAAkE;AAC9DR,UAAAA,YAAY,IAAI,EAAhB,CAD8D,CAC1C;AACvB;;AACDtB,QAAAA,EAAE,GAAGqB,WAAW,IAAK,CAAC7C,OAAD,IAAYzD,OAAO,CAAC1D,KAArB,IAA+BA,KAAnC,CAAhB;AACA4I,QAAAA,EAAE,GAAGqB,YAAY,IAAK,CAAC9C,OAAD,IAAYzD,OAAO,CAACxD,MAArB,IAAgCA,MAApC,CAAjB;;AACA,YAAIkJ,UAAU,CAACsB,GAAf,EAAoB;AAChB/B,UAAAA,EAAE,GAAGqB,WAAW,GAAGZ,UAAU,CAACpJ,KAA9B;AACA4I,UAAAA,EAAE,GAAGqB,YAAY,GAAGb,UAAU,CAAClJ,MAA/B;AACH;;AACDF,QAAAA,KAAK,GAAGgK,WAAR;AACA9J,QAAAA,MAAM,GAAG+J,YAAT;AACAtB,QAAAA,EAAE,GAAGC,EAAE,GAAG+B,IAAI,CAACC,GAAL,CAASjC,EAAT,EAAaC,EAAb,CAAV;AACAE,QAAAA,eAAe,CAAC9I,KAAhB,GAAwBA,KAAxB;AACA8I,QAAAA,eAAe,CAAC5I,MAAhB,GAAyBA,MAAzB;AACAwD,QAAAA,OAAO,CAAC1D,KAAR,GAAgBoJ,UAAU,CAACpJ,KAA3B;AACA0D,QAAAA,OAAO,CAACxD,MAAR,GAAiBkJ,UAAU,CAAClJ,MAA5B;AACA,aAAK2K,WAAL,CAAiBjM,MAAjB,EAAyBkK,eAAzB,EAA0CH,EAA1C,EAA8CC,EAA9C,EAAkD5I,KAAlD,EAAyDE,MAAzD;AACH,OAlCD,MAmCK;AACD,YAAI4K,WAAW,GAAG,KAAK,CAAvB;;AACA,YAAIlM,MAAM,YAAYvE,SAAtB,EAAiC;AAC7ByQ,UAAAA,WAAW,GAAGjP,cAAc,CAAC+C,MAAD,CAA5B;AACH;;AACD8E,QAAAA,OAAO,CAAC1D,KAAR,GAAgBpB,MAAM,CAACoB,KAAP,IAAiB8K,WAAjB,GAAgCA,WAAW,CAAC9K,KAA5C,GAAoD0D,OAAO,CAACqG,UAAR,CAAmB/J,KAAvF;AACA0D,QAAAA,OAAO,CAACxD,MAAR,GAAiBtB,MAAM,CAACsB,MAAP,IAAkB4K,WAAlB,GAAiCA,WAAW,CAAC5K,MAA7C,GAAsDwD,OAAO,CAACqG,UAAR,CAAmB7J,MAA1F;AACH;;AACDtB,MAAAA,MAAM,CAACmM,OAAP,GAAiBlC,UAAjB;AACAA,MAAAA,UAAU,CAAC3B,QAAX,GAAsB,CAAC4B,eAAD,CAAtB;AACApF,MAAAA,OAAO,CAACsH,KAAR,GAAgBnC,UAAU,CAACmC,KAAX,GAAmB;AAAEC,QAAAA,CAAC,EAAE,CAAL;AAAQC,QAAAA,CAAC,EAAE;AAAX,OAAnC;AACArC,MAAAA,UAAU,CAACrK,EAAX,GAAgBkF,OAAO,CAAClF,EAAR,GAAa,SAA7B;AACAqK,MAAAA,UAAU,CAAC9I,KAAX,CAAiB4J,IAAjB,GAAwBd,UAAU,CAAC9I,KAAX,CAAiB2J,WAAjB,GAA+B,aAAvD;;AACA,UAAI9K,MAAM,YAAYxE,IAAtB,EAA4B;AACxByO,QAAAA,UAAU,CAAC/B,OAAX,GAAqBlI,MAAM,CAACmB,KAAP,CAAasK,WAAb,GAA2B,CAAhD;AACAxB,QAAAA,UAAU,CAAC9B,OAAX,GAAqBnI,MAAM,CAACmB,KAAP,CAAasK,WAAb,GAA2B,CAAhD;AACH,OAHD,MAIK;AACDxB,QAAAA,UAAU,CAAC/B,OAAX,GAAqB,GAArB;AACA+B,QAAAA,UAAU,CAAC9B,OAAX,GAAqB,GAArB;AACH,OAhFiB,CAiFlB;;;AACA,WAAKoE,oBAAL,CAA0B/B,UAA1B,EAAsCpJ,KAAtC,EAA6C6I,UAA7C;AACAA,MAAAA,UAAU,CAACe,OAAX,CAAmB,IAAIrP,IAAJ,EAAnB;AACAsO,MAAAA,UAAU,CAACgB,OAAX,CAAmBhB,UAAU,CAACiB,WAA9B;AACAV,MAAAA,UAAU,CAACpJ,KAAX,GAAmBoJ,UAAU,CAACpJ,KAAX,IAAoB0D,OAAO,CAACqG,UAAR,CAAmB/J,KAA1D;AACAoJ,MAAAA,UAAU,CAAClJ,MAAX,GAAoBkJ,UAAU,CAAClJ,MAAX,IAAqBwD,OAAO,CAACqG,UAAR,CAAmB7J,MAA5D;AACAtB,MAAAA,MAAM,CAAC,KAAKf,IAAN,CAAN,GAAoBuL,UAApB;AACH;;AACD,QAAIxK,MAAM,CAAC2I,QAAX,EAAqB;AACjBwB,MAAAA,SAAS,CAACa,OAAV,CAAkB,IAAIrP,IAAJ,CAAS0B,GAAG,CAAC+D,KAAb,EAAoB/D,GAAG,CAACiE,MAAxB,CAAlB;AACA6I,MAAAA,SAAS,CAACc,OAAV,CAAkBd,SAAS,CAACe,WAA5B;AACH;AACJ,GA1HD;;AA2HAvM,EAAAA,aAAa,CAAChF,SAAd,CAAwB+Q,mBAAxB,GAA8C,UAAU1K,MAAV,EAAkBwK,UAAlB,EAA8B;AACxE,QAAInK,IAAI,GAAGL,MAAX;AACA,QAAIwM,eAAe,GAAGnM,IAAI,CAACmK,UAA3B;;AACA,QAAIgC,eAAJ,EAAqB;AACjBhC,MAAAA,UAAU,CAACoB,WAAX,GAAyBY,eAAe,CAACZ,WAAhB,IAA+B,KAAKpB,UAAL,CAAgBoB,WAAxE;AACApB,MAAAA,UAAU,CAACsB,GAAX,GAAiBU,eAAe,CAACV,GAAhB,IAAuB,KAAKtB,UAAL,CAAgBsB,GAAxD;AACAtB,MAAAA,UAAU,CAAClJ,MAAX,GAAoBkL,eAAe,CAAClL,MAAhB,IAA0B,KAAKkJ,UAAL,CAAgBlJ,MAA9D;AACAkJ,MAAAA,UAAU,CAACpJ,KAAX,GAAmBoL,eAAe,CAACpL,KAAhB,IAAyB,KAAKoJ,UAAL,CAAgBpJ,KAA5D;AACAoJ,MAAAA,UAAU,CAACiC,OAAX,GAAqBD,eAAe,CAACC,OAAhB,IAA2B,KAAKjC,UAAL,CAAgBiC,OAAhE;AACAjC,MAAAA,UAAU,CAACkC,QAAX,GAAsBF,eAAe,CAACE,QAAhB,IAA4B,KAAKlC,UAAL,CAAgBkC,QAAlE;AACH;;AACD,WAAOlC,UAAP;AACH,GAZD;;AAaA7L,EAAAA,aAAa,CAAChF,SAAd,CAAwB2Q,YAAxB,GAAuC,UAAUjN,GAAV,EAAe8M,SAAf,EAA0B;AAC7DA,IAAAA,SAAS,CAACwC,eAAV,GAA4B,KAA5B;AACA,QAAIC,MAAJ;AACA,QAAIxM,KAAK,GAAG/C,GAAG,CAACiL,QAAhB;AACA6B,IAAAA,SAAS,CAAC7B,QAAV,GAAqB,EAArB;;AACA,SAAK,IAAI7N,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2F,KAAK,CAAChG,MAA1B,EAAkCK,CAAC,EAAnC,EAAuC;AACnC,UAAI,KAAKsE,WAAL,CAAiBqB,KAAK,CAAC3F,CAAD,CAAtB,CAAJ,EAAgC;AAC5B0P,QAAAA,SAAS,CAAC7B,QAAV,CAAmBtC,IAAnB,CAAwB,KAAKjH,WAAL,CAAiBqB,KAAK,CAAC3F,CAAD,CAAtB,EAA2B0R,OAAnD;AACH;AACJ;;AACDhC,IAAAA,SAAS,CAACa,OAAV,CAAkB,IAAIrP,IAAJ,CAAS0B,GAAG,CAAC+D,KAAb,EAAoB/D,GAAG,CAACiE,MAAxB,CAAlB;AACA6I,IAAAA,SAAS,CAACc,OAAV,CAAkBd,SAAS,CAACe,WAA5B;;AACA,QAAIf,SAAS,CAACyC,MAAV,CAAiBP,CAAjB,KAAuB,CAAvB,IAA4BlC,SAAS,CAACyC,MAAV,CAAiBN,CAAjB,KAAuB,CAAvD,EAA0D;AACtDM,MAAAA,MAAM,GAAGzC,SAAS,CAACyC,MAAnB;AACAlQ,MAAAA,YAAY,CAACW,GAAD,EAAMuP,MAAM,CAACP,CAAb,EAAgBO,MAAM,CAACN,CAAvB,EAA0B,KAAKvN,WAA/B,EAA4C,KAA5C,EAAmD,IAAnD,CAAZ;AACAoL,MAAAA,SAAS,GAAG,KAAKG,YAAL,CAAkBjN,GAAlB,EAAuB8M,SAAvB,CAAZ;AACH;;AACD,WAAOA,SAAP;AACH,GAlBD;;AAmBAxL,EAAAA,aAAa,CAAChF,SAAd,CAAwB4S,oBAAxB,GAA+C,UAAU/B,UAAV,EAAsBpJ,KAAtB,EAA6BjD,MAA7B,EAAqC;AAChF,QAAIqM,UAAU,IAAIA,UAAU,CAACoB,WAAzB,IAAwCpB,UAAU,CAACoB,WAAX,CAAuBC,IAAnE,EAAyE;AACrE,UAAIgB,WAAW,GAAG,IAAI7Q,WAAJ,EAAlB,CADqE,CAErE;;AACAwO,MAAAA,UAAU,CAACoB,WAAX,CAAuBzH,QAAvB,GAAkCqG,UAAU,CAACoB,WAAX,CAAuBzH,QAAvB,IAAmC,UAArE;AACAqG,MAAAA,UAAU,CAACoB,WAAX,CAAuBkB,IAAvB,GAA8BtC,UAAU,CAACoB,WAAX,CAAuBkB,IAAvB,IAA+B,kBAA7D;AACAD,MAAAA,WAAW,CAACjN,EAAZ,GAAiBzB,MAAM,CAACyB,EAAP,GAAY,OAA7B;AACAiN,MAAAA,WAAW,CAAC/H,OAAZ,GAAsB0F,UAAU,CAACoB,WAAX,CAAuBC,IAA7C;AACAgB,MAAAA,WAAW,CAACzL,KAAZ,GAAoBA,KAApB;AACAyL,MAAAA,WAAW,CAACvL,MAAZ,GAAqB,EAArB;AACAuL,MAAAA,WAAW,CAAC1L,KAAZ,CAAkB2J,WAAlB,GAAgC,aAAhC;AACA+B,MAAAA,WAAW,CAAC1L,KAAZ,CAAkB4J,IAAlB,GAAyB,aAAzB;AACA8B,MAAAA,WAAW,CAAC1L,KAAZ,CAAkBsK,WAAlB,GAAgC,CAAhC;AACAoB,MAAAA,WAAW,CAAC1L,KAAZ,CAAkB4L,YAAlB,GAAiCvC,UAAU,CAACoB,WAAX,CAAuBkB,IAAxD;AACAD,MAAAA,WAAW,CAAC1L,KAAZ,CAAkB6L,YAAlB,GAAiCxC,UAAU,CAACoB,WAAX,CAAuBzH,QAAxD;AACA0I,MAAAA,WAAW,CAACI,MAAZ,GAAqB;AAAE1B,QAAAA,IAAI,EAAE,CAAR;AAAWC,QAAAA,KAAK,EAAE,CAAlB;AAAqBE,QAAAA,GAAG,EAAE,CAA1B;AAA6BC,QAAAA,MAAM,EAAE;AAArC,OAArB;AACAxN,MAAAA,MAAM,CAACmK,QAAP,CAAgBtC,IAAhB,CAAqB6G,WAArB;AACH;AACJ,GAlBD;;AAmBAlO,EAAAA,aAAa,CAAChF,SAAd,CAAwBsP,aAAxB,GAAwC,UAAUhC,WAAV,EAAuBiG,SAAvB,EAAkC;AACtE,SAAK,IAAInM,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGiG,WAAW,CAACzG,OAAlC,EAA2CO,EAAE,GAAGC,EAAE,CAAC5G,MAAnD,EAA2D2G,EAAE,EAA7D,EAAiE;AAC7D,UAAIf,MAAM,GAAGgB,EAAE,CAACD,EAAD,CAAf;;AACA,UAAI,CAACf,MAAM,CAAC2I,QAAZ,EAAsB;AAClB,aAAKgB,kBAAL,CAAwB3J,MAAxB,EAAgCkN,SAAhC;AACH;AACJ;AACJ,GAPD;;AAQAvO,EAAAA,aAAa,CAAChF,SAAd,CAAwBuG,gBAAxB,GAA2C,WAC3C;AACAF,EAAAA,MAF2C,EAEnCmN,GAFmC,EAE9BD,SAF8B,EAEnB;AACpB,SAAKxI,sBAAL,GAA8B,KAA9B;AACA,QAAI0I,MAAJ;AACA,QAAIrD,EAAJ;AACA,QAAIC,EAAJ;AACA,QAAIqD,kBAAkB,GAAGrN,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B4C,WAA3B,CAAuC9J,KAAvC,GAA+CpB,MAAM,CAACmB,KAAP,CAAasK,WAArF;AACA,QAAI6B,mBAAmB,GAAGtN,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B4C,WAA3B,CAAuC5J,MAAvC,GAAgDtB,MAAM,CAACmB,KAAP,CAAasK,WAAvF;AACA,QAAI3G,OAAO,GAAG9E,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2BA,QAA3B,CAAoC,CAApC,CAAd;AACA,QAAIiF,aAAa,GAAGvN,MAAM,CAACwN,WAA3B;;AACA,QAAKxN,MAAM,KAAKuN,aAAa,CAACnM,KAAd,IAAuBmM,aAAa,CAACjM,MAA1C,CAAP,IACA,KAAKiM,aAAL,CAAmBnM,KAAnB,KAA6BsB,SAD7B,IAC0C,KAAK6K,aAAL,CAAmBjM,MAAnB,KAA8BoB,SAD5E,EACuF;AACnF2K,MAAAA,kBAAkB,GAAG,CAACE,aAAa,CAACnM,KAAd,IAAuB,KAAKmM,aAAL,CAAmBnM,KAA1C,IAAmDiM,kBAApD,IAA0ErN,MAAM,CAACmB,KAAP,CAAasK,WAA5G;AACA6B,MAAAA,mBAAmB,GAAG,CAACC,aAAa,CAACjM,MAAd,IAAwB,KAAKiM,aAAL,CAAmBjM,MAA3C,IAAqDgM,mBAAtD,IAA6EtN,MAAM,CAACmB,KAAP,CAAasK,WAAhH;AACA1B,MAAAA,EAAE,GAAGsD,kBAAkB,GAAGvI,OAAO,CAACqG,UAAR,CAAmB/J,KAA7C;AACA4I,MAAAA,EAAE,GAAGsD,mBAAmB,GAAGxI,OAAO,CAACqG,UAAR,CAAmB7J,MAA9C;AACAyI,MAAAA,EAAE,GAAGC,EAAE,GAAG+B,IAAI,CAACC,GAAL,CAASjC,EAAT,EAAaC,EAAb,CAAV;AACA,UAAIrC,WAAW,GAAG7C,OAAO,CAACqG,UAAR,CAAmB/J,KAAnB,GAA2B2I,EAA7C;AACA,UAAIrC,YAAY,GAAG5C,OAAO,CAACqG,UAAR,CAAmB7J,MAAnB,GAA4B0I,EAA/C;AACAhK,MAAAA,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2BlH,KAA3B,GAAmCiM,kBAAnC;AACArN,MAAAA,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2BhH,MAA3B,GAAoCgM,mBAApC;AACA,WAAKG,uBAAL,CAA6B3I,OAA7B,EAAsC9E,MAAM,YAAYxE,IAAxD;AACA,WAAKyQ,WAAL,CAAiBjM,MAAjB,EAAyBA,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,CAAzB,EAAqDyB,EAArD,EAAyDC,EAAzD,EAA6DrC,WAA7D,EAA0ED,YAA1E,EAAwF,IAAxF;AACA2F,MAAAA,kBAAkB,GAAG1F,WAArB;AACA2F,MAAAA,mBAAmB,GAAG5F,YAAtB;AACH;;AACD,QAAIgG,YAAY,GAAG;AAAErB,MAAAA,CAAC,EAAEvH,OAAO,CAACoD,OAAb;AAAsBoE,MAAAA,CAAC,EAAExH,OAAO,CAACqD;AAAjC,KAAnB;AACArD,IAAAA,OAAO,CAACoD,OAAR,GAAkBpD,OAAO,CAACqD,OAAR,GAAkBnI,MAAM,CAACmB,KAAP,CAAasK,WAAb,GAA2B,CAA/D;AACA3G,IAAAA,OAAO,CAACsH,KAAR,GAAgB;AAAEC,MAAAA,CAAC,EAAE,CAAL;AAAQC,MAAAA,CAAC,EAAE;AAAX,KAAhB;AACA,SAAKmB,uBAAL,CAA6B3I,OAA7B,EAAsC9E,MAAM,YAAYxE,IAAxD;AACA,QAAImS,gBAAgB,GAAGtR,iBAAiB,CAAC,KAAD,EAAQ;AAAE,mBAAa,MAAf;AAAuB,eAAS,aAAhC;AAA+C,eAAS;AAAxD,KAAR,CAAxC;AACA,QAAIuR,GAAJ;AACAjM,IAAAA,QAAQ,CAACkM,IAAT,CAAc3I,WAAd,CAA0ByI,gBAA1B;AACA,QAAIxM,KAAK,GAAG,aAAZ;;AACA,QAAInB,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,QAA1B,EAAoC;AAChCoP,MAAAA,MAAM,GAAGhR,gBAAgB,CAAC,KAAD,EAAQ;AAC7BwD,QAAAA,EAAE,EAAEI,MAAM,CAACJ,EAAP,GAAY,UADa;AAE7BwB,QAAAA,KAAK,EAAE2K,IAAI,CAAC+B,IAAL,CAAUT,kBAAV,IAAgC,CAFV;AAG7B/L,QAAAA,MAAM,EAAEyK,IAAI,CAAC+B,IAAL,CAAUR,mBAAV,IAAiC;AAHZ,OAAR,CAAzB;AAKA,UAAIS,QAAQ,GAAG3R,gBAAgB,CAAC,GAAD,EAAM;AAAEwD,QAAAA,EAAE,EAAEI,MAAM,CAACJ,EAAP,GAAY;AAAlB,OAAN,CAA/B;AACAwN,MAAAA,MAAM,CAAClI,WAAP,CAAmB6I,QAAnB;AACAJ,MAAAA,gBAAgB,CAACzI,WAAjB,CAA6BkI,MAA7B;AACA,WAAK5H,WAAL,CAAiBwI,aAAjB,CAA+BlJ,OAA/B,EAAwCiJ,QAAxC,EAAkDrL,SAAlD,EAA6DA,SAA7D,EAAwE0K,MAAxE;AACH,KAVD,MAWK,IAAIpN,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAA1B,EAAkC;AACnC4P,MAAAA,GAAG,GAAG,KAAKK,aAAL,CAAmBjO,MAAnB,EAA2BoN,MAA3B,EAAmCO,gBAAnC,EAAqDL,mBAArD,EAA0ED,kBAA1E,EAA8F,IAA9F,CAAN;AACH,KAFI,MAGA;AACD,UAAIrN,MAAM,CAACsI,QAAP,IACAtI,MAAM,CAACsI,QAAP,CAAgBlO,MAAhB,GAAyB,CADzB,IAC8BuC,YAAY,CAACqD,MAAD,EAAS,MAAT,EAAiB,KAAKhB,UAAtB,CAD9C,EACiF;AAC7E4O,QAAAA,GAAG,GAAG,KAAKM,cAAL,CAAoBlO,MAApB,EAA4BoN,MAA5B,EAAoCO,gBAApC,EAAsD3N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAAhF,EAAwFtB,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAAlH,EAAyH,IAAzH,CAAN;AACH,OAHD,MAIK;AACDgM,QAAAA,MAAM,GAAGjQ,cAAc,CAACgR,YAAf,CAA4BnO,MAAM,CAACJ,EAAP,GAAY,UAAxC,EAAoD,CAACmM,IAAI,CAAC+B,IAAL,CAAUT,kBAAV,IAAgCrN,MAAM,CAACmB,KAAP,CAAasK,WAA7C,GAA2D,CAA5D,IAAiE,CAArH,EAAwH,CAACM,IAAI,CAAC+B,IAAL,CAAUR,mBAAV,IAAiCtN,MAAM,CAACmB,KAAP,CAAasK,WAA9C,GAA4D,CAA7D,IAAkE,CAA1L,CAAT;AACAkC,QAAAA,gBAAgB,CAACzI,WAAjB,CAA6BkI,MAA7B,EAFC,CAGD;;AACA,YAAIpN,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,OAAtB,IAAiCgC,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAA3D,EAAmE;AAC/DmD,UAAAA,KAAK,IAAI,sCAAsCiM,MAAM,CAAChM,KAAP,GAAe,CAArD,GAAyD,OAAzD,GAAmEgM,MAAM,CAAC9L,MAAP,GAAgB,CAAnF,GAAuF,MAAhG;AACH,SAFD,MAGK;AACDH,UAAAA,KAAK,IAAI,uBAAT;AACH;;AACDiM,QAAAA,MAAM,CAACjN,YAAP,CAAoB,kBAApB,EAAwC,KAAxC;AACA,YAAI8B,KAAK,GAAG,CAAZ;;AACA,YAAIjC,MAAM,YAAYvE,SAAtB,EAAiC;AAC7BwG,UAAAA,KAAK,GAAG,GAAR;AACH;;AACDmL,QAAAA,MAAM,CAACgB,UAAP,CAAkB,IAAlB,EAAwBC,YAAxB,CAAqCpM,KAArC,EAA4C,CAA5C,EAA+C,CAA/C,EAAkDA,KAAlD,EAAyD,CAAzD,EAA4D,CAA5D;AACA,aAAKsD,eAAL,CAAqByI,aAArB,CAAmClJ,OAAnC,EAA4CsI,MAA5C,EAAoD1K,SAApD;AACH;AACJ;;AACDlG,IAAAA,oBAAoB,CAAGoR,GAAG,KAAK5N,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAAtB,IAAgCgC,MAAM,CAACsI,QAAP,IACxDtI,MAAM,CAACsI,QAAP,CAAgBlO,MAAhB,GAAyB,CADN,CAAJ,GACgBwT,GADhB,GACsBR,MADxB,EACiCjM,KADjC,CAApB;AAEA2D,IAAAA,OAAO,CAACoD,OAAR,GAAkBwF,YAAY,CAACrB,CAA/B;AACAvH,IAAAA,OAAO,CAACqD,OAAR,GAAkBuF,YAAY,CAACpB,CAA/B;AACA,SAAK5H,sBAAL,GAA8B,IAA9B;AACA,WAAOiJ,gBAAP;AACH,GA/ED;;AAgFAhP,EAAAA,aAAa,CAAChF,SAAd,CAAwB8T,uBAAxB,GAAkD,UAAU3I,OAAV,EAAmBwJ,MAAnB,EAA2B;AACzE,QAAIxJ,OAAO,CAACwD,QAAR,IAAoB,CAACgG,MAAzB,EAAiC;AAC7BxJ,MAAAA,OAAO,CAACwD,QAAR,CAAiB,CAAjB,EAAoBiG,SAApB,GAAgC3S,SAAS,CAAC4S,IAA1C;AACH;;AACD1J,IAAAA,OAAO,CAACkG,OAAR,CAAgB,IAAIrP,IAAJ,EAAhB;AACAmJ,IAAAA,OAAO,CAACmG,OAAR,CAAgBnG,OAAO,CAACoG,WAAxB;;AACA,QAAIpG,OAAO,CAACwD,QAAZ,EAAsB;AAClBxD,MAAAA,OAAO,CAACwD,QAAR,CAAiB,CAAjB,EAAoBiG,SAApB,GAAgC3S,SAAS,CAAC6S,MAA1C;AACH;AACJ,GATD;;AAUA9P,EAAAA,aAAa,CAAChF,SAAd,CAAwB+U,gBAAxB,GAA2C,UAAU1O,MAAV,EAAkBoB,KAAlB,EAAyBE,MAAzB,EAAiC;AACxE,QAAIzC,OAAO,GAAGmB,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2BA,QAA3B,CAAoC,CAApC,CAAd;AACA,QAAImD,WAAW,GAAGzL,MAAM,CAACmB,KAAP,CAAasK,WAA/B;AACA5M,IAAAA,OAAO,CAACuC,KAAR,GAAgB,CAACA,KAAK,IAAIvC,OAAO,CAACuC,KAAlB,KAA4BqK,WAAW,GAAG,CAA1C,CAAhB;AACA5M,IAAAA,OAAO,CAACyC,MAAR,GAAiB,CAACA,MAAM,IAAIzC,OAAO,CAACyC,MAAnB,KAA8BmK,WAAW,GAAG,CAA5C,CAAjB;AACAzL,IAAAA,MAAM,CAACmM,OAAP,CAAenB,OAAf,CAAuB,IAAIrP,IAAJ,EAAvB;AACAqE,IAAAA,MAAM,CAACmM,OAAP,CAAelB,OAAf,CAAuBjL,MAAM,CAACmM,OAAP,CAAejB,WAAtC;AACH,GAPD;;AAQAvM,EAAAA,aAAa,CAAChF,SAAd,CAAwBgQ,kBAAxB,GAA6C,UAAU3J,MAAV,EAAkBkN,SAAlB,EAA6ByB,OAA7B,EAAsC;AAC/E,QAAInE,UAAU,GAAG,KAAKzL,WAAL,CAAiBiB,MAAM,CAACJ,EAAxB,EAA4B,KAAKX,IAAjC,CAAjB;AACA,QAAI2P,IAAI,GAAG,KAAKC,aAAL,CAAmB7O,MAAnB,EAA2BwK,UAA3B,CAAX;AACA,QAAIpJ,KAAK,GAAGwN,IAAI,CAACxN,KAAL,GAAa,CAAzB;AACA,QAAIE,MAAM,GAAGsN,IAAI,CAACtN,MAAL,GAAc,CAA3B;AACA,QAAI6I,SAAS,GAAG9N,iBAAiB,CAAC,KAAD,EAAQ;AACrCuD,MAAAA,EAAE,EAAEI,MAAM,CAACJ,EAAP,GAAY,YADqB;AAErCuB,MAAAA,KAAK,EAAE,WAAWC,KAAX,GAAmB,YAAnB,GAAkCE,MAAlC,GAA2C,+BAFb;AAGrCgB,MAAAA,KAAK,EAAEkI,UAAU,CAACiC,OAAX,GAAqBjC,UAAU,CAACiC,OAAhC,GAA0CzM,MAAM,CAACJ;AAHnB,KAAR,CAAjC;AAKAsN,IAAAA,SAAS,CAAChI,WAAV,CAAsBiF,SAAtB;AACA,QAAIiD,MAAJ;AACA,QAAIW,QAAJ;AACA,QAAIH,GAAJ;;AACA,QAAI5N,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,QAA1B,EAAoC;AAChCoP,MAAAA,MAAM,GAAGhR,gBAAgB,CAAC,KAAD,EAAQ;AAC7BwD,QAAAA,EAAE,EAAEI,MAAM,CAACJ,EADkB;AAE7BwB,QAAAA,KAAK,EAAE2K,IAAI,CAAC+B,IAAL,CAAU9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAApC,IAA6C,CAFvB;AAG7BE,QAAAA,MAAM,EAAEyK,IAAI,CAAC+B,IAAL,CAAU9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAApC,IAA8C;AAHzB,OAAR,CAAzB;AAKAyM,MAAAA,QAAQ,GAAG3R,gBAAgB,CAAC,GAAD,EAAM;AAAEwD,QAAAA,EAAE,EAAEI,MAAM,CAACJ,EAAP,GAAY;AAAlB,OAAN,CAA3B;AACAwN,MAAAA,MAAM,CAAClI,WAAP,CAAmB6I,QAAnB;AACA5D,MAAAA,SAAS,CAACjF,WAAV,CAAsBkI,MAAtB;AACA,WAAKsB,gBAAL,CAAsB1O,MAAtB;AACA,WAAKwF,WAAL,CAAiBwI,aAAjB,CAA+BhO,MAAM,CAACmM,OAAtC,EAA+C4B,QAA/C,EAAyDrL,SAAzD,EAAoEA,SAApE,EAA+E0K,MAA/E;AACH,KAXD,MAYK,IAAIpN,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAA1B,EAAkC;AACnC4P,MAAAA,GAAG,GAAG,KAAKK,aAAL,CAAmBjO,MAAnB,EAA2BoN,MAA3B,EAAmCjD,SAAnC,EAA8CnK,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAAxE,EAAgFtB,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAA1G,EAAiH,KAAjH,CAAN;AACH,KAFI,MAGA;AACD,UAAIpB,MAAM,CAACsI,QAAP,IACAtI,MAAM,CAACsI,QAAP,CAAgBlO,MAAhB,GAAyB,CADzB,IAC8BuC,YAAY,CAACqD,MAAD,EAAS,MAAT,EAAiB,KAAKhB,UAAtB,CAD9C,EACiF;AAC7E4O,QAAAA,GAAG,GAAG,KAAKM,cAAL,CAAoBlO,MAApB,EAA4BoN,MAA5B,EAAoCjD,SAApC,EAA+CnK,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAAzE,EAAiFtB,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAA3G,EAAkH,KAAlH,CAAN;AACH,OAHD,MAIK;AACDgM,QAAAA,MAAM,GAAGjQ,cAAc,CAACgR,YAAf,CAA4BnO,MAAM,CAACJ,EAAnC,EAAuCmM,IAAI,CAAC+B,IAAL,CAAU,CAAC9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAA1B,GAAkCpB,MAAM,CAACmB,KAAP,CAAasK,WAAhD,IAA+D,CAAzE,IAA8E,CAArH,EAAwHM,IAAI,CAAC+B,IAAL,CAAU,CAAC9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAA1B,GAAmCtB,MAAM,CAACmB,KAAP,CAAasK,WAAjD,IAAgE,CAA1E,IAA+E,CAAvM,CAAT;AACAtB,QAAAA,SAAS,CAACjF,WAAV,CAAsBkI,MAAtB;AACA,YAAInL,KAAK,GAAG,CAAZ;;AACA,YAAIjC,MAAM,YAAYvE,SAAtB,EAAiC;AAC7BwG,UAAAA,KAAK,GAAG,GAAR;AACH;;AACDmL,QAAAA,MAAM,CAACgB,UAAP,CAAkB,IAAlB,EAAwBC,YAAxB,CAAqCpM,KAArC,EAA4C,CAA5C,EAA+C,CAA/C,EAAkDA,KAAlD,EAAyD,CAAzD,EAA4D,CAA5D;AACA,aAAKsD,eAAL,CAAqByI,aAArB,CAAmChO,MAAM,CAACmM,OAA1C,EAAmD4B,QAAQ,IAAIX,MAA/D,EAAuE1K,SAAvE,EAAkFA,SAAlF,EAA6FA,SAA7F,EAAwGA,SAAxG,EAAmH,IAAnH,EAAyHA,SAAzH,EAAoI,IAApI;AACH;AACJ;;AACD,QAAI,CAACiM,OAAL,EAAc;AACV,UAAIvD,WAAW,GAAGpL,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAA1B,GAAkCpB,MAAM,CAACmB,KAAP,CAAasK,WAAjE;AACA,UAAIJ,YAAY,GAAGrL,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAA1B,GAAmCtB,MAAM,CAACmB,KAAP,CAAasK,WAAnE;AACA,UAAItK,KAAK,GAAG,2DAAZ;;AACA,UAAInB,MAAM,CAACjC,KAAP,CAAawK,OAAjB,EAA0B;AACtB,YAAIvI,MAAM,CAACjC,KAAP,CAAayJ,WAAb,KAA6B,YAAjC,EAA+C;AAC3CrG,UAAAA,KAAK,IAAI,iBACL4K,IAAI,CAAC+C,GAAL,CAAS,KAAKxD,YAAL,CAAkBC,IAA3B,EAAkC,CAACnK,KAAK,GAAGgK,WAAT,IAAwB,CAA1D,CADK,GAEH,gBAFG,GAEgBwD,IAAI,CAACtN,MAAL,GAAc,CAF9B,GAGH,KAHN;AAIH,SALD,MAMK;AACDH,UAAAA,KAAK,IAAI,iBACLyN,IAAI,CAACxN,KAAL,GAAa,CADR,GAEH,gBAFG,GAEgB2K,IAAI,CAAC+C,GAAL,CAAS,KAAKxD,YAAL,CAAkBI,GAA3B,EAAiC,CAACpK,MAAM,GAAG+J,YAAV,IAA0B,CAA3D,CAFhB,GAGH,KAHN;AAIH;AACJ,OAbD,MAcK;AACDlK,QAAAA,KAAK,IAAI,iBACL4K,IAAI,CAAC+C,GAAL,CAAS,KAAKxD,YAAL,CAAkBC,IAA3B,EAAkC,CAACnK,KAAK,GAAGgK,WAAT,IAAwB,CAA1D,CADK,GAEH,gBAFG,GAEgBW,IAAI,CAAC+C,GAAL,CAAS,KAAKxD,YAAL,CAAkBI,GAA3B,EAAiC,CAACpK,MAAM,GAAG+J,YAAV,IAA0B,CAA3D,CAFhB,GAGH,KAHN;AAIH;;AACD,UAAI+B,MAAM,YAAY2B,iBAAtB,EAAyC;AACrC5N,QAAAA,KAAK,IAAI,yBAAT;AACH;;AACD3E,MAAAA,oBAAoB,CAAGoR,GAAG,KAAK5N,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAAtB,IAAgCgC,MAAM,CAACsI,QAAP,IAC3DtI,MAAM,CAACsI,QAAP,CAAgBlO,MAAhB,GAAyB,CADH,CAAJ,GACawT,GADb,GACmBR,MADrB,EAC8BjM,KAD9B,CAApB;AAEAgJ,MAAAA,SAAS,CAACvE,SAAV,CAAoBoJ,GAApB,CAAwB,oBAAxB;AACA,aAAO7E,SAAP;AACH;;AACD,WAAOiD,MAAP;AACH,GA9ED;;AA+EAzO,EAAAA,aAAa,CAAChF,SAAd,CAAwBuU,cAAxB,GAAyC,UAAU1J,IAAV,EAAgB4I,MAAhB,EAAwBjD,SAAxB,EAAmC7I,MAAnC,EAA2CF,KAA3C,EAAkD6N,SAAlD,EAA6D;AAClG,QAAIrB,GAAG,GAAGvR,iBAAiB,CAAC,KAAD,EAAQ;AAAE,YAAMmI,IAAI,CAAC5E,EAAL,IAAWqP,SAAS,GAAG,mBAAH,GAAyB,WAA7C;AAAR,KAAR,CAA3B;AACA,QAAIC,SAAS,GAAG7S,iBAAiB,CAAC,KAAD,EAAQ;AACrC,YAAMmI,IAAI,CAAC5E,EAAL,IAAWqP,SAAS,GAAG,oBAAH,GAA0B,YAA9C,CAD+B;AAErC,eAAS,WAAWlD,IAAI,CAAC+B,IAAL,CAAU1M,KAAK,GAAG,CAAlB,CAAX,GAAkC,KAAlC,GACL,SADK,GACO2K,IAAI,CAAC+B,IAAL,CAAUxM,MAAM,GAAG,CAAnB,CADP,GAC+B,sBAHH;AAIrC,eAAS;AAJ4B,KAAR,CAAjC;AAMA,QAAI6N,YAAY,GAAG9S,iBAAiB,CAAC,KAAD,EAAQ;AACxC,YAAMmI,IAAI,CAAC5E,EAAL,IAAWqP,SAAS,GAAG,wBAAH,GAA8B,gBAAlD,CADkC;AAExC,eAAS,WAAWlD,IAAI,CAAC+B,IAAL,CAAU1M,KAAK,GAAG,CAAlB,CAAX,GAAkC,KAAlC,GACL,SADK,GACO2K,IAAI,CAAC+B,IAAL,CAAUxM,MAAM,GAAG,CAAnB,CADP,GAC+B;AAHA,KAAR,CAApC;AAKA4N,IAAAA,SAAS,CAAChK,WAAV,CAAsBiK,YAAtB;AACAvB,IAAAA,GAAG,CAAC1I,WAAJ,CAAgBgK,SAAhB;AACA9B,IAAAA,MAAM,GAAGjQ,cAAc,CAACgR,YAAf,CAA6Bc,SAAS,GAAIzK,IAAI,CAAC5E,EAAL,GAAU,UAAd,GAA4B4E,IAAI,CAAC5E,EAAvE,EAA4EmM,IAAI,CAAC+B,IAAL,CAAU1M,KAAV,IAAmB,CAA/F,EAAkG2K,IAAI,CAAC+B,IAAL,CAAUxM,MAAV,IAAoB,CAAtH,CAAT;AACAsM,IAAAA,GAAG,CAAC1I,WAAJ,CAAgBkI,MAAhB;AACAjD,IAAAA,SAAS,CAACjF,WAAV,CAAsB0I,GAAtB;AACA,SAAKrI,eAAL,CAAqByI,aAArB,CAAmCxJ,IAAI,CAAC2H,OAAL,CAAa7D,QAAb,CAAsB,CAAtB,EAAyBA,QAAzB,CAAkC,CAAlC,CAAnC,EAAyE8E,MAAzE,EAAiF8B,SAAjF;AACA,WAAOtB,GAAP;AACH,GApBD;;AAqBAjP,EAAAA,aAAa,CAAChF,SAAd,CAAwBsU,aAAxB,GAAwC,UAAUjO,MAAV,EAAkBoN,MAAlB,EAA0BjD,SAA1B,EAAqC7I,MAArC,EAA6CF,KAA7C,EAAoD6N,SAApD,EAA+D;AACnG,QAAIrB,GAAG,GAAGvR,iBAAiB,CAAC,KAAD,EAAQ;AAC/B,YAAM2D,MAAM,CAACJ,EAAP,IAAaqP,SAAS,GAAG,mBAAH,GAAyB,WAA/C;AADyB,KAAR,CAA3B;AAGA,QAAIC,SAAS,GAAG7S,iBAAiB,CAAC,KAAD,EAAQ;AACrC,YAAM2D,MAAM,CAACJ,EAAP,IAAaqP,SAAS,GAAG,oBAAH,GAA0B,YAAhD,CAD+B;AAErC,eAAS,WAAWlD,IAAI,CAAC+B,IAAL,CAAU1M,KAAK,GAAG,CAAlB,CAAX,GAAkC,KAAlC,GACL,SADK,GACO2K,IAAI,CAAC+B,IAAL,CAAUxM,MAAM,GAAG,CAAnB,CADP,GAC+B,sBAHH;AAIrC,eAAS;AAJ4B,KAAR,CAAjC;AAMA,QAAI6N,YAAY,GAAG9S,iBAAiB,CAAC,KAAD,EAAQ;AACxC,YAAM2D,MAAM,CAACJ,EAAP,IAAaqP,SAAS,GAAG,wBAAH,GAA8B,gBAApD,CADkC;AAExC,eAAS,WAAWlD,IAAI,CAAC+B,IAAL,CAAU1M,KAAK,GAAG,CAAlB,CAAX,GAAkC,KAAlC,GACL,SADK,GACO2K,IAAI,CAAC+B,IAAL,CAAUxM,MAAM,GAAG,CAAnB,CADP,GAC+B;AAHA,KAAR,CAApC;AAKA4N,IAAAA,SAAS,CAAChK,WAAV,CAAsBiK,YAAtB;AACAvB,IAAAA,GAAG,CAAC1I,WAAJ,CAAgBgK,SAAhB;AACA9B,IAAAA,MAAM,GAAGjQ,cAAc,CAACgR,YAAf,CAA4BnO,MAAM,CAACJ,EAAnC,EAAuCmM,IAAI,CAAC+B,IAAL,CAAU,CAAC9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAA1B,GAAkCpB,MAAM,CAACmB,KAAP,CAAasK,WAAhD,IAA+D,CAAzE,IAA8E,CAArH,EAAwHM,IAAI,CAAC+B,IAAL,CAAU,CAAC9N,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAA1B,GAAmCtB,MAAM,CAACmB,KAAP,CAAasK,WAAjD,IAAgE,CAA1E,IAA+E,CAAvM,CAAT;AACAtB,IAAAA,SAAS,CAACjF,WAAV,CAAsBkI,MAAtB;AACAA,IAAAA,MAAM,CAACgB,UAAP,CAAkB,IAAlB,EAAwBC,YAAxB,CAAqC,CAArC,EAAwC,CAAxC,EAA2C,CAA3C,EAA8C,CAA9C,EAAiD,CAAjD,EAAoD,CAApD;AACAT,IAAAA,GAAG,CAAC1I,WAAJ,CAAgBkI,MAAhB;AACAjD,IAAAA,SAAS,CAACjF,WAAV,CAAsB0I,GAAtB;AACA,SAAKrI,eAAL,CAAqByI,aAArB,CAAmChO,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2BA,QAA3B,CAAoC,CAApC,CAAnC,EAA2E8E,MAA3E,EAAmF8B,SAAnF;AACA,WAAOtB,GAAP;AACH,GAxBD,CAj+BiD,CA0/BjD;;;AACAjP,EAAAA,aAAa,CAAChF,SAAd,CAAwBkV,aAAxB,GAAwC,UAAU7O,MAAV,EAAkBwK,UAAlB,EAA8B;AAClE,QAAIpJ,KAAK,GAAGpB,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B/J,KAAtC;AACA,QAAIE,MAAM,GAAGtB,MAAM,CAACmM,OAAP,CAAehB,UAAf,CAA0B7J,MAAvC;;AACA,QAAI,CAAC,KAAKqG,WAAN,IAAqB,CAAC,KAAKD,YAA/B,EAA6C;AACzCtG,MAAAA,KAAK,IAAI,KAAKkK,YAAL,CAAkBC,IAAlB,GAAyB,KAAKD,YAAL,CAAkBE,KAA3C,GAAmDxL,MAAM,CAACmB,KAAP,CAAasK,WAAzE;AACAnK,MAAAA,MAAM,IAAI,KAAKgK,YAAL,CAAkBI,GAAlB,GAAwB,KAAKJ,YAAL,CAAkBK,MAA1C,GAAmD3L,MAAM,CAACmB,KAAP,CAAasK,WAA1E;AACH,KAHD,MAIK;AACDrK,MAAAA,KAAK,GAAG,KAAKuG,WAAb;AACArG,MAAAA,MAAM,GAAGyK,IAAI,CAAC+C,GAAL,CAAS,KAAKpH,YAAd,EAA4BpG,MAA5B,CAAT;AACH;;AACD,WAAO,IAAI3F,IAAJ,CAASyF,KAAT,EAAgBE,MAAhB,CAAP;AACH,GAZD,CA3/BiD,CAwgCjD;AACA;;;AACA3C,EAAAA,aAAa,CAAChF,SAAd,CAAwByV,gBAAxB,GAA2C,UAAU1P,CAAV,EAAa;AACpD,QAAIyI,OAAJ;AACA,QAAID,OAAJ;AACA,QAAImH,QAAJ;;AACA,QAAI3P,CAAC,CAAC1B,IAAF,CAAOuG,OAAP,CAAe,OAAf,MAA4B,CAAC,CAAjC,EAAoC;AAChC8K,MAAAA,QAAQ,GAAG3P,CAAX;AACA,UAAI4P,KAAK,GAAGD,QAAQ,CAACE,cAAT,CAAwB,CAAxB,EAA2BC,OAAvC;AACA,UAAIC,KAAK,GAAGJ,QAAQ,CAACE,cAAT,CAAwB,CAAxB,EAA2BG,OAAvC;AACAvH,MAAAA,OAAO,GAAGmH,KAAK,GAAG,KAAKzQ,OAAL,CAAa8Q,SAA/B;AACAzH,MAAAA,OAAO,GAAGuH,KAAK,GAAG,KAAK5Q,OAAL,CAAa+Q,UAA/B;AACH,KAND,MAOK;AACDzH,MAAAA,OAAO,GAAGzI,CAAC,CAAC8P,OAAF,GAAY,KAAK3Q,OAAL,CAAa8Q,SAAnC;AACAzH,MAAAA,OAAO,GAAGxI,CAAC,CAACgQ,OAAF,GAAY,KAAK7Q,OAAL,CAAa+Q,UAAnC;AACH;;AACD,WAAO;AAAEvD,MAAAA,CAAC,EAAEnE,OAAL;AAAcoE,MAAAA,CAAC,EAAEnE;AAAjB,KAAP;AACH,GAhBD,CA1gCiD,CA2hCjD;;;AACAxJ,EAAAA,aAAa,CAAChF,SAAd,CAAwBkW,SAAxB,GAAoC,UAAUnQ,CAAV,EAAaoQ,OAAb,EAAsB;AACtD,QAAI,KAAKC,iBAAL,KAA2B,CAAC,KAAKlQ,cAAN,IACxB,KAAKA,cAAL,CAAoBD,EAApB,GAAyB,YAAzB,KAA0C,KAAKmQ,iBAAL,CAAuBnQ,EADpE,CAAJ,EAC6E;AACzE,WAAKmQ,iBAAL,CAAuBnK,SAAvB,CAAiCtK,MAAjC,CAAwC,gBAAxC;AACA,WAAKyU,iBAAL,CAAuB5O,KAAvB,CAA6B6O,eAA7B,GAA+C,EAA/C;AACA,WAAKD,iBAAL,GAAyB,IAAzB;AACH;;AACD,QAAInQ,EAAE,GAAGF,CAAC,CAAC3F,MAAF,CAAS6F,EAAT,CAAYG,KAAZ,CAAkB,YAAlB,EAAgC,CAAhC,CAAT;;AACA,QAAI,KAAKhB,WAAL,CAAiBa,EAAjB,CAAJ,EAA0B;AACtB,UAAIuK,SAAS,GAAGxI,QAAQ,CAACC,cAAT,CAAwBhC,EAAE,GAAG,YAA7B,CAAhB;AACAuK,MAAAA,SAAS,CAACvE,SAAV,CAAoBoJ,GAApB,CAAwB,gBAAxB;AACA,WAAKe,iBAAL,GAAyB5F,SAAzB;AACH;;AACDzK,IAAAA,CAAC,CAACuQ,cAAF;AACH,GAdD,CA5hCiD,CA2iCjD;;;AACAtR,EAAAA,aAAa,CAAChF,SAAd,CAAwBuW,OAAxB,GAAkC,UAAU/C,GAAV,EAAe;AAC7C,SAAK7N,QAAL,GAAgB,IAAhB;;AACA,QAAI6N,GAAG,IAAIA,GAAG,CAACpT,MAAf,EAAuB;AACnB,UAAIoT,GAAG,CAACgD,UAAJ,CAAevQ,EAAf,KAAsB,YAA1B,EAAwC;AACpC,YAAIf,OAAO,GAAG8C,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAd;;AACA,YAAI/C,OAAO,CAAC+G,SAAR,CAAkBwK,QAAlB,CAA2B,oBAA3B,CAAJ,EAAsD;AAClDvR,UAAAA,OAAO,CAACwR,SAAR,GAAoB,qCAApB;AACA1O,UAAAA,QAAQ,CAACC,cAAT,CAAwB,WAAxB,EAAqC0O,KAArC,GAA6C,EAA7C;;AACA,cAAIrV,QAAQ,EAAZ,EAAgB;AACZ0G,YAAAA,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,iBAA1C,EAA6DgG,SAA7D,CAAuEoJ,GAAvE,CAA2E,+BAA3E;AACH;;AACD,eAAKuB,aAAL,CAAmB,EAAnB;AACH;AACJ,OAVD,MAWK;AACD,YAAI3Q,EAAE,GAAGuN,GAAG,CAACpT,MAAJ,CAAW6F,EAAX,CAAcG,KAAd,CAAoB,YAApB,EAAkC,CAAlC,CAAT;;AACA,YAAIH,EAAE,IAAI,KAAKC,cAAf,EAA+B;AAC3B,cAAIyE,IAAI,GAAG;AAAEkM,YAAAA,QAAQ,EAAE,KAAKtR,SAAjB;AAA4BuR,YAAAA,QAAQ,EAAE7Q;AAAtC,WAAX;AACA,cAAI8Q,OAAO,GAAG,wBAAd;AACA,eAAKzL,OAAL,CAAayL,OAAb,EAAsBpM,IAAtB;AACA,eAAKpF,SAAL,GAAiBU,EAAjB;AACAuN,UAAAA,GAAG,CAAC8C,cAAJ;AACH,SAND,MAOK,IAAI,KAAK/Q,SAAL,KAAmB,EAAvB,EAA2B;AAC5B,eAAKA,SAAL,GAAiB,EAAjB;AACH;AACJ;AACJ;AACJ,GA5BD;;AA6BAP,EAAAA,aAAa,CAAChF,SAAd,CAAwBgX,KAAxB,GAAgC,UAAUxD,GAAV,EAAe;AAC3C,QAAIrO,KAAK,GAAG,IAAZ;;AACA,QAAI,KAAK0C,YAAT,EAAuB;AACnB;AACA,UAAIoP,SAAS,GAAG,IAAhB;AACA,UAAI/R,OAAO,GAAG8C,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAd;AACA/C,MAAAA,OAAO,CAACwR,SAAR,GAAoB,+CAApB;;AACA,UAAIpV,QAAQ,MAAMkS,GAAG,CAACpT,MAAJ,YAAsB8W,gBAAxC,EAA0D;AACtD,YAAI1D,GAAG,CAACpT,MAAJ,CAAWuW,KAAX,KAAqB,EAAzB,EAA6B;AACzB3O,UAAAA,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,iBAA1C,EAA6DgG,SAA7D,CAAuEoJ,GAAvE,CAA2E,+BAA3E;AACH,SAFD,MAGK;AACDrN,UAAAA,QAAQ,CAACC,cAAT,CAAwB,KAAK/C,OAAL,CAAae,EAAb,GAAkB,iBAA1C,EAA6DgG,SAA7D,CAAuEtK,MAAvE,CAA8E,+BAA9E;AACH;AACJ;;AACD,UAAI6R,GAAG,KAAKA,GAAG,CAACnT,GAAJ,KAAY,OAAZ,IAAuBmT,GAAG,CAAC2D,OAAJ,KAAgB,EAA5C,CAAP,EAAwD;AACpD,YAAI3D,GAAG,CAACpT,MAAJ,YAAsB8W,gBAA1B,EAA4C;AACxC,eAAKN,aAAL,CAAmBpD,GAAG,CAACpT,MAAJ,CAAWuW,KAA9B;AACH;AACJ,OAJD,MAKK;AACD,YAAI,KAAKS,KAAT,EAAgB;AACZC,UAAAA,YAAY,CAAC,KAAKD,KAAN,CAAZ;AACH;;AACD,aAAKA,KAAL,GAAaE,UAAU,CAAC,YAAY;AAChC,cAAI9D,GAAG,CAACpT,MAAJ,YAAsB8W,gBAA1B,EAA4C;AACxCD,YAAAA,SAAS,CAACL,aAAV,CAAwBpD,GAAG,CAACpT,MAAJ,CAAWuW,KAAnC;AACAxR,YAAAA,KAAK,CAACiS,KAAN,GAAc,IAAd;AACH;AACJ,SALsB,EAKpB,GALoB,CAAvB;AAMH;AACJ;AACJ,GAhCD;;AAiCApS,EAAAA,aAAa,CAAChF,SAAd,CAAwBuX,SAAxB,GAAoC,UAAU/D,GAAV,EAAe;AAC/C,QAAIvN,EAAE,GAAGuN,GAAG,CAACpT,MAAJ,CAAW6F,EAAX,CAAcG,KAAd,CAAoB,YAApB,EAAkC,CAAlC,CAAT;;AACA,QAAI,KAAKF,cAAT,EAAyB;AACrB,UAAIsR,SAAS,GAAGxP,QAAQ,CAACC,cAAT,CAAwB,KAAK/B,cAAL,CAAoBD,EAApB,GAAyB,YAAjD,CAAhB;;AACA,UAAIA,EAAE,KAAK,KAAKC,cAAL,CAAoBD,EAA3B,IAAiCuR,SAArC,EAAgD;AAC5CA,QAAAA,SAAS,CAACvL,SAAV,CAAoBtK,MAApB,CAA2B,mBAA3B;AACH;;AACD,UAAI6O,SAAS,GAAGxI,QAAQ,CAACC,cAAT,CAAwB,KAAK/B,cAAL,CAAoBD,EAApB,GAAyB,YAAjD,CAAhB;;AACA,UAAIuK,SAAJ,EAAe;AACXA,QAAAA,SAAS,CAAChJ,KAAV,CAAgB6O,eAAhB,GAAkC,EAAlC;AACH;;AACD,WAAKnQ,cAAL,GAAsB,IAAtB;AACH;;AACD,QAAI,KAAKd,WAAL,CAAiBa,EAAjB,CAAJ,EAA0B;AACtB,UAAIuK,SAAS,GAAGxI,QAAQ,CAACC,cAAT,CAAwBhC,EAAE,GAAG,YAA7B,CAAhB;AACAuK,MAAAA,SAAS,CAACvE,SAAV,CAAoBoJ,GAApB,CAAwB,mBAAxB;AACA,WAAKnP,cAAL,GAAsB,KAAKd,WAAL,CAAiBa,EAAjB,CAAtB;AACAuN,MAAAA,GAAG,CAAC8C,cAAJ;AACH;AACJ,GAnBD;;AAoBAtR,EAAAA,aAAa,CAAChF,SAAd,CAAwByX,OAAxB,GAAkC,UAAUjE,GAAV,EAAe;AAC7C;AACA,QAAIvJ,OAAO,GAAG,IAAd;AACA,QAAIyN,aAAa,GAAG,eAApB;AACA,QAAIC,UAAU,GAAG,YAAjB;;AACA,QAAInE,GAAG,IAAKA,GAAG,CAACnT,GAAJ,KAAY,QAAxB,EAAmC;AAC/B,UAAI6E,OAAO,GAAG+E,OAAO,CAACR,SAAR,CAAkBiO,aAAlB,CAAd;;AACA,UAAIxS,OAAO,IAAIA,OAAO,CAACgD,UAAvB,EAAmC;AAC/BhD,QAAAA,OAAO,CAACgD,UAAR,CAAmBC,WAAnB,CAA+BjD,OAA/B;AACA+E,QAAAA,OAAO,CAACR,SAAR,CAAkBkO,UAAlB;AACH;AACJ;AACJ,GAZD,CA9nCiD,CA2oCjD;AACA;;;AACA3S,EAAAA,aAAa,CAAChF,SAAd,CAAwB0J,aAAxB,GAAwC,YAAY;AAChD,QAAI,KAAKF,SAAT,EAAoB;AAChB;AACA,WAAKC,SAAL,GAAiB,IAAIhI,SAAJ,CAAc,KAAKyD,OAAnB,EAA4B;AACzC0S,QAAAA,UAAU,EAAE,qBAD6B;AAEzC9R,QAAAA,MAAM,EAAE,KAAKA,MAF4B;AAGzC+R,QAAAA,SAAS,EAAE,KAAKA,SAHyB;AAIzCvB,QAAAA,cAAc,EAAE,KAJyB;AAKzCwB,QAAAA,QAAQ,EAAE,KAAKA,QAL0B;AAMzCC,QAAAA,IAAI,EAAE,UAAUpN,IAAV,EAAgB;AAClB,cAAIvK,MAAM,GAAG,QAAb;AACA,cAAIoE,MAAM,GAAGhC,YAAY,CAACmI,IAAI,CAACvK,MAAD,CAAL,EAAe,aAAf,CAAzB;;AACA,cAAIoE,MAAM,IAAIA,MAAM,CAACyH,SAAP,CAAiBwK,QAAjB,CAA0B,WAA1B,CAAd,EAAsD;AAClD,gBAAIuB,WAAW,GAAG,eAAlB;AACAxT,YAAAA,MAAM,CAACwT,WAAD,CAAN,CAAoB,CAApB,EAAuBC,SAAvB,CAAiCC,IAAjC,CAAsCvN,IAAtC;AACH;AACJ,SAbwC;AAczCwN,QAAAA,QAAQ,EAAE;AAAEvG,UAAAA,IAAI,EAAE,KAAKgC,aAAL,CAAmBwE,MAAnB,CAA0B1F,CAAlC;AAAqCX,UAAAA,GAAG,EAAE,KAAK6B,aAAL,CAAmBwE,MAAnB,CAA0BzF;AAApE;AAd+B,OAA5B,CAAjB;AAgBH;AACJ,GApBD,CA7oCiD,CAkqCjD;;;AACA3N,EAAAA,aAAa,CAAChF,SAAd,CAAwB6X,SAAxB,GAAoC,UAAU9R,CAAV,EAAa;AAC7C,QAAIb,OAAO,GAAG,KAAKY,MAAL,CAAY,CAAZ,CAAd;;AACA,QAAIZ,OAAJ,EAAa;AACTA,MAAAA,OAAO,CAACsB,YAAR,CAAqB,WAArB,EAAkC,KAAKtB,OAAL,CAAae,EAA/C;AACH;;AACD,QAAI3E,QAAQ,EAAZ,EAAgB;AACZyE,MAAAA,CAAC,CAACsS,UAAF,CAAatS,CAAC,CAACuS,WAAf;AACH;AACJ,GARD;;AASAtT,EAAAA,aAAa,CAAChF,SAAd,CAAwB8X,QAAxB,GAAmC,UAAU/R,CAAV,EAAa;AAC5C,QAAI,CAACvD,YAAY,CAACuD,CAAC,CAAC3F,MAAH,EAAW,WAAX,CAAjB,EAA0C;AACtCuB,MAAAA,MAAM,CAACoE,CAAC,CAACD,MAAH,CAAN;AACH;AACJ,GAJD,CA5qCiD,CAirCjD;AACA;;;AACAd,EAAAA,aAAa,CAAChF,SAAd,CAAwBsS,WAAxB,GAAsC,UAAUjM,MAAV,EAAkBkK,eAAlB,EAAmCH,EAAnC,EAAuCC,EAAvC,EAA2C5I,KAA3C,EAAkDE,MAAlD,EAA0DqN,OAA1D,EAAmE;AACrG,QAAI3O,MAAM,YAAYvE,SAAtB,EAAiC;AAC7B,UAAI0Q,OAAO,GAAGnM,MAAM,CAACmM,OAArB;AACAnM,MAAAA,MAAM,CAACmM,OAAP,GAAiBjC,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,CAAjB;AACA,UAAI4J,KAAK,GAAGlS,MAAM,CAACmS,KAAP,CAAapI,EAAb,EAAiBC,EAAjB,EAAqB5I,KAArB,EAA4BE,MAA5B,EAAoC4I,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,CAApC,CAAZ;AACA,UAAI8J,IAAI,GAAGhR,KAAK,GAAG,CAAR,GAAY8I,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAA5B,CAAqC,CAArC,EAAwCJ,OAApD,GAA8DgK,KAAK,CAAC7F,CAAN,GAAU,CAAnF;AACA,UAAIgG,IAAI,GAAG/Q,MAAM,GAAG,CAAT,GAAa4I,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAA5B,CAAqC,CAArC,EAAwCH,OAArD,GAA+D+J,KAAK,CAAC5F,CAAN,GAAU,CAApF;;AACA,WAAK,IAAIvL,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGkJ,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAAlD,EAA4DvH,EAAE,GAAGC,EAAE,CAAC5G,MAApE,EAA4E2G,EAAE,EAA9E,EAAkF;AAC9E,YAAIX,KAAK,GAAGY,EAAE,CAACD,EAAD,CAAd;AACAX,QAAAA,KAAK,CAAC8H,OAAN,IAAiBkK,IAAjB;AACAhS,QAAAA,KAAK,CAAC+H,OAAN,IAAiBkK,IAAjB;AACAjS,QAAAA,KAAK,CAACkS,UAAN,GAAmB,KAAnB;AACH;;AACDtS,MAAAA,MAAM,CAACmM,OAAP,GAAiBA,OAAjB;AACH,KAbD,MAcK,IAAInM,MAAM,CAACjC,KAAP,CAAaC,IAAb,KAAsB,MAAtB,IAAgC,KAAKuU,UAAzC,EAAqD;AACtD,UAAIpG,OAAO,GAAGnM,MAAM,CAACmM,OAArB;AACAnM,MAAAA,MAAM,CAACmM,OAAP,GAAiBjC,eAAjB;AACAA,MAAAA,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BlH,KAA5B,GAAoCA,KAApC;AACA8I,MAAAA,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BhH,MAA5B,GAAqCA,MAArC;AACA,WAAKiR,UAAL,CAAgBC,UAAhB,CAA2B;AAAEpR,QAAAA,KAAK,EAAEA,KAAT;AAAgBE,QAAAA,MAAM,EAAEA;AAAxB,OAA3B,EAA6DtB,MAA7D,EAAqEA,MAArE,EAA6E,IAA7E;AACAA,MAAAA,MAAM,CAACmM,OAAP,GAAiBA,OAAjB;AACH,KAPI,MAQA;AACD,UAAInM,MAAM,CAACsI,QAAX,EAAqB;AACjB,YAAIzG,UAAU,GAAG7B,MAAM,CAACsI,QAAxB;AACA,YAAImK,CAAC,GAAG,CAAR;AACA,YAAIC,CAAC,GAAG,CAAR;;AACA,YAAI,CAAC/D,OAAL,EAAc;AACV,cAAItO,IAAI,GAAG,KAAK,CAAhB;AACA,cAAI8J,SAAS,GAAG,KAAK,CAArB;;AACA,eAAK,IAAI1P,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoH,UAAU,CAACzH,MAA/B,EAAuCK,CAAC,EAAxC,EAA4C;AACxC0P,YAAAA,SAAS,GAAGD,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAA5B,CAAqC7N,CAArC,CAAZ;;AACA,gBAAI0P,SAAJ,EAAe;AACX,kBAAIA,SAAS,CAAC7B,QAAV,CAAmB,CAAnB,EAAsBA,QAA1B,EAAoC;AAChC,qBAAKqK,YAAL,CAAkBxI,SAAlB;AACH;;AACD9J,cAAAA,IAAI,GAAG,KAAKtB,WAAL,CAAiBoL,SAAS,CAACvK,EAA3B,CAAP;AACAuK,cAAAA,SAAS,CAAC/I,KAAV,GAAkBf,IAAI,CAACe,KAAvB;AACA+I,cAAAA,SAAS,CAAC7I,MAAV,GAAmBjB,IAAI,CAACiB,MAAxB;AACA6I,cAAAA,SAAS,CAACa,OAAV,CAAkB,IAAIrP,IAAJ,EAAlB;AACAwO,cAAAA,SAAS,CAACc,OAAV,CAAkBd,SAAS,CAAC7B,QAAV,CAAmB,CAAnB,EAAsB4C,WAAxC;AACH;AACJ;AACJ;;AACDuH,QAAAA,CAAC,GAAGrR,KAAK,GAAG8I,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4B4C,WAA5B,CAAwC9J,KAApD;AACAsR,QAAAA,CAAC,GAAGpR,MAAM,GAAG4I,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4B4C,WAA5B,CAAwC5J,MAArD;AACA4I,QAAAA,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4B0C,OAA5B,CAAoC,IAAIrP,IAAJ,EAApC;AACAuO,QAAAA,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4B2C,OAA5B,CAAoCf,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4B4C,WAAhE;;AACA,YAAI,CAACyD,OAAL,EAAc;AACV,cAAIrG,QAAQ,GAAG,KAAK,CAApB;;AACA,eAAK,IAAI7N,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoH,UAAU,CAACzH,MAA/B,EAAuCK,CAAC,EAAxC,EAA4C;AACxC6N,YAAAA,QAAQ,GAAG4B,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAA5B,CAAqC7N,CAArC,CAAX;;AACA,gBAAI6N,QAAJ,EAAc;AACV,kBAAIA,QAAQ,CAACA,QAAT,CAAkB,CAAlB,EAAqBA,QAAzB,EAAmC;AAC/B,qBAAKsK,aAAL,CAAmBtK,QAAnB,EAA6BmK,CAA7B,EAAgCC,CAAhC,EAAmC1S,MAAnC;AACH;;AACD,mBAAK6S,UAAL,CAAgBvK,QAAhB,EAA0BmK,CAA1B,EAA6BC,CAA7B,EAAgC1S,MAAhC;AACH;AACJ;AACJ;;AACD,YAAI2O,OAAJ,EAAa;AACT;AACA,cAAImE,UAAU,GAAG,KAAK,CAAtB;AACA,cAAIC,WAAW,GAAG,KAAK,CAAvB;AACA,cAAIzK,QAAQ,GAAG,KAAK,CAApB;;AACA,eAAK,IAAI7N,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoH,UAAU,CAACzH,MAA/B,EAAuCK,CAAC,EAAxC,EAA4C;AACxC;AACAqY,YAAAA,UAAU,GAAG1R,KAAK,GAAGpB,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B4C,WAA3B,CAAuC9J,KAA5D;AACA2R,YAAAA,WAAW,GAAGzR,MAAM,GAAGtB,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B4C,WAA3B,CAAuC5J,MAA9D;AACAgH,YAAAA,QAAQ,GAAG4B,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,EAA4BA,QAA5B,CAAqC7N,CAArC,CAAX;;AACA,gBAAI6N,QAAJ,EAAc;AACV,kBAAIA,QAAQ,CAACA,QAAT,CAAkB,CAAlB,EAAqBA,QAAzB,EAAmC;AAC/B,qBAAKsK,aAAL,CAAmBtK,QAAnB,EAA6BwK,UAA7B,EAAyCC,WAAzC,EAAsD/S,MAAtD,EAA8D,IAA9D;AACH;;AACD,mBAAK6S,UAAL,CAAgBvK,QAAhB,EAA0BwK,UAA1B,EAAsCC,WAAtC,EAAmD/S,MAAnD,EAA2D,IAA3D;AACH;AACJ;;AACDA,UAAAA,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B0C,OAA3B,CAAmC,IAAIrP,IAAJ,EAAnC;AACAqE,UAAAA,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B2C,OAA3B,CAAmCjL,MAAM,CAACmM,OAAP,CAAe7D,QAAf,CAAwB,CAAxB,EAA2B4C,WAA9D;AACH;AACJ,OAzDD,MA0DK;AACDzO,QAAAA,YAAY,CAACyN,eAAe,CAAC5B,QAAhB,CAAyB,CAAzB,CAAD,EAA8ByB,EAA9B,EAAkCC,EAAlC,EAAsCE,eAAtC,CAAZ;AACH;AACJ;AACJ,GAtFD;;AAuFAvL,EAAAA,aAAa,CAAChF,SAAd,CAAwBiZ,aAAxB,GAAwC,UAAUzI,SAAV,EAAqBsI,CAArB,EAAwBC,CAAxB,EAA2B1S,MAA3B,EAAmC2O,OAAnC,EAA4C;AAChF,QAAIvO,KAAJ;;AACA,SAAK,IAAI3F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0P,SAAS,CAAC7B,QAAV,CAAmBlO,MAAvC,EAA+CK,CAAC,EAAhD,EAAoD;AAChD2F,MAAAA,KAAK,GAAG+J,SAAS,CAAC7B,QAAV,CAAmB7N,CAAnB,CAAR;;AACA,UAAI,CAAC2F,KAAK,CAACkI,QAAN,CAAe,CAAf,EAAkBA,QAAvB,EAAiC;AAC7B,aAAKuK,UAAL,CAAgBzS,KAAhB,EAAuBqS,CAAvB,EAA0BC,CAA1B,EAA6B1S,MAA7B,EAAqC2O,OAArC;AACH,OAFD,MAGK;AACD,aAAKiE,aAAL,CAAmBxS,KAAnB,EAA0BqS,CAA1B,EAA6BC,CAA7B,EAAgC1S,MAAhC,EAAwC2O,OAAxC;AACH;AACJ;AACJ,GAXD;;AAYAhQ,EAAAA,aAAa,CAAChF,SAAd,CAAwBgZ,YAAxB,GAAuC,UAAUxI,SAAV,EAAqB;AACxD,QAAI6I,cAAJ;AACA,QAAI3S,IAAJ;;AACA,SAAK,IAAI5F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0P,SAAS,CAAC7B,QAAV,CAAmBlO,MAAvC,EAA+CK,CAAC,EAAhD,EAAoD;AAChDuY,MAAAA,cAAc,GAAG7I,SAAS,CAAC7B,QAAV,CAAmB7N,CAAnB,CAAjB;;AACA,UAAI,CAACuY,cAAc,CAAC1K,QAAf,CAAwB,CAAxB,EAA2BA,QAAhC,EAA0C;AACtCjI,QAAAA,IAAI,GAAG,KAAKtB,WAAL,CAAiBiU,cAAc,CAACpT,EAAhC,CAAP;AACAoT,QAAAA,cAAc,CAAC5R,KAAf,GAAuBf,IAAI,CAACe,KAA5B;AACA4R,QAAAA,cAAc,CAAC1R,MAAf,GAAwBjB,IAAI,CAACiB,MAA7B;AACA0R,QAAAA,cAAc,CAAChI,OAAf,CAAuB,IAAIrP,IAAJ,EAAvB;AACAqX,QAAAA,cAAc,CAAC/H,OAAf,CAAuB+H,cAAc,CAAC1K,QAAf,CAAwB,CAAxB,EAA2B4C,WAAlD;AACH,OAND,MAOK;AACD,aAAKyH,YAAL,CAAkBK,cAAlB;AACH;AACJ;AACJ,GAhBD;;AAiBArU,EAAAA,aAAa,CAAChF,SAAd,CAAwBkZ,UAAxB,GAAqC,UAAUzS,KAAV,EAAiBqS,CAAjB,EAAoBC,CAApB,EAAuB1S,MAAvB,EAA+B2O,OAA/B,EAAwC;AACzEvO,IAAAA,KAAK,CAACgB,KAAN,GAAchB,KAAK,CAACgB,KAAN,GAAcqR,CAA5B;AACArS,IAAAA,KAAK,CAACkB,MAAN,GAAgBlB,KAAK,CAACkB,MAAN,GAAeoR,CAA/B;AACAtS,IAAAA,KAAK,CAAC8H,OAAN,GAAgByG,OAAO,GAAIvO,KAAK,CAAC8H,OAAN,GAAgBuK,CAAjB,GAAsBzS,MAAM,CAACmB,KAAP,CAAasK,WAAtC,GAAqDrL,KAAK,CAAC8H,OAAN,GAAgBuK,CAAjB,GAAsBzS,MAAM,CAACmB,KAAP,CAAasK,WAAb,GAA2B,CAA5H;AACArL,IAAAA,KAAK,CAAC+H,OAAN,GAAgBwG,OAAO,GAAIvO,KAAK,CAAC+H,OAAN,GAAgBuK,CAAjB,GAAsB1S,MAAM,CAACmB,KAAP,CAAasK,WAAtC,GAAqDrL,KAAK,CAAC+H,OAAN,GAAgBuK,CAAjB,GAAsB1S,MAAM,CAACmB,KAAP,CAAasK,WAAb,GAA2B,CAA5H;AACArL,IAAAA,KAAK,CAAC4K,OAAN,CAAc,IAAIrP,IAAJ,EAAd;AACAyE,IAAAA,KAAK,CAAC6K,OAAN,CAAc7K,KAAK,CAACkI,QAAN,CAAe,CAAf,EAAkB4C,WAAhC;AACH,GAPD;;AAQAvM,EAAAA,aAAa,CAAChF,SAAd,CAAwB2J,eAAxB,GAA0C,YAAY;AAClD,QAAI,CAACrI,QAAQ,EAAb,EAAiB;AACb,WAAKkH,gBAAL,CAAsBC,KAAtB,GAA8B,EAA9B;AACH;;AACD7F,IAAAA,qBAAqB,CAAC,kBAAD,EAAqB,KAAKsC,OAAL,CAAae,EAAlC,CAArB;AACA,SAAK6F,cAAL;;AACA,QAAI,CAACxK,QAAQ,EAAb,EAAiB;AACb,WAAKkH,gBAAL,CAAsB8Q,QAAtB;AACH;AACJ,GATD;;AAUAtU,EAAAA,aAAa,CAAChF,SAAd,CAAwB8L,cAAxB,GAAyC,YAAY;AACjD,SAAK,IAAIhL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6F,QAAL,CAAclG,MAAlC,EAA0CK,CAAC,EAA3C,EAA+C;AAC3C,UAAIyY,QAAQ,GAAG,KAAK5S,QAAL,CAAc7F,CAAd,CAAf;AACA,WAAKiM,WAAL,CAAiBwM,QAAjB;AACA,WAAKvM,aAAL,CAAmBuM,QAAnB;AACH;AACJ,GAND;;AAOAvU,EAAAA,aAAa,CAAChF,SAAd,CAAwB8H,aAAxB,GAAwC,YAAY;AAChD,QAAI0R,SAAS,GAAG9W,iBAAiB,CAAC,KAAD,EAAQ;AAAEuD,MAAAA,EAAE,EAAE,KAAKf,OAAL,CAAae,EAAb,GAAkB;AAAxB,KAAR,CAAjC;AACApD,IAAAA,oBAAoB,CAAC2W,SAAD,EAAY,mCAAZ,CAApB,CAFgD,CAGhD;;AACAA,IAAAA,SAAS,CAAC9C,SAAV,GAAsB,eAAtB;AACA,SAAKxR,OAAL,CAAaqG,WAAb,CAAyBiO,SAAzB;AACA,QAAIC,OAAO,GAAG/W,iBAAiB,CAAC,OAAD,EAAU,EAAV,CAA/B;AACA+W,IAAAA,OAAO,CAACC,WAAR,GAAsB,eAAtB;AACAD,IAAAA,OAAO,CAACxT,EAAR,GAAa,WAAb;AACApD,IAAAA,oBAAoB,CAAC4W,OAAD,EAAU,wBAAV,CAApB,CATgD,CAUhD;;AACAA,IAAAA,OAAO,CAAC/C,SAAR,GAAoB,SAApB;AACA8C,IAAAA,SAAS,CAACjO,WAAV,CAAsBkO,OAAtB;AACA,QAAIE,IAAI,GAAGjX,iBAAiB,CAAC,MAAD,EAAS;AAAEuD,MAAAA,EAAE,EAAE,YAAN;AAAoByQ,MAAAA,SAAS,EAAE;AAA/B,KAAT,CAA5B;AACA8C,IAAAA,SAAS,CAACjO,WAAV,CAAsBoO,IAAtB;AACH,GAfD;;AAgBA3U,EAAAA,aAAa,CAAChF,SAAd,CAAwB4Z,eAAxB,GAA0C,UAAUvT,MAAV,EAAkB;AACxD,QAAIoC,KAAK,GAAG,EAAZ;;AACA,SAAK,IAAI3H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuF,MAAM,CAAC5F,MAA3B,EAAmCK,CAAC,EAApC,EAAwC;AACpC,WAAK,IAAI8F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKiT,qBAAL,CAA2BpZ,MAA/C,EAAuDmG,CAAC,EAAxD,EAA4D;AACxD,YAAI,KAAKiT,qBAAL,CAA2BjT,CAA3B,MAAkCP,MAAM,CAACvF,CAAD,CAAN,CAAUmF,EAAhD,EAAoD;AAChDwC,UAAAA,KAAK,CAAC4D,IAAN,CAAWhG,MAAM,CAAC,CAAD,CAAjB;AACH;AACJ;AACJ;;AACD,WAAOoC,KAAP;AACH,GAVD;;AAWAzD,EAAAA,aAAa,CAAChF,SAAd,CAAwB4W,aAAxB,GAAwC,UAAUD,KAAV,EAAiB;AACrD,QAAIrJ,WAAW,GAAG,EAAlB;AACA,QAAIpI,OAAO,GAAG8C,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAd;AACA,QAAIa,UAAJ,CAHqD,CAIrD;;AACA,QAAI5D,OAAJ,EAAa;AACT,WAAK,IAAI4U,CAAC,GAAG5U,OAAO,CAACyJ,QAAR,CAAiBlO,MAAjB,GAA0B,CAAvC,EAA0CqZ,CAAC,IAAI,CAA/C,EAAkDA,CAAC,EAAnD,EAAuD;AACnD5U,QAAAA,OAAO,CAACiD,WAAR,CAAoBjD,OAAO,CAACyJ,QAAR,CAAiBmL,CAAjB,CAApB;AACH;AACJ,KAToD,CAUrD;;;AACA,SAAK,IAAIhZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6F,QAAL,CAAclG,MAAlC,EAA0CK,CAAC,EAA3C,EAA+C;AAC3C,UAAI4O,kBAAkB,GAAG,KAAK/I,QAAL,CAAc7F,CAAd,CAAzB;;AACA,WAAK,IAAI8F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8I,kBAAkB,CAAC7I,OAAnB,CAA2BpG,MAA/C,EAAuDmG,CAAC,EAAxD,EAA4D;AACxD,YAAIiE,IAAI,GAAG6E,kBAAkB,CAAC7I,OAAnB,CAA2BD,CAA3B,CAAX;;AACA,YAAI+P,KAAK,KAAK,EAAV,IAAgB9L,IAAI,CAAC5E,EAAL,CAAQ8T,WAAR,GAAsBnP,OAAtB,CAA8B+L,KAAK,CAACoD,WAAN,EAA9B,MAAuD,CAAC,CAA5E,EAA+E;AAC3EzM,UAAAA,WAAW,CAACjB,IAAZ,CAAiBxB,IAAjB;AACH;AACJ;AACJ;;AACD,QAAImP,aAAa,GAAG7W,WAAW,CAAC,KAAK6W,aAAN,CAA/B;;AACA,QAAIA,aAAJ,EAAmB;AACf1M,MAAAA,WAAW,GAAG0M,aAAa,CAAC1M,WAAD,CAAb,IAA8B,EAA5C;AACH;;AACD,QAAI,KAAKuM,qBAAL,IAA8B,KAAKA,qBAAL,CAA2BpZ,MAA3B,GAAoC,CAAtE,EAAyE;AACrE6M,MAAAA,WAAW,GAAG,KAAKsM,eAAL,CAAqBtM,WAArB,CAAd;AACH,KA1BoD,CA2BrD;;;AACA,QAAI,CAACpI,OAAD,IAAY,CAAC5D,QAAQ,EAAzB,EAA6B;AACzBwH,MAAAA,UAAU,GAAG,KAAKmR,mBAAL,CAAyBnR,UAAzB,CAAb;AACA5D,MAAAA,OAAO,GAAG4D,UAAV;AACH,KA/BoD,CAgCrD;;;AACA,QAAIwE,WAAW,CAAC7M,MAAZ,GAAqB,CAAzB,EAA4B;AACxB,WAAK,IAAI2G,EAAE,GAAG,CAAT,EAAY8S,aAAa,GAAG5M,WAAjC,EAA8ClG,EAAE,GAAG8S,aAAa,CAACzZ,MAAjE,EAAyE2G,EAAE,EAA3E,EAA+E;AAC3E,YAAIf,MAAM,GAAG6T,aAAa,CAAC9S,EAAD,CAA1B;;AACA,YAAIf,MAAM,CAAC2I,QAAP,KAAoB,EAAxB,EAA4B;AACxB,eAAKgB,kBAAL,CAAwB3J,MAAxB,EAAgCnB,OAAhC;AACH;AACJ;AACJ,KAPD,MAQK,IAAIyR,KAAK,KAAK,EAAd,EAAkB;AACnB,UAAIwD,QAAQ,GAAGzX,iBAAiB,CAAC,KAAD,EAAQ;AAAE,cAAM,UAAR;AAAoB,iBAAS;AAA7B,OAAR,CAAhC;AACAyX,MAAAA,QAAQ,CAACC,SAAT,GAAqB,qBAArB;AACAlV,MAAAA,OAAO,CAACqG,WAAR,CAAoB4O,QAApB;AACH,KAJI,MAKA;AACD,UAAIE,SAAS,GAAGrS,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAhB;AACAoS,MAAAA,SAAS,CAAC3D,SAAV,GAAsB,qCAAtB;;AACA,UAAI,CAACpV,QAAQ,EAAb,EAAiB;AACb,aAAKkH,gBAAL,CAAsB8R,UAAtB,CAAiC,CAAjC;AACA,YAAI1D,aAAa,GAAG5O,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAApB;;AACA,YAAI2O,aAAJ,EAAmB;AACfA,UAAAA,aAAa,CAACjV,MAAd;AACH;AACJ;AACJ;AACJ,GAzDD;;AA0DAqD,EAAAA,aAAa,CAAChF,SAAd,CAAwBia,mBAAxB,GAA8C,UAAUnR,UAAV,EAAsB;AAChEA,IAAAA,UAAU,GAAGpG,iBAAiB,CAAC,KAAD,EAAQ;AAAE,YAAM,eAAR;AAAyB,eAAS;AAAlC,KAAR,CAA9B;AACA,SAAKwC,OAAL,CAAaqG,WAAb,CAAyBzC,UAAzB;AACA,QAAIyR,iBAAiB,GAAG;AACpB7R,MAAAA,MAAM,EAAE,gBADY;AACME,MAAAA,QAAQ,EAAE,IADhB;AAEpBuC,MAAAA,OAAO,EAAE;AAFW,KAAxB;AAIA,SAAK3C,gBAAL,CAAsBgS,OAAtB,CAA8BD,iBAA9B,EAAiD,CAAjD;AACA,WAAOzR,UAAP;AACH,GATD;;AAUA9D,EAAAA,aAAa,CAAChF,SAAd,CAAwB0L,UAAxB,GAAqC,YAAY;AAC7C,QAAI+O,UAAU,GAAGlZ,OAAO,CAACmZ,eAAzB;AACA,QAAIC,SAAS,GAAGpZ,OAAO,CAACqZ,aAAxB;AACA,QAAIC,SAAS,GAAGtZ,OAAO,CAACuZ,cAAxB,CAH6C,CAI7C;;AACA,QAAIC,QAAQ,GAAG,OAAf;AACA,QAAIC,YAAY,GAAG,SAAnB;AACAxZ,IAAAA,YAAY,CAAC6T,GAAb,CAAiB,KAAKnQ,OAAtB,EAA+BuV,UAA/B,EAA2C,KAAKlD,SAAhD,EAA2D,IAA3D;AACA/V,IAAAA,YAAY,CAAC6T,GAAb,CAAiB,KAAKnQ,OAAtB,EAA+B2V,SAA/B,EAA0C,KAAK3E,SAA/C,EAA0D,IAA1D;AACA1U,IAAAA,YAAY,CAAC6T,GAAb,CAAiB,KAAKnQ,OAAtB,EAA+ByV,SAA/B,EAA0C,KAAKpE,OAA/C,EAAwD,IAAxD;AACA/U,IAAAA,YAAY,CAAC6T,GAAb,CAAiB,KAAKnQ,OAAtB,EAA+B6V,QAA/B,EAAyC,KAAK/D,KAA9C,EAAqD,IAArD;AACAxV,IAAAA,YAAY,CAAC6T,GAAb,CAAiBrN,QAAjB,EAA2BgT,YAA3B,EAAyC,KAAKvD,OAA9C,EAAuD,IAAvD,EAX6C,CAY7C;;AACA,SAAK/N,aAAL;AACH,GAdD;;AAeA1E,EAAAA,aAAa,CAAChF,SAAd,CAAwByL,YAAxB,GAAuC,YAAY;AAC/C,QAAIgP,UAAU,GAAGlZ,OAAO,CAACmZ,eAAzB;AACA,QAAIC,SAAS,GAAGpZ,OAAO,CAACqZ,aAAxB;AACA,QAAIC,SAAS,GAAGtZ,OAAO,CAACuZ,cAAxB,CAH+C,CAI/C;;AACA,QAAIC,QAAQ,GAAG,OAAf;AACA,QAAIC,YAAY,GAAG,SAAnB;AACAxZ,IAAAA,YAAY,CAACG,MAAb,CAAoB,KAAKuD,OAAzB,EAAkCuV,UAAlC,EAA8C,KAAKlD,SAAnD;AACA/V,IAAAA,YAAY,CAACG,MAAb,CAAoB,KAAKuD,OAAzB,EAAkC2V,SAAlC,EAA6C,KAAK3E,SAAlD;AACA1U,IAAAA,YAAY,CAACG,MAAb,CAAoB,KAAKuD,OAAzB,EAAkCyV,SAAlC,EAA6C,KAAKpE,OAAlD;AACA/U,IAAAA,YAAY,CAACG,MAAb,CAAoB,KAAKuD,OAAzB,EAAkC6V,QAAlC,EAA4C,KAAK/D,KAAjD;AACAxV,IAAAA,YAAY,CAACG,MAAb,CAAoBqG,QAApB,EAA8BgT,YAA9B,EAA4C,KAAKvD,OAAjD;AACH,GAZD;;AAaAvX,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,GAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,WAFlB,EAE+B,KAAK,CAFpC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,MAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,OAFlB,EAE2B,KAAK,CAFhC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,MAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,QAFlB,EAE4B,KAAK,CAFjC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPwB,UAAU,CAAC,EAAD,EAAK4C,OAAL,CADH,CAAD,EAEPU,aAAa,CAAChF,SAFP,EAEkB,UAFlB,EAE8B,KAAK,CAFnC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,eAFlB,EAEmC,KAAK,CAFxC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC;AAAEkR,IAAAA,GAAG,EAAE;AAAP,GAAD,CADD,CAAD,EAEPnN,aAAa,CAAChF,SAFP,EAEkB,YAFlB,EAEgC,KAAK,CAFrC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,eAFlB,EAEmC,KAAK,CAFxC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,uBAFlB,EAE2C,KAAK,CAFhD,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,mBAFlB,EAEuC,KAAK,CAF5C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,aAFlB,EAEiC,KAAK,CAFtC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,cAFlB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPgB,OAAO,CAAC;AAAE0Q,IAAAA,IAAI,EAAE,EAAR;AAAYC,IAAAA,KAAK,EAAE,EAAnB;AAAuBE,IAAAA,GAAG,EAAE,EAA5B;AAAgCC,IAAAA,MAAM,EAAE;AAAxC,GAAD,EAA+C5P,MAA/C,CADA,CAAD,EAEP4C,aAAa,CAAChF,SAFP,EAEkB,cAFlB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,IAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,WAFlB,EAE+B,KAAK,CAFpC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPgB,OAAO,CAAC,EAAD,EAAK6D,aAAL,CADA,CAAD,EAEPC,aAAa,CAAChF,SAFP,EAEkB,eAFlB,EAEmC,KAAK,CAFxC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPgB,OAAO,CAAC,EAAD,EAAK2D,cAAL,CADA,CAAD,EAEPG,aAAa,CAAChF,SAFP,EAEkB,gBAFlB,EAEoC,KAAK,CAFzC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,KAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,cAFlB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,IAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,iBAFlB,EAEqC,KAAK,CAF1C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,CAAC,UAAD,CADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,YAFlB,EAEgC,KAAK,CAFrC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPmB,KAAK,EADE,CAAD,EAEP2D,aAAa,CAAChF,SAFP,EAEkB,wBAFlB,EAE4C,KAAK,CAFjD,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPmB,KAAK,EADE,CAAD,EAEP2D,aAAa,CAAChF,SAFP,EAEkB,kBAFlB,EAEsC,KAAK,CAF3C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,iBAFlB,EAEqC,KAAK,CAF1C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,cAFlB,EAEkC,KAAK,CAFvC,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,sBAFlB,EAE0C,KAAK,CAF/C,CAAV;;AAGAE,EAAAA,UAAU,CAAC,CACPe,QAAQ,EADD,CAAD,EAEP+D,aAAa,CAAChF,SAFP,EAEkB,mBAFlB,EAEuC,KAAK,CAF5C,CAAV;;AAGA,SAAOgF,aAAP;AACH,CApgDkC,CAogDjChE,SApgDiC,CAAnC;;AAqgDA,SAASgE,aAAT","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/ban-types */\nimport { Component, Property, Complex, CollectionFactory, ChildProperty, Event } from '@syncfusion/ej2-base';\nimport { isBlazor } from '@syncfusion/ej2-base';\nimport { Browser, EventHandler, Draggable, Collection } from '@syncfusion/ej2-base';\nimport { remove } from '@syncfusion/ej2-base';\nimport { Accordion } from '@syncfusion/ej2-navigations';\nimport { Node, Connector, Shape, Size } from '../diagram/index';\nimport { Transform } from '../diagram/index';\nimport { DiagramRenderer, StackPanel, Margin } from '../diagram/index';\nimport { TextElement, Canvas } from '../diagram/index';\nimport { SvgRenderer } from '../diagram/rendering/svg-renderer';\nimport { parentsUntil, createSvgElement, createHtmlElement, createMeasureElements } from '../diagram/utility/dom-util';\nimport { removeElementsByClass, applyStyleAgainstCsp } from '../diagram/utility/dom-util';\nimport { scaleElement, arrangeChild, groupHasType, setUMLActivityDefaults, updateDefaultValues } from '../diagram/utility/diagram-util';\nimport { getFunction, randomId, cloneObject } from '../diagram/utility/base-util';\nimport { getOuterBounds } from '../diagram/utility/connector';\nimport { Point } from '../diagram/primitives/point';\nimport { CanvasRenderer } from '../diagram/rendering/canvas-renderer';\n// eslint-disable-next-line\nvar getObjectType = function (obj) {\n    var conn = obj;\n    if (conn.sourcePoint || conn.targetPoint || conn.sourceID || conn.targetID\n        || conn.sourcePortID || conn.targetPortID || conn.sourceDecorator || conn.targetDecorator) {\n        return Connector;\n    }\n    if (obj.shape && (obj.shape instanceof Shape || obj.shape.type)) {\n        return Node;\n    }\n    return Node;\n};\n/**\n * A palette allows to display a group of related symbols and it textually annotates the group with its header.\n */\nvar Palette = /** @class */ (function (_super) {\n    __extends(Palette, _super);\n    // eslint-disable-next-line\n    function Palette(parent, propName, defaultValue, isArray) {\n        return _super.call(this, parent, propName, defaultValue, isArray) || this;\n    }\n    __decorate([\n        Property('')\n    ], Palette.prototype, \"id\", void 0);\n    __decorate([\n        Property()\n    ], Palette.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Palette.prototype, \"expanded\", void 0);\n    __decorate([\n        Property('')\n    ], Palette.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('')\n    ], Palette.prototype, \"title\", void 0);\n    __decorate([\n        CollectionFactory(getObjectType)\n    ], Palette.prototype, \"symbols\", void 0);\n    return Palette;\n}(ChildProperty));\nexport { Palette };\n/**\n * customize the drag size of the individual palette items.\n */\nvar SymbolDragSize = /** @class */ (function (_super) {\n    __extends(SymbolDragSize, _super);\n    function SymbolDragSize() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], SymbolDragSize.prototype, \"width\", void 0);\n    __decorate([\n        Property()\n    ], SymbolDragSize.prototype, \"height\", void 0);\n    return SymbolDragSize;\n}(ChildProperty));\nexport { SymbolDragSize };\n/**\n * customize the preview size and position of the individual palette items.\n */\nvar SymbolPreview = /** @class */ (function (_super) {\n    __extends(SymbolPreview, _super);\n    function SymbolPreview() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], SymbolPreview.prototype, \"width\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPreview.prototype, \"height\", void 0);\n    __decorate([\n        Complex({}, Point)\n    ], SymbolPreview.prototype, \"offset\", void 0);\n    return SymbolPreview;\n}(ChildProperty));\nexport { SymbolPreview };\n/**\n * Represents the Symbol Palette Component.\n * ```html\n * <div id=\"symbolpalette\"></div>\n * <script>\n *  var palette = new SymbolPalatte({ allowDrag:true });\n *  palette.appendTo(\"#symbolpalette\");\n * </script>\n * ```\n */\n/**\n * The symbol palette control allows to predefine the frequently used nodes and connectors\n * and to drag and drop those nodes/connectors to drawing area\n */\nvar SymbolPalette = /** @class */ (function (_super) {\n    __extends(SymbolPalette, _super);\n    //region - protected methods\n    /**\n     *  Constructor for creating the symbol palette Component\n     *\n     * @param {SymbolPaletteModel} options The symbol palette model.\n     * @param {string | HTMLElement} element The symbol palette element.\n     */\n    function SymbolPalette(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        /**   @private  */\n        _this.symbolTable = {};\n        /**   @private  */\n        _this.childTable = {};\n        _this.info = 'info';\n        _this.oldObject = null;\n        _this.laneTable = {};\n        _this.isExpand = false;\n        _this.isExpandMode = false;\n        _this.isMethod = false;\n        _this.paletteid = 88123;\n        _this.checkOnRender = false;\n        // eslint-disable\n        _this.helper = function (e) {\n            var clonedElement;\n            var id = (_this.selectedSymbol && _this.selectedSymbol.id) || e.sender.target.id.split('_container')[0];\n            var symbol = _this.symbolTable[id];\n            if (symbol && _this.selectedSymbol) {\n                _this.selectedSymbols = _this.selectedSymbol.id === symbol.id ? symbol : _this.selectedSymbol;\n                //const position: PointModel = this.getMousePosition(e.sender);\n                clonedElement = _this.getSymbolPreview(_this.selectedSymbols, e.sender, _this.element);\n                clonedElement.setAttribute('paletteId', _this.element.id);\n            }\n            return clonedElement;\n        };\n        var child;\n        var node;\n        for (var i = 0; _this && _this.palettes && i < _this.palettes.length; i++) {\n            for (var j = 0; j < _this.palettes[i].symbols.length; j++) {\n                child = _this.palettes[i].symbols[j];\n                node = options.palettes[i].symbols[j];\n                if (child && child.shape.type === 'UmlActivity') {\n                    setUMLActivityDefaults(node, child);\n                }\n                if (_this.nodeDefaults || _this.connectorDefaults) {\n                    updateDefaultValues(child, node, child instanceof Node ? _this.nodeDefaults : _this.connectorDefaults);\n                }\n            }\n        }\n        return _this;\n    }\n    /**\n     * Refreshes the panel when the symbol palette properties are updated\\\n     *\n     * @returns {  void}    Refreshes the panel when the symbol palette properties are updated .\\\n     * @param {SymbolPaletteModel} newProp - Defines the new values of the changed properties.\n     * @param {SymbolPaletteModel} oldProp - Defines the old values of the changed properties.\n     */\n    // eslint-disable-next-line\n    SymbolPalette.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var refresh = false;\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'width':\n                    this.element.style.width = this.width.toString();\n                    break;\n                case 'height':\n                    this.element.style.height = this.height.toString();\n                    break;\n                case 'symbolPreview':\n                    break;\n                case 'symbolWidth':\n                case 'symbolHeight':\n                case 'getSymbolInfo':\n                    if (this.isReact) {\n                        refresh = false;\n                    }\n                    else {\n                        refresh = true;\n                    }\n                    break;\n                case 'enableSearch':\n                    if (newProp.enableSearch && !isBlazor()) {\n                        this.createTextbox();\n                    }\n                    else {\n                        var divElement = document.getElementById(this.element.id + '_search');\n                        if (divElement) {\n                            divElement.parentNode.removeChild(divElement);\n                        }\n                    }\n                    break;\n                case 'palettes':\n                    for (var _b = 0, _c = Object.keys(newProp.palettes); _b < _c.length; _b++) {\n                        var i = _c[_b];\n                        var index = Number(i);\n                        if (!isBlazor() && !this.accordionElement.items[index]) {\n                            this.accordionElement.items[index] = {\n                                header: newProp.palettes[index].title || '',\n                                expanded: newProp.palettes[index].expanded,\n                                iconCss: newProp.palettes[index].iconCss || ''\n                            };\n                        }\n                        if (newProp.palettes[index].height) {\n                            var paletteDiv = document.getElementById(this.palettes[index].id + '_content');\n                            paletteDiv.style.height = newProp.palettes[index].height + 'px';\n                        }\n                        if (newProp.palettes[index].iconCss !== undefined) {\n                            if (!isBlazor()) {\n                                this.accordionElement.items[index].iconCss = newProp.palettes[index].iconCss || '';\n                                refresh = true;\n                            }\n                        }\n                        if (newProp.palettes[index].expanded !== undefined && !isBlazor()) {\n                            if (!this.palettes[index].isInteraction) {\n                                this.accordionElement.items[index].expanded = newProp.palettes[index].expanded;\n                                this.isExpand = true;\n                            }\n                            else {\n                                this.palettes[index].isInteraction = false;\n                            }\n                            if (!this.isExpandMode && !this.isMethod && !this.isExpand) {\n                                this.isExpand = true;\n                            }\n                        }\n                        if (isBlazor() && newProp.palettes[index].symbols !== null) {\n                            refresh = true;\n                        }\n                        if (isBlazor() && newProp.palettes[index].symbols === null) {\n                            this.updateBlazorProperties(newProp);\n                        }\n                    }\n                    break;\n                case 'enableAnimation':\n                    if (!isBlazor()) {\n                        if (!this.enableAnimation) {\n                            this.accordionElement.animation = { expand: { duration: 0 }, collapse: { duration: 0 } };\n                        }\n                        else {\n                            this.accordionElement.animation = { expand: { duration: 400 }, collapse: { duration: 400 } };\n                        }\n                    }\n                    break;\n                case 'expandMode':\n                    if (!isBlazor()) {\n                        this.accordionElement.expandMode = this.expandMode;\n                        refresh = true;\n                        this.isExpandMode = true;\n                    }\n                    break;\n                case 'allowDrag':\n                    this.allowDrag = newProp.allowDrag;\n                    if (!this.allowDrag) {\n                        this.draggable.helper = function () {\n                            return null;\n                        };\n                    }\n                    else {\n                        this.initDraggable();\n                        this.draggable.helper = this.helper;\n                    }\n                    break;\n            }\n        }\n        if (refresh) {\n            this.refreshPalettes();\n        }\n        if (this.isExpand && !refresh) {\n            this.refresh();\n            this.isExpand = false;\n            for (var p = 0; p < this.palettes.length; p++) {\n                var paletteElement = this.palettes[p].id;\n                if (window[paletteElement]) {\n                    if (window[paletteElement].length > 1) {\n                        window[paletteElement][1].parentNode.removeChild(window[paletteElement][1]);\n                        window[paletteElement][1] = null;\n                    }\n                }\n            }\n        }\n        this.isMethod = false;\n    };\n    /**\n     * updateBlazorProperties method\\\n     *\n     * @returns {void}    updateBlazorProperties method .\\\n     * @param {SymbolPaletteModel} newProp - provide the scale value.\n     *\n     * @private\n     */\n    SymbolPalette.prototype.updateBlazorProperties = function (newProp) {\n        var blazorInterop = 'sfBlazor';\n        var blazor = 'Blazor';\n        if (window && window[blazor]) {\n            var palObj = { palette: newProp.palettes };\n            var obj = { 'methodName': 'UpdateBlazorProperties', 'paletteobj': palObj };\n            window[blazorInterop].updateBlazorProperties(obj, this);\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string}  Get the properties to be maintained in the persisted state.\n     */\n    SymbolPalette.prototype.getPersistData = function () {\n        var keyEntity = ['loaded'];\n        return this.addOnPersist(keyEntity);\n    };\n    /**\n     * Initializes the values of private members.\n     *\n     * @returns {void}  Initializes the values of private members.\n     * @private\n     */\n    SymbolPalette.prototype.preRender = function () {\n        var _this = this;\n        if (this.element.id === '') {\n            var collection = document.getElementsByClassName('e-symbolpalette').length;\n            this.element.id = 'symbolpalette_' + this.paletteid + '_' + collection;\n        }\n        this.element.style.overflow = 'auto';\n        this.element.style.height = this.height.toString();\n        this.element.style.width = this.width.toString();\n        if (this.enableSearch && !isBlazor()) {\n            this.createTextbox();\n        }\n        //create accordion element\n        if (!isBlazor()) {\n            var accordionDiv = createHtmlElement('div', { id: this.element.id + '_container' });\n            this.accordionElement = new Accordion({\n                expandMode: this.expandMode\n            });\n            if (!this.enableAnimation) {\n                this.accordionElement.animation = { expand: { duration: 0 }, collapse: { duration: 0 } };\n            }\n            this.accordionElement.created = function () {\n                _this.checkOnRender = true;\n            };\n            this.accordionElement.expanded = function (args) {\n                var index = _this.accordionElement.items.indexOf(args.item);\n                var isAllowDatabind = _this.allowServerDataBinding;\n                _this.allowServerDataBinding = false;\n                _this.palettes[index].expanded = args.isExpanded;\n                _this.palettes[index].isInteraction = true;\n                _this.allowServerDataBinding = isAllowDatabind;\n            };\n            this.accordionElement.expanding = function (args) {\n                if (_this.checkOnRender) {\n                    // eslint-disable-next-line\n                    var diagramArgs = {\n                        element: args.element, content: args.content, index: args.index, cancel: false,\n                        isExpanded: args.isExpanded, palette: _this.palettes[args.index]\n                    };\n                    var event_1 = 'paletteExpanding';\n                    _this.trigger(event_1, diagramArgs);\n                    args.cancel = diagramArgs.cancel;\n                }\n            };\n            this.element.appendChild(accordionDiv);\n        }\n        var measureWindowElement = 'measureElement';\n        if (window[measureWindowElement]) {\n            window[measureWindowElement] = null;\n        }\n        createMeasureElements();\n        this.unWireEvents();\n        this.wireEvents();\n    };\n    /**\n     * Renders the rulers.\n     *\n     * @returns {void}  Renders the rulers.\n     * @private\n     */\n    SymbolPalette.prototype.render = function () {\n        this.diagramRenderer = new DiagramRenderer(this.element.id, new SvgRenderer(), false);\n        this.svgRenderer = new DiagramRenderer(this.element.id, new SvgRenderer(), true);\n        this.updatePalettes();\n        if (!isBlazor()) {\n            this.accordionElement.appendTo('#' + this.element.id + '_container');\n        }\n        this.renderComplete();\n        if (isBlazor()) {\n            this.element.classList.remove('e-symbolpalette-hidden');\n        }\n    };\n    /**\n     * Core method to return the component name.\n     *\n     * @returns {string}  Core method to return the component name.\n     * @private\n     */\n    SymbolPalette.prototype.getModuleName = function () {\n        return 'SymbolPalette';\n    };\n    /**\n     * To provide the array of modules needed for control rendering.\n     *\n     * @returns {ModuleDeclaration[]}  To provide the array of modules needed for control rendering .\n     * @private\n     */\n    SymbolPalette.prototype.requiredModules = function () {\n        var modules = [];\n        modules.push({\n            member: 'Bpmn',\n            args: []\n        });\n        return modules;\n    };\n    /**\n     *To destroy the ruler\n     *\n     * @returns {void} To destroy the ruler\n     */\n    SymbolPalette.prototype.destroy = function () {\n        if (this.allowDrag) {\n            this.draggable.destroy();\n            this.unWireEvents();\n            this.notify('destroy', {});\n            _super.prototype.destroy.call(this);\n            var content = document.getElementById(this.element.id + '_container');\n            if (content) {\n                this.element.removeChild(content);\n                var measureElemnt = 'measureElement';\n                if (window[measureElemnt]) {\n                    window[measureElemnt].usageCount -= 1;\n                    var measureElementCount = 'measureElementCount';\n                    window[measureElementCount]--;\n                    if (window[measureElementCount] === 0) {\n                        window[measureElemnt].parentNode.removeChild(window[measureElemnt]);\n                        window[measureElemnt] = null;\n                    }\n                }\n            }\n            content = document.getElementById(this.element.id + '_search');\n            if (content) {\n                content.parentNode.removeChild(content);\n            }\n            this.element.classList.remove('e-symbolpalette');\n        }\n    };\n    /**\n     * Add particular palettes to symbol palette at runtime.\\\n     *\n     * @returns {  void}    Refreshes the ruler when the Ruler properties are updated .\\\n     * @param { PaletteModel[]} palettes -Defines the collection of palettes to be added.\n     */\n    SymbolPalette.prototype.addPalettes = function (palettes) {\n        var palette;\n        for (var i = 0; i < palettes.length; i++) {\n            var isEnableServerDatabind = this.allowServerDataBinding;\n            this.isProtectedOnChange = true;\n            this.allowServerDataBinding = false;\n            palette = new Palette(this, 'palettes', palettes[i], true);\n            this.palettes.push(palette);\n            this.initSymbols(palette);\n            this.allowServerDataBinding = isEnableServerDatabind;\n            this.isProtectedOnChange = false;\n            this.renderPalette(palette);\n        }\n        this.bulkChanges = {};\n        if (!isBlazor()) {\n            this.accordionElement.refresh();\n        }\n    };\n    /**\n     * removePalette method\\\n     *\n     * @returns {void}    removePalette method .\\\n     * @param {string} paletteId - provide the scale value.\n     *\n     * @private\n     */\n    SymbolPalette.prototype.removePalette = function (paletteId) {\n        for (var i = 0; i < this.palettes.length; i++) {\n            if (this.palettes[i].id === paletteId) {\n                this.palettes.splice(i, 1);\n                if (!isBlazor()) {\n                    this.accordionElement.items.splice(i, 1);\n                }\n                break;\n            }\n        }\n    };\n    /**\n     * Remove particular palettes to symbol palette at runtime \\\n     *\n     * @returns {void}   Remove particular palettes to symbol palette at runtime .\\\n     * @param {string[]} palettes - provide the scale value.\n     */\n    SymbolPalette.prototype.removePalettes = function (palettes) {\n        var isEnableServerDatabind = this.allowServerDataBinding;\n        this.allowServerDataBinding = false;\n        for (var i = 0; i < palettes.length; i++) {\n            this.removePalette(palettes[i]);\n        }\n        if (!isBlazor()) {\n            this.accordionElement.refresh();\n        }\n        else {\n            this.updatePalettes();\n        }\n        this.allowServerDataBinding = isEnableServerDatabind;\n    };\n    //end region - protected methods\n    //region - private methods to render symbols\n    /**\n     * Method to initialize the items in the symbols \\\n     *\n     * @returns {void}    Method to initialize the items in the symbols .\\\n     * @param {PaletteModel} symbolGroup - provide the scale value.\n     *\n     */\n    SymbolPalette.prototype.initSymbols = function (symbolGroup) {\n        var group = [];\n        var laneHeight = 0;\n        var laneWidth = 0;\n        for (var _i = 0, _a = symbolGroup.symbols; _i < _a.length; _i++) {\n            var symbol = _a[_i];\n            if (symbol.shape.type === 'SwimLane') {\n                var swimLaneObj = symbol;\n                var swimLaneShape = symbol.shape;\n                var isHorizontal = (swimLaneShape.orientation === 'Horizontal') ? true : false;\n                if (swimLaneShape.isLane) {\n                    laneHeight = isHorizontal ? this.symbolHeight - this.symbolHeight / 2 : this.symbolHeight - this.symbolHeight / 4;\n                    laneWidth = isHorizontal ? this.symbolWidth - this.symbolWidth / 4 : this.symbolWidth - this.symbolWidth / 2;\n                    this.laneTable[symbol.id] = { height: laneHeight, width: laneWidth };\n                    var header = swimLaneShape.lanes[0].header;\n                    var laneStyle = swimLaneShape.lanes[0].style;\n                    var headerStyle = header.style;\n                    var headerObj = {\n                        id: 'header' + randomId(), shape: { type: 'Basic', shape: 'Rectangle' },\n                        width: isHorizontal ? header.width : swimLaneObj.width,\n                        height: isHorizontal ? swimLaneObj.height : header.height,\n                        style: headerStyle,\n                        annotations: [{ content: header.annotation.content }]\n                    };\n                    headerObj.offsetX = headerObj.width / 2;\n                    headerObj.offsetY = headerObj.height / 2;\n                    this.addPaletteItem(symbolGroup.id, headerObj);\n                    var laneObj = {\n                        id: 'lane' + randomId(), shape: { type: 'Basic', shape: 'Rectangle' },\n                        width: isHorizontal ? (swimLaneObj.width - header.width) : swimLaneObj.width,\n                        height: isHorizontal ? swimLaneObj.height : (swimLaneObj.height - header.height),\n                        style: laneStyle\n                    };\n                    laneObj.offsetX = isHorizontal ? (headerObj.width + (laneObj.width / 2)) : laneObj.width / 2;\n                    laneObj.offsetY = isHorizontal ? laneObj.height / 2 : (headerObj.height + (laneObj.height / 2));\n                    this.addPaletteItem(symbolGroup.id, laneObj);\n                    swimLaneObj.children = [headerObj.id, laneObj.id];\n                }\n                else if (swimLaneShape.isPhase) {\n                    laneHeight = swimLaneObj.height ? swimLaneObj.height : this.symbolHeight;\n                    laneWidth = swimLaneObj.width ? swimLaneObj.width : this.symbolWidth;\n                    symbol.shape.type = 'Path';\n                    if (isHorizontal) {\n                        symbol.shape.data = 'M0,0 L' + laneWidth + ',' + '0';\n                    }\n                    else {\n                        symbol.shape.data = 'M0,0 L0,' + laneWidth;\n                    }\n                }\n            }\n            if (symbol instanceof Node) {\n                var getNodeDefaults = getFunction(this.getNodeDefaults);\n                if (getNodeDefaults) {\n                    getNodeDefaults(symbol, this);\n                }\n            }\n            else if (symbol instanceof Connector) {\n                var getConnectorDefaults = getFunction(this.getConnectorDefaults);\n                if (getConnectorDefaults) {\n                    getConnectorDefaults(symbol, this);\n                }\n            }\n            this.symbolTable[symbol.id] = symbol;\n            if (symbol instanceof Node && symbol.children) {\n                group.push(symbol);\n            }\n        }\n        for (var i = 0; i < group.length; i++) {\n            var node = void 0;\n            for (var j = 0; j < group[i].children.length; j++) {\n                node = (this.symbolTable[group[i].children[j]]);\n                if (node) {\n                    this.childTable[node.id] = node;\n                    node.parentId = group[i].id;\n                }\n            }\n        }\n        for (var _b = 0, _c = symbolGroup.symbols; _b < _c.length; _b++) {\n            var symbol = _c[_b];\n            if (!(symbol instanceof Node && symbol.children)) {\n                this.prepareSymbol(symbol);\n            }\n        }\n        for (var _d = 0, group_1 = group; _d < group_1.length; _d++) {\n            var symbol = group_1[_d];\n            this.prepareSymbol(symbol);\n        }\n    };\n    SymbolPalette.prototype.renderPalette = function (symbolGroup) {\n        var style = (isBlazor()) ? 'overflow:auto;' : 'display:none;overflow:auto;';\n        if (symbolGroup.height) {\n            style += 'height:' + symbolGroup.height + 'px';\n        }\n        var paletteParentDiv = document.getElementById(symbolGroup.id);\n        var paletteDiv;\n        if (isBlazor() && paletteParentDiv != null) {\n            paletteDiv = createHtmlElement('div', { 'id': symbolGroup.id + '_content', style: style, class: 'e-remove-palette' });\n            paletteParentDiv.appendChild(paletteDiv);\n        }\n        else {\n            paletteDiv = createHtmlElement('div', { 'id': symbolGroup.id, style: style, class: 'e-remove-palette' });\n            this.element.appendChild(paletteDiv);\n        }\n        if (!isBlazor()) {\n            var item = {\n                header: symbolGroup.title, expanded: symbolGroup.expanded,\n                content: '#' + symbolGroup.id, iconCss: symbolGroup.iconCss\n            };\n            this.accordionElement.items.push(item);\n        }\n        this.renderSymbols(symbolGroup, paletteDiv);\n    };\n    /**\n     * Used to add the palette item as nodes or connectors in palettes \\\n     *\n     * @returns {void}    Used to add the palette item as nodes or connectors in palettes .\\\n     * @param {string} paletteName - provide the scale value.\n     * @param {NodeModel | ConnectorModel} paletteSymbol - provide the scale value.\n     * @param {boolean} isChild - provide the scale value.\n     */\n    SymbolPalette.prototype.addPaletteItem = function (paletteName, paletteSymbol, isChild) {\n        paletteSymbol = cloneObject(paletteSymbol);\n        //let refresh: boolean;\n        for (var i = 0; i < this.palettes.length; i++) {\n            var symbolPaletteGroup = this.palettes[i];\n            if (symbolPaletteGroup.id.indexOf(paletteName) !== -1) {\n                // eslint-disable-next-line\n                var param = [undefined, symbolPaletteGroup, 'symbols', {}, true];\n                // eslint-disable-next-line\n                var obj = new (Function.prototype.bind.apply(getObjectType(paletteSymbol), param));\n                for (var i_1 = 0; i_1 < Object.keys(paletteSymbol).length; i_1++) {\n                    var isEnableServerDatabind_1 = this.allowServerDataBinding;\n                    this.allowServerDataBinding = false;\n                    obj[Object.keys(paletteSymbol)[i_1]] = paletteSymbol[Object.keys(paletteSymbol)[i_1]];\n                    this.allowServerDataBinding = isEnableServerDatabind_1;\n                }\n                updateDefaultValues(obj, paletteSymbol, obj instanceof Node ? this.nodeDefaults : this.connectorDefaults);\n                symbolPaletteGroup.symbols.push(obj);\n                var isEnableServerDatabind = this.allowServerDataBinding;\n                this.allowServerDataBinding = false;\n                this.prepareSymbol(obj);\n                this.allowServerDataBinding = isEnableServerDatabind;\n                this.symbolTable[obj.id] = obj;\n                if (isChild) {\n                    this.childTable[obj.id] = obj;\n                }\n                else {\n                    var paletteDiv = void 0;\n                    if (isBlazor()) {\n                        paletteDiv = document.getElementById(symbolPaletteGroup.id + '_content');\n                    }\n                    else {\n                        paletteDiv = document.getElementById(symbolPaletteGroup.id);\n                    }\n                    if (paletteDiv) {\n                        paletteDiv.appendChild(this.getSymbolContainer(obj, paletteDiv));\n                    }\n                }\n                break;\n            }\n        }\n    };\n    /**\n     * Used to remove the palette item as nodes or connectors in palettes \\\n     *\n     * @returns {void}    Used to remove the palette item as nodes or connectors in palettes .\\\n     * @param {string} paletteName - provide the scale value.\n     * @param {string} symbolId - provide the scale value.\n     */\n    SymbolPalette.prototype.removePaletteItem = function (paletteName, symbolId) {\n        var refresh;\n        for (var i = 0; i < this.palettes.length; i++) {\n            var symbolPaletteGroup = this.palettes[i];\n            if (symbolPaletteGroup.id.indexOf(paletteName) !== -1) {\n                for (var _i = 0, _a = symbolPaletteGroup.symbols; _i < _a.length; _i++) {\n                    var symbol = _a[_i];\n                    if (symbol.id.indexOf(symbolId) !== -1) {\n                        var index = symbolPaletteGroup.symbols.indexOf(symbol);\n                        symbolPaletteGroup.symbols.splice(index, 1);\n                        if (symbol.children) {\n                            var parentNode = symbol.children;\n                            for (var i_2 = 0; i_2 < parentNode.length; i_2++) {\n                                delete this.symbolTable[(parentNode[i_2])];\n                            }\n                        }\n                        delete this.symbolTable[symbol.id];\n                        var element = document.getElementById(symbol.id + '_container');\n                        element.parentNode.removeChild(element);\n                        refresh = true;\n                        break;\n                    }\n                }\n            }\n            if (refresh) {\n                break;\n            }\n        }\n    };\n    SymbolPalette.prototype.prepareSymbol = function (symbol) {\n        var width;\n        var sw;\n        var height;\n        var sh;\n        var stackPanel = new StackPanel();\n        var obj = symbol;\n        var content;\n        var symbolContainer = new Canvas();\n        var container = (symbol instanceof Node) ? symbol.initContainer() : null;\n        if (container && !container.children) {\n            container.children = [];\n        }\n        //preparing objects\n        var getSymbolTemplate = getFunction(this.getSymbolTemplate);\n        if (getSymbolTemplate) {\n            content = getSymbolTemplate(symbol);\n        }\n        if (!content) {\n            if (obj.children) {\n                content = this.getContainer(obj, container);\n            }\n            else {\n                content = symbol.init(this);\n                if (symbol instanceof Node && symbol.parentId) {\n                    container.children.push(content);\n                }\n            }\n        }\n        if (!symbol.parentId) {\n            var symbolInfo = { width: this.symbolWidth, height: this.symbolHeight };\n            var getSymbolInfo = getFunction(this.getSymbolInfo);\n            if (getSymbolInfo) {\n                symbolInfo = getSymbolInfo(symbol);\n            }\n            else if (isBlazor()) {\n                symbolInfo = this.getBlazorSymbolInfo(symbol, symbolInfo);\n            }\n            symbolInfo = symbolInfo || this.symbolInfo || {};\n            if (symbol.shape && symbol.shape.isPhase) {\n                symbolInfo.width = symbolInfo.width || this.symbolWidth;\n                symbolInfo.height = symbolInfo.height || this.symbolHeight;\n            }\n            //defining custom templates\n            content.relativeMode = 'Object';\n            content.horizontalAlignment = content.verticalAlignment = 'Center';\n            symbolContainer.style.strokeColor = symbolContainer.style.fill = 'none';\n            symbolContainer.children = [content];\n            content.measure(new Size());\n            content.arrange(content.desiredSize);\n            width = symbolInfo.width = symbolInfo.width ||\n                (obj.width !== undefined ? content.actualSize.width : undefined) || this.symbolWidth;\n            height = symbolInfo.height = symbolInfo.height ||\n                (obj.height !== undefined ? content.actualSize.height : undefined) || this.symbolHeight;\n            if (width !== undefined && height !== undefined) {\n                var actualWidth = width;\n                var actualHeight = height;\n                //let isLane: boolean = (symbol.shape as SwimLane).isLane ? true : false;\n                var isPhase = symbol.shape.isPhase ? true : false;\n                if (this.symbolWidth !== undefined) {\n                    actualWidth = this.symbolWidth - this.symbolMargin.left - this.symbolMargin.right;\n                }\n                else {\n                    width += obj.style.strokeWidth;\n                }\n                if (this.symbolHeight !== undefined) {\n                    actualHeight = this.symbolHeight - this.symbolMargin.top - this.symbolMargin.bottom;\n                }\n                else {\n                    height += obj.style.strokeWidth;\n                }\n                if (symbolInfo.description && symbolInfo.description.text !== '') {\n                    actualHeight -= 20; // default height of the text have been reduced from the container.\n                }\n                sw = actualWidth / ((!isPhase && content.width) || width);\n                sh = actualHeight / ((!isPhase && content.height) || height);\n                if (symbolInfo.fit) {\n                    sw = actualWidth / symbolInfo.width;\n                    sh = actualHeight / symbolInfo.height;\n                }\n                width = actualWidth;\n                height = actualHeight;\n                sw = sh = Math.min(sw, sh);\n                symbolContainer.width = width;\n                symbolContainer.height = height;\n                content.width = symbolInfo.width;\n                content.height = symbolInfo.height;\n                this.scaleSymbol(symbol, symbolContainer, sw, sh, width, height);\n            }\n            else {\n                var outerBounds = void 0;\n                if (symbol instanceof Connector) {\n                    outerBounds = getOuterBounds(symbol);\n                }\n                content.width = symbol.width || (outerBounds) ? outerBounds.width : content.actualSize.width;\n                content.height = symbol.height || (outerBounds) ? outerBounds.height : content.actualSize.height;\n            }\n            symbol.wrapper = stackPanel;\n            stackPanel.children = [symbolContainer];\n            content.pivot = stackPanel.pivot = { x: 0, y: 0 };\n            stackPanel.id = content.id + '_symbol';\n            stackPanel.style.fill = stackPanel.style.strokeColor = 'transparent';\n            if (symbol instanceof Node) {\n                stackPanel.offsetX = symbol.style.strokeWidth / 2;\n                stackPanel.offsetY = symbol.style.strokeWidth / 2;\n            }\n            else {\n                stackPanel.offsetX = 0.5;\n                stackPanel.offsetY = 0.5;\n            }\n            //symbol description-textElement\n            this.getSymbolDescription(symbolInfo, width, stackPanel);\n            stackPanel.measure(new Size());\n            stackPanel.arrange(stackPanel.desiredSize);\n            symbolInfo.width = symbolInfo.width || content.actualSize.width;\n            symbolInfo.height = symbolInfo.height || content.actualSize.height;\n            symbol[this.info] = symbolInfo;\n        }\n        if (symbol.parentId) {\n            container.measure(new Size(obj.width, obj.height));\n            container.arrange(container.desiredSize);\n        }\n    };\n    SymbolPalette.prototype.getBlazorSymbolInfo = function (symbol, symbolInfo) {\n        var node = symbol;\n        var shapeSymbolInfo = node.symbolInfo;\n        if (shapeSymbolInfo) {\n            symbolInfo.description = shapeSymbolInfo.description || this.symbolInfo.description;\n            symbolInfo.fit = shapeSymbolInfo.fit || this.symbolInfo.fit;\n            symbolInfo.height = shapeSymbolInfo.height || this.symbolInfo.height;\n            symbolInfo.width = shapeSymbolInfo.width || this.symbolInfo.width;\n            symbolInfo.tooltip = shapeSymbolInfo.tooltip || this.symbolInfo.tooltip;\n            symbolInfo.template = shapeSymbolInfo.template || this.symbolInfo.template;\n        }\n        return symbolInfo;\n    };\n    SymbolPalette.prototype.getContainer = function (obj, container) {\n        container.measureChildren = false;\n        var bounds;\n        var child = obj.children;\n        container.children = [];\n        for (var i = 0; i < child.length; i++) {\n            if (this.symbolTable[child[i]]) {\n                container.children.push(this.symbolTable[child[i]].wrapper);\n            }\n        }\n        container.measure(new Size(obj.width, obj.height));\n        container.arrange(container.desiredSize);\n        if (container.bounds.x !== 0 || container.bounds.y !== 0) {\n            bounds = container.bounds;\n            arrangeChild(obj, bounds.x, bounds.y, this.symbolTable, false, this);\n            container = this.getContainer(obj, container);\n        }\n        return container;\n    };\n    SymbolPalette.prototype.getSymbolDescription = function (symbolInfo, width, parent) {\n        if (symbolInfo && symbolInfo.description && symbolInfo.description.text) {\n            var textElement = new TextElement();\n            //symbol description-textElement\n            symbolInfo.description.overflow = symbolInfo.description.overflow || 'Ellipsis';\n            symbolInfo.description.wrap = symbolInfo.description.wrap || 'WrapWithOverflow';\n            textElement.id = parent.id + '_text';\n            textElement.content = symbolInfo.description.text;\n            textElement.width = width;\n            textElement.height = 20;\n            textElement.style.strokeColor = 'transparent';\n            textElement.style.fill = 'transparent';\n            textElement.style.strokeWidth = 0;\n            textElement.style.textWrapping = symbolInfo.description.wrap;\n            textElement.style.textOverflow = symbolInfo.description.overflow;\n            textElement.margin = { left: 0, right: 0, top: 0, bottom: 5 };\n            parent.children.push(textElement);\n        }\n    };\n    SymbolPalette.prototype.renderSymbols = function (symbolGroup, parentDiv) {\n        for (var _i = 0, _a = symbolGroup.symbols; _i < _a.length; _i++) {\n            var symbol = _a[_i];\n            if (!symbol.parentId) {\n                this.getSymbolContainer(symbol, parentDiv);\n            }\n        }\n    };\n    SymbolPalette.prototype.getSymbolPreview = function (\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    symbol, evt, parentDiv) {\n        this.allowServerDataBinding = false;\n        var canvas;\n        var sw;\n        var sh;\n        var symbolPreviewWidth = symbol.wrapper.children[0].desiredSize.width + symbol.style.strokeWidth;\n        var symbolPreviewHeight = symbol.wrapper.children[0].desiredSize.height + symbol.style.strokeWidth;\n        var content = symbol.wrapper.children[0].children[0];\n        var symbolPreview = symbol.previewSize;\n        if ((symbol && (symbolPreview.width || symbolPreview.height)) ||\n            this.symbolPreview.width !== undefined || this.symbolPreview.height !== undefined) {\n            symbolPreviewWidth = (symbolPreview.width || this.symbolPreview.width || symbolPreviewWidth) - symbol.style.strokeWidth;\n            symbolPreviewHeight = (symbolPreview.height || this.symbolPreview.height || symbolPreviewHeight) - symbol.style.strokeWidth;\n            sw = symbolPreviewWidth / content.actualSize.width;\n            sh = symbolPreviewHeight / content.actualSize.height;\n            sw = sh = Math.min(sw, sh);\n            var symbolWidth = content.actualSize.width * sw;\n            var symbolHeight = content.actualSize.height * sh;\n            symbol.wrapper.children[0].width = symbolPreviewWidth;\n            symbol.wrapper.children[0].height = symbolPreviewHeight;\n            this.measureAndArrangeSymbol(content, symbol instanceof Node);\n            this.scaleSymbol(symbol, symbol.wrapper.children[0], sw, sh, symbolWidth, symbolHeight, true);\n            symbolPreviewWidth = symbolWidth;\n            symbolPreviewHeight = symbolHeight;\n        }\n        var prevPosition = { x: content.offsetX, y: content.offsetY };\n        content.offsetX = content.offsetY = symbol.style.strokeWidth / 2;\n        content.pivot = { x: 0, y: 0 };\n        this.measureAndArrangeSymbol(content, symbol instanceof Node);\n        var previewContainer = createHtmlElement('div', { 'draggable': 'true', 'class': 'e-dragclone', 'style': 'pointer-events:none' });\n        var div;\n        document.body.appendChild(previewContainer);\n        var style = 'margin:5px;';\n        if (symbol.shape.type === 'Native') {\n            canvas = createSvgElement('svg', {\n                id: symbol.id + '_preview',\n                width: Math.ceil(symbolPreviewWidth) + 1,\n                height: Math.ceil(symbolPreviewHeight) + 1\n            });\n            var gElement = createSvgElement('g', { id: symbol.id + '_g' });\n            canvas.appendChild(gElement);\n            previewContainer.appendChild(canvas);\n            this.svgRenderer.renderElement(content, gElement, undefined, undefined, canvas);\n        }\n        else if (symbol.shape.type === 'HTML') {\n            div = this.getHtmlSymbol(symbol, canvas, previewContainer, symbolPreviewHeight, symbolPreviewWidth, true);\n        }\n        else {\n            if (symbol.children &&\n                symbol.children.length > 0 && groupHasType(symbol, 'HTML', this.childTable)) {\n                div = this.getGroupParent(symbol, canvas, previewContainer, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, true);\n            }\n            else {\n                canvas = CanvasRenderer.createCanvas(symbol.id + '_preview', (Math.ceil(symbolPreviewWidth) + symbol.style.strokeWidth + 1) * 2, (Math.ceil(symbolPreviewHeight) + symbol.style.strokeWidth + 1) * 2);\n                previewContainer.appendChild(canvas);\n                // BLAZ-3223: translate applied only for Basic and Flow now and need to add for remaining shapes in future\n                if (symbol.shape.type === 'Basic' || symbol.shape.type === 'Flow') {\n                    style += 'transform: scale(0.5) translate(-' + canvas.width / 2 + 'px, -' + canvas.height / 2 + 'px);';\n                }\n                else {\n                    style += 'transform:scale(0.5);';\n                }\n                canvas.setAttribute('transform-origin', '0 0');\n                var index = 2;\n                if (symbol instanceof Connector) {\n                    index = 1.9;\n                }\n                canvas.getContext('2d').setTransform(index, 0, 0, index, 0, 0);\n                this.diagramRenderer.renderElement(content, canvas, undefined);\n            }\n        }\n        applyStyleAgainstCsp(((div && (symbol.shape.type === 'HTML' || symbol.children\n            && symbol.children.length > 0)) ? div : canvas), style);\n        content.offsetX = prevPosition.x;\n        content.offsetY = prevPosition.y;\n        this.allowServerDataBinding = true;\n        return previewContainer;\n    };\n    SymbolPalette.prototype.measureAndArrangeSymbol = function (content, isNode) {\n        if (content.children && !isNode) {\n            content.children[0].transform = Transform.Self;\n        }\n        content.measure(new Size());\n        content.arrange(content.desiredSize);\n        if (content.children) {\n            content.children[0].transform = Transform.Parent;\n        }\n    };\n    SymbolPalette.prototype.updateSymbolSize = function (symbol, width, height) {\n        var element = symbol.wrapper.children[0].children[0];\n        var strokeWidth = symbol.style.strokeWidth;\n        element.width = (width || element.width) - (strokeWidth + 1);\n        element.height = (height || element.height) - (strokeWidth + 1);\n        symbol.wrapper.measure(new Size());\n        symbol.wrapper.arrange(symbol.wrapper.desiredSize);\n    };\n    SymbolPalette.prototype.getSymbolContainer = function (symbol, parentDiv, preview) {\n        var symbolInfo = this.symbolTable[symbol.id][this.info];\n        var size = this.getSymbolSize(symbol, symbolInfo);\n        var width = size.width + 1;\n        var height = size.height + 1;\n        var container = createHtmlElement('div', {\n            id: symbol.id + '_container',\n            style: 'width:' + width + 'px;height:' + height + 'px;float:left;overflow:hidden',\n            title: symbolInfo.tooltip ? symbolInfo.tooltip : symbol.id\n        });\n        parentDiv.appendChild(container);\n        var canvas;\n        var gElement;\n        var div;\n        if (symbol.shape.type === 'Native') {\n            canvas = createSvgElement('svg', {\n                id: symbol.id,\n                width: Math.ceil(symbol.wrapper.actualSize.width) + 1,\n                height: Math.ceil(symbol.wrapper.actualSize.height) + 1\n            });\n            gElement = createSvgElement('g', { id: symbol.id + '_g' });\n            canvas.appendChild(gElement);\n            container.appendChild(canvas);\n            this.updateSymbolSize(symbol);\n            this.svgRenderer.renderElement(symbol.wrapper, gElement, undefined, undefined, canvas);\n        }\n        else if (symbol.shape.type === 'HTML') {\n            div = this.getHtmlSymbol(symbol, canvas, container, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, false);\n        }\n        else {\n            if (symbol.children &&\n                symbol.children.length > 0 && groupHasType(symbol, 'HTML', this.childTable)) {\n                div = this.getGroupParent(symbol, canvas, container, symbol.wrapper.actualSize.height, symbol.wrapper.actualSize.width, false);\n            }\n            else {\n                canvas = CanvasRenderer.createCanvas(symbol.id, Math.ceil((symbol.wrapper.actualSize.width + symbol.style.strokeWidth) * 2) + 1, Math.ceil((symbol.wrapper.actualSize.height + symbol.style.strokeWidth) * 2) + 1);\n                container.appendChild(canvas);\n                var index = 2;\n                if (symbol instanceof Connector) {\n                    index = 1.9;\n                }\n                canvas.getContext('2d').setTransform(index, 0, 0, index, 0, 0);\n                this.diagramRenderer.renderElement(symbol.wrapper, gElement || canvas, undefined, undefined, undefined, undefined, true, undefined, true);\n            }\n        }\n        if (!preview) {\n            var actualWidth = symbol.wrapper.actualSize.width + symbol.style.strokeWidth;\n            var actualHeight = symbol.wrapper.actualSize.height + symbol.style.strokeWidth;\n            var style = 'pointer-events:none;transform-origin:0 0;overflow:hidden;';\n            if (symbol.shape.isPhase) {\n                if (symbol.shape.orientation === 'Horizontal') {\n                    style += 'margin-left:' +\n                        Math.max(this.symbolMargin.left, ((width - actualWidth) / 2))\n                        + 'px;margin-top:' + size.height / 2\n                        + 'px;';\n                }\n                else {\n                    style += 'margin-left:' +\n                        size.width / 2\n                        + 'px;margin-top:' + Math.max(this.symbolMargin.top, ((height - actualHeight) / 2))\n                        + 'px;';\n                }\n            }\n            else {\n                style += 'margin-left:' +\n                    Math.max(this.symbolMargin.left, ((width - actualWidth) / 2))\n                    + 'px;margin-top:' + Math.max(this.symbolMargin.top, ((height - actualHeight) / 2))\n                    + 'px;';\n            }\n            if (canvas instanceof HTMLCanvasElement) {\n                style += 'transform:scale(.5,.5);';\n            }\n            applyStyleAgainstCsp(((div && (symbol.shape.type === 'HTML' || symbol.children &&\n                symbol.children.length > 0)) ? div : canvas), style);\n            container.classList.add('e-symbol-draggable');\n            return container;\n        }\n        return canvas;\n    };\n    SymbolPalette.prototype.getGroupParent = function (item, canvas, container, height, width, isPreview) {\n        var div = createHtmlElement('div', { 'id': item.id + (isPreview ? '_html_div_preview' : '_html_div') });\n        var htmlLayer = createHtmlElement('div', {\n            'id': item.id + (isPreview ? '_htmlLayer_preview' : '_htmlLayer'),\n            'style': 'width:' + Math.ceil(width + 1) + 'px;' +\n                'height:' + Math.ceil(height + 1) + 'px;position:absolute',\n            'class': 'e-html-layer'\n        });\n        var htmlLayerDiv = createHtmlElement('div', {\n            'id': item.id + (isPreview ? '_htmlLayer_div_preview' : '_htmlLayer_div'),\n            'style': 'width:' + Math.ceil(width + 1) + 'px;' +\n                'height:' + Math.ceil(height + 1) + 'px;position:absolute'\n        });\n        htmlLayer.appendChild(htmlLayerDiv);\n        div.appendChild(htmlLayer);\n        canvas = CanvasRenderer.createCanvas((isPreview ? (item.id + '_preview') : item.id), Math.ceil(width) + 1, Math.ceil(height) + 1);\n        div.appendChild(canvas);\n        container.appendChild(div);\n        this.diagramRenderer.renderElement(item.wrapper.children[0].children[0], canvas, htmlLayer);\n        return div;\n    };\n    SymbolPalette.prototype.getHtmlSymbol = function (symbol, canvas, container, height, width, isPreview) {\n        var div = createHtmlElement('div', {\n            'id': symbol.id + (isPreview ? '_html_div_preview' : '_html_div')\n        });\n        var htmlLayer = createHtmlElement('div', {\n            'id': symbol.id + (isPreview ? '_htmlLayer_preview' : '_htmlLayer'),\n            'style': 'width:' + Math.ceil(width + 1) + 'px;' +\n                'height:' + Math.ceil(height + 1) + 'px;position:absolute',\n            'class': 'e-html-layer'\n        });\n        var htmlLayerDiv = createHtmlElement('div', {\n            'id': symbol.id + (isPreview ? '_htmlLayer_div_preview' : '_htmlLayer_div'),\n            'style': 'width:' + Math.ceil(width + 1) + 'px;' +\n                'height:' + Math.ceil(height + 1) + 'px;position:absolute'\n        });\n        htmlLayer.appendChild(htmlLayerDiv);\n        div.appendChild(htmlLayer);\n        canvas = CanvasRenderer.createCanvas(symbol.id, Math.ceil((symbol.wrapper.actualSize.width + symbol.style.strokeWidth) * 2) + 1, Math.ceil((symbol.wrapper.actualSize.height + symbol.style.strokeWidth) * 2) + 1);\n        container.appendChild(canvas);\n        canvas.getContext('2d').setTransform(2, 0, 0, 2, 0, 0);\n        div.appendChild(canvas);\n        container.appendChild(div);\n        this.diagramRenderer.renderElement(symbol.wrapper.children[0].children[0], canvas, htmlLayer);\n        return div;\n    };\n    // eslint-disable-next-line\n    SymbolPalette.prototype.getSymbolSize = function (symbol, symbolInfo) {\n        var width = symbol.wrapper.actualSize.width;\n        var height = symbol.wrapper.actualSize.height;\n        if (!this.symbolWidth && !this.symbolHeight) {\n            width += this.symbolMargin.left + this.symbolMargin.right + symbol.style.strokeWidth;\n            height += this.symbolMargin.top + this.symbolMargin.bottom + symbol.style.strokeWidth;\n        }\n        else {\n            width = this.symbolWidth;\n            height = Math.max(this.symbolHeight, height);\n        }\n        return new Size(width, height);\n    };\n    //end region - rendering symbols\n    //region event handlers\n    SymbolPalette.prototype.getMousePosition = function (e) {\n        var offsetY;\n        var offsetX;\n        var touchArg;\n        if (e.type.indexOf('touch') !== -1) {\n            touchArg = e;\n            var pageY = touchArg.changedTouches[0].clientY;\n            var pageX = touchArg.changedTouches[0].clientX;\n            offsetY = pageY - this.element.offsetTop;\n            offsetX = pageX - this.element.offsetLeft;\n        }\n        else {\n            offsetY = e.clientY - this.element.offsetTop;\n            offsetX = e.clientX - this.element.offsetLeft;\n        }\n        return { x: offsetX, y: offsetY };\n    };\n    // eslint-disable-next-line\n    SymbolPalette.prototype.mouseMove = function (e, touches) {\n        if (this.highlightedSymbol && (!this.selectedSymbol\n            || this.selectedSymbol.id + '_container' !== this.highlightedSymbol.id)) {\n            this.highlightedSymbol.classList.remove('e-symbol-hover');\n            this.highlightedSymbol.style.backgroundColor = '';\n            this.highlightedSymbol = null;\n        }\n        var id = e.target.id.split('_container')[0];\n        if (this.symbolTable[id]) {\n            var container = document.getElementById(id + '_container');\n            container.classList.add('e-symbol-hover');\n            this.highlightedSymbol = container;\n        }\n        e.preventDefault();\n    };\n    // eslint-enable\n    SymbolPalette.prototype.mouseUp = function (evt) {\n        this.isMethod = true;\n        if (evt && evt.target) {\n            if (evt.srcElement.id === 'iconSearch') {\n                var element = document.getElementById('iconSearch');\n                if (element.classList.contains('e-clear-searchtext')) {\n                    element.className = 'e-input-group-icon e-search e-icons';\n                    document.getElementById('textEnter').value = '';\n                    if (isBlazor()) {\n                        document.getElementById(this.element.id + '_search_content').classList.add('e-symbolpalette-search-hidden');\n                    }\n                    this.searchPalette('');\n                }\n            }\n            else {\n                var id = evt.target.id.split('_container')[0];\n                if (id && this.selectedSymbol) {\n                    var args = { oldValue: this.oldObject, newValue: id };\n                    var event_2 = 'paletteSelectionChange';\n                    this.trigger(event_2, args);\n                    this.oldObject = id;\n                    evt.preventDefault();\n                }\n                else if (this.oldObject !== '') {\n                    this.oldObject = '';\n                }\n            }\n        }\n    };\n    SymbolPalette.prototype.keyUp = function (evt) {\n        var _this = this;\n        if (this.enableSearch) {\n            // eslint-disable-next-line\n            var palette_1 = this;\n            var element = document.getElementById('iconSearch');\n            element.className = 'e-input-group-icon e-clear-searchtext e-icons';\n            if (isBlazor() && evt.target instanceof HTMLInputElement) {\n                if (evt.target.value === '') {\n                    document.getElementById(this.element.id + '_search_content').classList.add('e-symbolpalette-search-hidden');\n                }\n                else {\n                    document.getElementById(this.element.id + '_search_content').classList.remove('e-symbolpalette-search-hidden');\n                }\n            }\n            if (evt && (evt.key === 'Enter' || evt.keyCode === 13)) {\n                if (evt.target instanceof HTMLInputElement) {\n                    this.searchPalette(evt.target.value);\n                }\n            }\n            else {\n                if (this.timer) {\n                    clearTimeout(this.timer);\n                }\n                this.timer = setTimeout(function () {\n                    if (evt.target instanceof HTMLInputElement) {\n                        palette_1.searchPalette(evt.target.value);\n                        _this.timer = null;\n                    }\n                }, 500);\n            }\n        }\n    };\n    SymbolPalette.prototype.mouseDown = function (evt) {\n        var id = evt.target.id.split('_container')[0];\n        if (this.selectedSymbol) {\n            var oldSymbol = document.getElementById(this.selectedSymbol.id + '_container');\n            if (id !== this.selectedSymbol.id && oldSymbol) {\n                oldSymbol.classList.remove('e-symbol-selected');\n            }\n            var container = document.getElementById(this.selectedSymbol.id + '_container');\n            if (container) {\n                container.style.backgroundColor = '';\n            }\n            this.selectedSymbol = null;\n        }\n        if (this.symbolTable[id]) {\n            var container = document.getElementById(id + '_container');\n            container.classList.add('e-symbol-selected');\n            this.selectedSymbol = this.symbolTable[id];\n            evt.preventDefault();\n        }\n    };\n    SymbolPalette.prototype.keyDown = function (evt) {\n        // eslint-disable-next-line\n        var palette = this;\n        var helperElement = 'helperElement';\n        var intDestroy = 'intDestroy';\n        if (evt && (evt.key === 'Escape')) {\n            var element = palette.draggable[helperElement];\n            if (element && element.parentNode) {\n                element.parentNode.removeChild(element);\n                palette.draggable[intDestroy]();\n            }\n        }\n    };\n    //end region - event handlers\n    // region - draggable\n    SymbolPalette.prototype.initDraggable = function () {\n        if (this.allowDrag) {\n            //let drag: Draggable;\n            this.draggable = new Draggable(this.element, {\n                dragTarget: '.e-symbol-draggable',\n                helper: this.helper,\n                dragStart: this.dragStart,\n                preventDefault: false,\n                dragStop: this.dragStop,\n                drag: function (args) {\n                    var target = 'target';\n                    var parent = parentsUntil(args[target], 'e-droppable');\n                    if (parent && parent.classList.contains('e-diagram')) {\n                        var e2eInstance = 'ej2_instances';\n                        parent[e2eInstance][0].droppable.over(args);\n                    }\n                },\n                cursorAt: { left: this.symbolPreview.offset.x, top: this.symbolPreview.offset.y }\n            });\n        }\n    };\n    // eslint-enable\n    SymbolPalette.prototype.dragStart = function (e) {\n        var element = this.helper[0];\n        if (element) {\n            element.setAttribute('paletteId', this.element.id);\n        }\n        if (isBlazor()) {\n            e.bindEvents(e.dragElement);\n        }\n    };\n    SymbolPalette.prototype.dragStop = function (e) {\n        if (!parentsUntil(e.target, 'e-diagram')) {\n            remove(e.helper);\n        }\n    };\n    //end region - draggable\n    //region - helper methods\n    SymbolPalette.prototype.scaleSymbol = function (symbol, symbolContainer, sw, sh, width, height, preview) {\n        if (symbol instanceof Connector) {\n            var wrapper = symbol.wrapper;\n            symbol.wrapper = symbolContainer.children[0];\n            var point = symbol.scale(sw, sh, width, height, symbolContainer.children[0]);\n            var difX = width / 2 - symbolContainer.children[0].children[0].offsetX + point.x / 2;\n            var difY = height / 2 - symbolContainer.children[0].children[0].offsetY + point.y / 2;\n            for (var _i = 0, _a = symbolContainer.children[0].children; _i < _a.length; _i++) {\n                var child = _a[_i];\n                child.offsetX += difX;\n                child.offsetY += difY;\n                child.staticSize = false;\n            }\n            symbol.wrapper = wrapper;\n        }\n        else if (symbol.shape.type === 'Bpmn' && this.bpmnModule) {\n            var wrapper = symbol.wrapper;\n            symbol.wrapper = symbolContainer;\n            symbolContainer.children[0].width = width;\n            symbolContainer.children[0].height = height;\n            this.bpmnModule.updateBPMN({ width: width, height: height }, symbol, symbol, null);\n            symbol.wrapper = wrapper;\n        }\n        else {\n            if (symbol.children) {\n                var parentNode = symbol.children;\n                var w = 0;\n                var h = 0;\n                if (!preview) {\n                    var node = void 0;\n                    var container = void 0;\n                    for (var i = 0; i < parentNode.length; i++) {\n                        container = symbolContainer.children[0].children[i];\n                        if (container) {\n                            if (container.children[0].children) {\n                                this.measureChild(container);\n                            }\n                            node = this.symbolTable[container.id];\n                            container.width = node.width;\n                            container.height = node.height;\n                            container.measure(new Size());\n                            container.arrange(container.children[0].desiredSize);\n                        }\n                    }\n                }\n                w = width / symbolContainer.children[0].desiredSize.width;\n                h = height / symbolContainer.children[0].desiredSize.height;\n                symbolContainer.children[0].measure(new Size());\n                symbolContainer.children[0].arrange(symbolContainer.children[0].desiredSize);\n                if (!preview) {\n                    var children = void 0;\n                    for (var i = 0; i < parentNode.length; i++) {\n                        children = symbolContainer.children[0].children[i];\n                        if (children) {\n                            if (children.children[0].children) {\n                                this.scaleChildren(children, w, h, symbol);\n                            }\n                            this.scaleGroup(children, w, h, symbol);\n                        }\n                    }\n                }\n                if (preview) {\n                    ///let node: Node;\n                    var scaleWidth = void 0;\n                    var scaleHeight = void 0;\n                    var children = void 0;\n                    for (var i = 0; i < parentNode.length; i++) {\n                        //const node: Node = this.symbolTable[parentNode[i]];\n                        scaleWidth = width / symbol.wrapper.children[0].desiredSize.width;\n                        scaleHeight = height / symbol.wrapper.children[0].desiredSize.height;\n                        children = symbolContainer.children[0].children[i];\n                        if (children) {\n                            if (children.children[0].children) {\n                                this.scaleChildren(children, scaleWidth, scaleHeight, symbol, true);\n                            }\n                            this.scaleGroup(children, scaleWidth, scaleHeight, symbol, true);\n                        }\n                    }\n                    symbol.wrapper.children[0].measure(new Size());\n                    symbol.wrapper.children[0].arrange(symbol.wrapper.children[0].desiredSize);\n                }\n            }\n            else {\n                scaleElement(symbolContainer.children[0], sw, sh, symbolContainer);\n            }\n        }\n    };\n    SymbolPalette.prototype.scaleChildren = function (container, w, h, symbol, preview) {\n        var child;\n        for (var i = 0; i < container.children.length; i++) {\n            child = container.children[i];\n            if (!child.children[0].children) {\n                this.scaleGroup(child, w, h, symbol, preview);\n            }\n            else {\n                this.scaleChildren(child, w, h, symbol, preview);\n            }\n        }\n    };\n    SymbolPalette.prototype.measureChild = function (container) {\n        var childContainer;\n        var node;\n        for (var i = 0; i < container.children.length; i++) {\n            childContainer = container.children[i];\n            if (!childContainer.children[0].children) {\n                node = this.symbolTable[childContainer.id];\n                childContainer.width = node.width;\n                childContainer.height = node.height;\n                childContainer.measure(new Size());\n                childContainer.arrange(childContainer.children[0].desiredSize);\n            }\n            else {\n                this.measureChild(childContainer);\n            }\n        }\n    };\n    SymbolPalette.prototype.scaleGroup = function (child, w, h, symbol, preview) {\n        child.width = child.width * w;\n        child.height = (child.height * h);\n        child.offsetX = preview ? (child.offsetX * w) - symbol.style.strokeWidth : (child.offsetX * w) + symbol.style.strokeWidth / 2;\n        child.offsetY = preview ? (child.offsetY * h) - symbol.style.strokeWidth : (child.offsetY * h) + symbol.style.strokeWidth / 2;\n        child.measure(new Size());\n        child.arrange(child.children[0].desiredSize);\n    };\n    SymbolPalette.prototype.refreshPalettes = function () {\n        if (!isBlazor()) {\n            this.accordionElement.items = [];\n        }\n        removeElementsByClass('e-remove-palette', this.element.id);\n        this.updatePalettes();\n        if (!isBlazor()) {\n            this.accordionElement.dataBind();\n        }\n    };\n    SymbolPalette.prototype.updatePalettes = function () {\n        for (var i = 0; i < this.palettes.length; i++) {\n            var symGroup = this.palettes[i];\n            this.initSymbols(symGroup);\n            this.renderPalette(symGroup);\n        }\n    };\n    SymbolPalette.prototype.createTextbox = function () {\n        var searchDiv = createHtmlElement('div', { id: this.element.id + '_search' });\n        applyStyleAgainstCsp(searchDiv, 'backgroundColor:white;height:30px');\n        //  searchDiv.setAttribute('style', 'backgroundColor:white;height:30px');\n        searchDiv.className = 'e-input-group';\n        this.element.appendChild(searchDiv);\n        var textBox = createHtmlElement('input', {});\n        textBox.placeholder = 'Search Shapes';\n        textBox.id = 'textEnter';\n        applyStyleAgainstCsp(textBox, 'width:100%;height:auto');\n        //textBox.setAttribute('style', 'width:100%;height:auto');\n        textBox.className = 'e-input';\n        searchDiv.appendChild(textBox);\n        var span = createHtmlElement('span', { id: 'iconSearch', className: 'e-input-group-icon e-search e-icons' });\n        searchDiv.appendChild(span);\n    };\n    SymbolPalette.prototype.getFilterSymbol = function (symbol) {\n        var items = [];\n        for (var i = 0; i < symbol.length; i++) {\n            for (var j = 0; j < this.ignoreSymbolsOnSearch.length; j++) {\n                if (this.ignoreSymbolsOnSearch[j] !== symbol[i].id) {\n                    items.push(symbol[0]);\n                }\n            }\n        }\n        return items;\n    };\n    SymbolPalette.prototype.searchPalette = function (value) {\n        var symbolGroup = [];\n        var element = document.getElementById('SearchPalette');\n        var paletteDiv;\n        //remove the existing child in palette\n        if (element) {\n            for (var k = element.children.length - 1; k >= 0; k--) {\n                element.removeChild(element.children[k]);\n            }\n        }\n        //add the searched item in array collection\n        for (var i = 0; i < this.palettes.length; i++) {\n            var symbolPaletteGroup = this.palettes[i];\n            for (var j = 0; j < symbolPaletteGroup.symbols.length; j++) {\n                var item = symbolPaletteGroup.symbols[j];\n                if (value !== '' && item.id.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n                    symbolGroup.push(item);\n                }\n            }\n        }\n        var filterSymbols = getFunction(this.filterSymbols);\n        if (filterSymbols) {\n            symbolGroup = filterSymbols(symbolGroup) || [];\n        }\n        if (this.ignoreSymbolsOnSearch && this.ignoreSymbolsOnSearch.length > 0) {\n            symbolGroup = this.getFilterSymbol(symbolGroup);\n        }\n        //create a palette collection\n        if (!element && !isBlazor()) {\n            paletteDiv = this.createSearchPalette(paletteDiv);\n            element = paletteDiv;\n        }\n        //add the symbols into search palette\n        if (symbolGroup.length > 0) {\n            for (var _i = 0, symbolGroup_1 = symbolGroup; _i < symbolGroup_1.length; _i++) {\n                var symbol = symbolGroup_1[_i];\n                if (symbol.parentId === \"\") {\n                    this.getSymbolContainer(symbol, element);\n                }\n            }\n        }\n        else if (value !== '') {\n            var emptyDiv = createHtmlElement('div', { 'id': 'EmptyDiv', 'style': 'text-align:center;font-style:italic' });\n            emptyDiv.innerHTML = 'No Items To Display';\n            element.appendChild(emptyDiv);\n        }\n        else {\n            var element_1 = document.getElementById('iconSearch');\n            element_1.className = 'e-input-group-icon e-search e-icons';\n            if (!isBlazor()) {\n                this.accordionElement.removeItem(0);\n                var searchPalette = document.getElementById('SearchPalette');\n                if (searchPalette) {\n                    searchPalette.remove();\n                }\n            }\n        }\n    };\n    SymbolPalette.prototype.createSearchPalette = function (paletteDiv) {\n        paletteDiv = createHtmlElement('div', { 'id': 'SearchPalette', 'style': 'display:none;overflow:auto;' });\n        this.element.appendChild(paletteDiv);\n        var paletteCollection = {\n            header: 'Search Results', expanded: true,\n            content: '#SearchPalette'\n        };\n        this.accordionElement.addItem(paletteCollection, 0);\n        return paletteDiv;\n    };\n    SymbolPalette.prototype.wireEvents = function () {\n        var startEvent = Browser.touchStartEvent;\n        var stopEvent = Browser.touchEndEvent;\n        var moveEvent = Browser.touchMoveEvent;\n        //let cancelEvent: string = 'mouseleave';\n        var keyEvent = 'keyup';\n        var keyDownEvent = 'keydown';\n        EventHandler.add(this.element, startEvent, this.mouseDown, this);\n        EventHandler.add(this.element, moveEvent, this.mouseMove, this);\n        EventHandler.add(this.element, stopEvent, this.mouseUp, this);\n        EventHandler.add(this.element, keyEvent, this.keyUp, this);\n        EventHandler.add(document, keyDownEvent, this.keyDown, this);\n        // initialize the draggable component\n        this.initDraggable();\n    };\n    SymbolPalette.prototype.unWireEvents = function () {\n        var startEvent = Browser.touchStartEvent;\n        var stopEvent = Browser.touchEndEvent;\n        var moveEvent = Browser.touchMoveEvent;\n        //const cancelEvent: string = Browser.isPointer ? 'pointerleave' : 'mouseleave';\n        var keyEvent = 'keyup';\n        var keyDownEvent = 'keydown';\n        EventHandler.remove(this.element, startEvent, this.mouseDown);\n        EventHandler.remove(this.element, moveEvent, this.mouseMove);\n        EventHandler.remove(this.element, stopEvent, this.mouseUp);\n        EventHandler.remove(this.element, keyEvent, this.keyUp);\n        EventHandler.remove(document, keyDownEvent, this.keyDown);\n    };\n    __decorate([\n        Property('S')\n    ], SymbolPalette.prototype, \"accessKey\", void 0);\n    __decorate([\n        Property('100%')\n    ], SymbolPalette.prototype, \"width\", void 0);\n    __decorate([\n        Property('100%')\n    ], SymbolPalette.prototype, \"height\", void 0);\n    __decorate([\n        Collection([], Palette)\n    ], SymbolPalette.prototype, \"palettes\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"getSymbolInfo\", void 0);\n    __decorate([\n        Property({ fit: true })\n    ], SymbolPalette.prototype, \"symbolInfo\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"filterSymbols\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"ignoreSymbolsOnSearch\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"getSymbolTemplate\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"symbolWidth\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"symbolHeight\", void 0);\n    __decorate([\n        Complex({ left: 10, right: 10, top: 10, bottom: 10 }, Margin)\n    ], SymbolPalette.prototype, \"symbolMargin\", void 0);\n    __decorate([\n        Property(true)\n    ], SymbolPalette.prototype, \"allowDrag\", void 0);\n    __decorate([\n        Complex({}, SymbolPreview)\n    ], SymbolPalette.prototype, \"symbolPreview\", void 0);\n    __decorate([\n        Complex({}, SymbolDragSize)\n    ], SymbolPalette.prototype, \"symbolDragSize\", void 0);\n    __decorate([\n        Property(false)\n    ], SymbolPalette.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(true)\n    ], SymbolPalette.prototype, \"enableAnimation\", void 0);\n    __decorate([\n        Property('Multiple')\n    ], SymbolPalette.prototype, \"expandMode\", void 0);\n    __decorate([\n        Event()\n    ], SymbolPalette.prototype, \"paletteSelectionChange\", void 0);\n    __decorate([\n        Event()\n    ], SymbolPalette.prototype, \"paletteExpanding\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"getNodeDefaults\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"nodeDefaults\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"getConnectorDefaults\", void 0);\n    __decorate([\n        Property()\n    ], SymbolPalette.prototype, \"connectorDefaults\", void 0);\n    return SymbolPalette;\n}(Component));\nexport { SymbolPalette };\n"]},"metadata":{},"sourceType":"module"}